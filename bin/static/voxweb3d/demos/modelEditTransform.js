(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["VoxApp"]=t():e["VoxApp"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="fae3")}({"0efa":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("75f5");class i{constructor(){this.m_init=!0}initialize(e=null,t=""){return this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=t&&void 0!==t||(t="static/cospace/coMaterial/CoMaterial.umd.min.js"),new n.ModuleLoader(1,()=>{null!=e&&this.isEnabled()&&e([t])}).load(t),!0)}isEnabled(){return"undefined"!==typeof CoMaterial}createColor4(e,t,r,n){return CoMaterial.createColor4(e,t,r,n)}createDefaultMaterial(e){return CoMaterial.createDefaultMaterial(e)}createLineMaterial(e){return CoMaterial.createLineMaterial(e)}createQuadLineMaterial(e){return CoMaterial.createQuadLineMaterial(e)}createShaderMaterial(e){return CoMaterial.createShaderMaterial(e)}createMaterial(e){return CoMaterial.createMaterial(e)}creatMaterialContextParam(){return CoMaterial.creatMaterialContextParam()}createMaterialContext(){return CoMaterial.createMaterialContext()}}const a=new i;t.VoxMaterial=a},"1eb2":function(e,t,r){"use strict";if("undefined"!==typeof window){var n=window.document.currentScript,i=r("8875");n=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var a=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(r.p=a[1])}},2564:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t=null,r=null){this.m_uid=n.s_uid++,this.m_urlChecker=null,this.m_oneTimes=!0,this.m_loaderMap=null,this.m_callback=t,this.m_times=e,this.m_urlChecker=r}setUrlChecker(e=null){return this.m_urlChecker=e,this}getUrlChecker(){return this.m_urlChecker}getUid(){return this.m_uid}setCallback(e){return this.m_callback=e,this}addLoader(e){if(null!=e&&e!=this)if(this.isFinished())e.use();else{null==this.m_loaderMap&&(this.m_loaderMap=new Map);let t=this.m_loaderMap;t.has(e.getUid())||t.set(e.getUid(),e)}return this}isFinished(){return 0==this.m_times}useOnce(){this.m_oneTimes&&(this.m_oneTimes=!1,this.use())}use(){if(this.m_times>0&&(this.m_times--,this.isFinished()&&null!=this.m_callback&&(this.m_callback(),this.m_callback=null,null!=this.m_loaderMap))){for(let[e,t]of this.m_loaderMap)t.use();this.m_loaderMap=null}}hasModuleByUrl(e){return n.loadedMap.has(e)}load(e){if(""==e)return this;null!=this.m_urlChecker&&(e=this.m_urlChecker(e));let t=n.loadedMap;if(t.has(e))return void this.use();let r=n.loadingMap;if(!r.has(e))return r.set(e,[this]),this.loadData(e),this;{let t=r.get(e);for(let e=0;e<t.length;++e)if(t[e]==this)return;t.push(this)}}loadData(e){let t=new XMLHttpRequest;t.open("GET",e,!0),t.onerror=function(e){},t.onload=t=>{this.loadedUrl(e)},t.send(null)}loadedData(e,t){}loadedUrl(e){let t=n.loadedMap,r=n.loadingMap;t.set(e,1);let i=r.get(e);for(let n=0;n<i.length;++n)i[n].use();r.delete(e)}getDataByUrl(e){return null}clearAllData(){}destroy(){this.m_urlChecker=null}}n.s_uid=0,n.loadedMap=new Map,n.loadingMap=new Map,t.PackedLoader=n},"2a2b":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r("7aa4")),a=r("75f5");class s{constructor(e){this.m_infoObj=null,this.m_verMap=new Map,this.m_infoObj=e;const t=this.m_infoObj,r=this.m_verMap;let n=t.items;for(let i=0;i<n.length;++i){const e=n[i];if(r.set(e.name,e),e.type&&"dir"==e.type){let t=e.items;for(let e=0;e<t.length;++e){const n=t[e];r.set(n.name,n)}}}}filterUrl(e){let t=e.indexOf("/dracoLib/")>0;if(t){let t=i.default.getFileNameAndSuffixName(e,!0);if(this.m_verMap.has(t)){let r=this.m_verMap.get(t);e+="?ver="+r.ver}}else{let t=i.default.getFileName(e,!0);if(this.m_verMap.has(t)){let r=this.m_verMap.get(t);e+="?ver="+r.ver}}return e}}t.CoModuleVersion=s;class o extends a.ModuleLoader{constructor(e,t=null,r=null){super(e,t,null);let n=e=>{if(e.indexOf(".artvily.")>0)return e;let t=window.location.href;if(e=e.trim(),t.indexOf(".artvily.")>0){let n=e.lastIndexOf("/"),i=e.indexOf(".",n);t="http://www.artvily.com:9090/";let a=e.slice(n,i);return e.indexOf(".umd.")>0?(a=a.toLocaleLowerCase(),e=t+e.slice(0,n)+a+".js"):e=t+e,r&&(e=r.filterUrl(e)),e}return r&&(e=r.filterUrl(e)),e};this.setUrlChecker(n)}}t.CoModuleLoader=o},"2e41":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("4427");t.ICoTransformRecorder=n.ICoTransformRecorder;const i=r("8ccd");t.ITransformController=i.ITransformController;const a=r("c333");t.IFloorLineGrid=a.IFloorLineGrid;const s=r("5b9f");t.IUIRectLine=s.IUIRectLine;const o=r("d07b");t.IRectFrameQuery=o.IRectFrameQuery;const l=r("75f5");var c=null;t.UserEditEvent=c;class d{constructor(){this.m_init=!0}initialize(e=null,r=""){return this.isEnabled()&&(t.UserEditEvent=c=Lib_VoxModelEdit.UserEditEvent),this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=r&&void 0!==r||(r="static/cospace/modelEdit/Lib_VoxModelEdit.umd.min.js"),e&&new l.ModuleLoader(1,()=>{this.isEnabled()&&e([r])}).load(r),!0)}isEnabled(){return"undefined"!==typeof Lib_VoxModelEdit}get UserEditEvent(){return Lib_VoxModelEdit.UserEditEvent}createTransformRecorder(){return Lib_VoxModelEdit.createTransformRecorder()}createTransformController(){return Lib_VoxModelEdit.createTransformController()}createFloorLineGrid(){return Lib_VoxModelEdit.createFloorLineGrid()}createUIRectLine(){return Lib_VoxModelEdit.createUIRectLine()}createRectFrameQuery(){return Lib_VoxModelEdit.createRectFrameQuery()}}const u=new d;t.VoxModelEdit=u},3347:function(e,t,r){"use strict";var n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e["ctmParser"]="ctmGeomParser",e["objParser"]="objGeomParser",e["dracoParser"]="dracoGeomParser",e["pngParser"]="pngParser",e["fbxFastParser"]="fbxFastParser",e["threadCore"]="threadCore",e["coSpaceApp"]="coSpaceApp"}(n||(n={})),t.CoModuleNS=n,function(e){e["Undefined"]="undefined-format",e["CTM"]="ctm",e["Draco"]="draco",e["OBJ"]="obj",e["FBX"]="fbx",e["GLB"]="glb",e["Jpg"]="jpg",e["Png"]="png",e["Gif"]="gif"}(i||(i={})),t.CoDataFormat=i,function(e){e["JS"]="js-text",e["Binasy"]="binary"}(a||(a={})),t.CoModuleFileType=a},"3edd":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("75f5");class i{constructor(){this.m_init=!0}initialize(e=null,t=""){return this.isEnabled()&&Lib_VoxUI.initialize(),this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=t&&void 0!==t||(t="static/cospace/ui/Lib_VoxUI.umd.min.js"),null!=e&&new n.ModuleLoader(1,()=>{this.isEnabled()&&e([t])}).load(t),!0)}isEnabled(){return"undefined"!==typeof Lib_VoxUI}createColorLabel(){return Lib_VoxUI.createColorLabel()}createUILayout(){return Lib_VoxUI.createUILayout()}createTipInfo(){return Lib_VoxUI.createTipInfo()}createRectTextTip(){return Lib_VoxUI.createRectTextTip()}createClipLabel(){return Lib_VoxUI.createClipLabel()}createClipColorLabel(){return Lib_VoxUI.createClipColorLabel()}createColorClipLabel(){return Lib_VoxUI.createColorClipLabel()}createTextLabel(){return Lib_VoxUI.createTextLabel()}createButton(){return Lib_VoxUI.createButton()}createFlagButton(){return Lib_VoxUI.createFlagButton()}createSelectButtonGroup(){return Lib_VoxUI.createSelectButtonGroup()}createTextButton(e,t,r,n,i,a){return Lib_VoxUI.createTextButton(e,t,r,n,i,a)}createTextLabelButton(e,t,r,n,i,a,s){return Lib_VoxUI.createTextLabelButton(e,t,r,n,i,a,s)}createUIPanel(){return Lib_VoxUI.createUIPanel()}createPromptPanel(){return Lib_VoxUI.createPromptPanel()}createParamCtrlPanel(){return Lib_VoxUI.createParamCtrlPanel()}createUIScene(e,t,r,n){return Lib_VoxUI.createUIScene(e,t,r,n)}createSelectionEntity(){return Lib_VoxUI.createSelectionEntity()}createProgressEntity(){return Lib_VoxUI.createProgressEntity()}}const a=new i;t.VoxUI=a},4427:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5336:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e=null,t=!1){this.m_lastTime=0,this.m_fps=60,this.m_canvas2D=null,this.m_ctx2D=null,this.m_delayTime=10,this.m_preWidth=128,this.m_width=128,this.m_height=70,this.m_auto=!1,this.m_dcBoo=!1,this.m_dtBoo=!1,this.delayTime=40,this.statusInfo="",this.statusEnbled=!0,this.m_timeoutId=-1,null!=e&&this.initialize(e,t)}setParams(e,t=!1){return this.m_dcBoo=e,this.m_dtBoo=t,this}initialize(e=null,t=!1){if(null==this.m_canvas2D){this.m_rsc=e,this.m_auto=t;var r=null;try{void 0!=document&&(r=document)}catch(n){}if(r){this.m_preWidth=window.innerWidth;let e=this.m_preWidth-20;this.createCanvas(e)}e&&this.m_auto&&(this.m_rsc.addEventListener(CoRScene.EventBase.ENTER_FRAME,this,this.enterFrame),this.autoUpdate())}}enterFrame(e){this.updateDo(!1)}autoUpdate(){this.m_timeoutId>-1&&clearTimeout(this.m_timeoutId),this.m_timeoutId=setTimeout(this.autoUpdate.bind(this),50),this.renderDo()}createCanvas(e){null==this.m_canvas2D&&(this.m_canvas2D=document.createElement("canvas"),document.body.appendChild(this.m_canvas2D),this.m_canvas2D.style.display="bolck",this.m_canvas2D.style.left="0px",this.m_canvas2D.style.top="0px",this.m_canvas2D.style.position="absolute",this.m_canvas2D.style.backgroundColor="transparent",this.m_canvas2D.style.pointerEvents="none",this.m_canvas2D.height=this.m_height),e=e<10?10:e,this.m_canvas2D.width=e,this.m_ctx2D=this.m_canvas2D.getContext("2d"),this.m_ctx2D.font="50px Verdana",this.m_ctx2D.fillStyle="red",this.m_ctx2D.textAlign="left",this.m_width=this.m_canvas2D.width}getFPS(){return this.m_fps}getFPSStr(){return this.m_fps>60?"FPS: 60":this.m_fps<10?"FPS: 0"+this.m_fps:"FPS: "+this.m_fps}renderDo(){if(this.m_preWidth!=window.innerWidth){this.m_preWidth=window.innerWidth;let e=this.m_preWidth-20;this.createCanvas(e)}if(this.statusEnbled){this.m_ctx2D.clearRect(0,0,this.m_width,this.m_height);let e="";if(this.m_rsc){const t=this.m_rsc.getRenderProxy().status;this.m_dcBoo&&(e+="/"+t.drawCallTimes),this.m_dtBoo&&(e+="/"+t.drawTrisNumber),""!=this.statusInfo&&(""!=e?e+="/"+this.statusInfo:e=this.statusInfo)}this.m_ctx2D.fillText(this.getFPSStr()+e,5,50)}}updateDo(e=!0){if(this.m_delayTime>0)--this.m_delayTime,this.m_lastTime=Date.now();else{if(null!=this.m_ctx2D){let t=Date.now();this.m_lastTime>0&&(this.m_lastTime=t-this.m_lastTime,this.m_lastTime<1&&(this.m_lastTime=1),this.m_fps=Math.round(1e3/this.m_lastTime),e&&this.render()),this.m_lastTime=t}this.m_delayTime=this.delayTime}}render(){this.m_auto||this.renderDo()}update(e=!0){this.m_auto||this.updateDo(e)}}t.default=n},"5b39":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.crossOrigin="anonymous"}setCrossOrigin(e){this.crossOrigin=e}async load(e,t,r=null,n=null,i="blob",a=""){if(null==t)throw Error("onload == null !!!");const s=new FileReader;s.onload=r=>{t&&t(s.result,e)};const o=new XMLHttpRequest;o.open("GET",e,!0),""!=a&&o.setRequestHeader("Range",a),o.responseType=i,o.onload=r=>{if(o.status<=206)switch(i){case"arraybuffer":case"blob":s.readAsArrayBuffer(o.response);break;case"json":t&&t(o.response,e);break;case"text":t&&t(o.response,e);break;default:t&&t(o.response,e);break}else n&&n(o.status,e)},null!=r&&(o.onprogress=t=>{let n=0;if(t.total>0||t.lengthComputable)n=Math.min(1,t.loaded/t.total);else{let e=parseInt(o.getResponseHeader("content-length"));e>0&&(e*=4,n=Math.min(1,t.loaded/e))}r(n,e)}),null!=n&&(o.onerror=t=>{n(o.status,e)}),o.send(null)}}t.HttpFileLoader=n},"5b9f":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"634f":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("75f5");class i{constructor(){this.m_init=!0}initialize(e=null,t=""){return!!this.m_init&&(this.m_init=!1,""!=t&&void 0!==t||(t="static/cospace/engine/uiInteract/CoUIInteraction.umd.min.js"),new n.ModuleLoader(1,()=>{null!=e&&this.isEnabled()&&e([t])}).load(t),!0)}createMouseInteraction(){return CoUIInteraction.createMouseInteraction()}createKeyboardInteraction(){return CoUIInteraction.createKeyboardInteraction()}isEnabled(){return"undefined"!==typeof CoUIInteraction}}const a=new i;t.VoxUIInteraction=a},"75f5":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("2564");class i extends n.PackedLoader{constructor(e,t=null,r=null){super(e,t,r)}loadData(e){let t=new XMLHttpRequest;t.open("GET",e,!0),t.onerror=function(e){},t.onload=r=>{this.loadedData(t.response,e),this.loadedUrl(e)},t.send(null)}loadedData(e,t){let r=document.createElement("script");r.onerror=e=>{},r.type="text/javascript";try{r.innerHTML=e,document.head.appendChild(r)}catch(n){throw n}}}t.ModuleLoader=i},"7aa4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static isEnabled(){let e=window.location.href;return e.indexOf(".artvily.com")>0}static filterUrl(e){if(e.indexOf("blob:")<0){let t=window.location.href;t.indexOf(".artvily.")>0&&(t="http://www.artvily.com:9090/",e=t+e)}return e}static getFileName(e,t=!1){if(e.indexOf("blob:")<0){let r=e.lastIndexOf("/");if(r<0)return"";let n=e.indexOf(".",r);if(n<0)return"";if(r+2<n){let i=e.slice(r+1,n);return t?i.toLocaleLowerCase():i}}return""}static getFileNameAndSuffixName(e,t=!1){if(e.indexOf("blob:")<0){let r=e.lastIndexOf("/"),n=e.indexOf(".",r);if(n<0)return"";let i=e.slice(r+1);return t?i.toLocaleLowerCase():i}return""}static getFileSuffixName(e,t=!1){if(e.indexOf("blob:")<0){let r=e.lastIndexOf("/"),n=e.indexOf(".",r);if(n<0)return"";let i=e.slice(n+1);return t?i.toLocaleLowerCase():i}return""}}t.default=n},"7c62":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("3347"),i=r("2a2b");class a{constructor(){this.m_init=!0,this.m_sysIniting=!0,this.m_initInsFlag=!0,this.verTool=null,this.m_initCalls=[]}initialize(e=null,t=!1){if(this.m_init){this.m_init=!1,this.m_sysInitCallback=e,this.m_deferredInit=t;let r=[{url:"static/cospace/core/coapp/CoSpaceApp.umd.js",name:n.CoModuleNS.coSpaceApp,type:n.CoModuleFileType.JS},{url:"static/cospace/core/code/ThreadCore.umd.js",name:n.CoModuleNS.threadCore,type:n.CoModuleFileType.JS},{url:"static/cospace/modules/ctm/ModuleCTMGeomParser.umd.js",name:n.CoModuleNS.ctmParser,type:n.CoModuleFileType.JS},{url:"static/cospace/modules/obj/ModuleOBJGeomParser.umd.js",name:n.CoModuleNS.objParser,type:n.CoModuleFileType.JS},{url:"static/cospace/modules/png/ModulePNGParser.umd.js",name:n.CoModuleNS.pngParser,type:n.CoModuleFileType.JS},{url:"static/cospace/modules/fbxFast/ModuleFBXGeomFastParser.umd.js",name:n.CoModuleNS.fbxFastParser,type:n.CoModuleFileType.JS}];this.m_modules=r;let a={nodes:[{uniqueName:"dracoGeomParser",path:"static/cospace/modules/draco/ModuleDracoGeomParser.umd.js"},{uniqueName:"dracoWasmWrapper",path:"static/cospace/modules/dracoLib/w2.js"},{uniqueName:"ctmGeomParser",path:"static/cospace/modules/ctm/ModuleCTMGeomParser.umd.js"}],maps:[{uniqueName:"dracoGeomParser",includes:[1]}]};this.m_dependencyGraphObj=a;let s=new i.CoModuleLoader(1,null,this.verTool),o=s.getUrlChecker();if(o){for(let t=0;t<r.length;++t)r[t].url=o(r[t].url);let e=a.nodes;for(let t=0;t<e.length;++t)e[t].path=o(e[t].path)}t||this.loadSys()}}loadSys(){this.m_sysIniting&&(new i.CoModuleLoader(1,()=>{this.initCoSpaceSys()}).load(this.m_modules[0].url),this.m_sysIniting=!1)}getCPUDataByUrlAndCallback(e,t,r,n){if(null!=this.coappIns){let i=this.coappIns.getCPUDataByUrlAndCallback(e,t,r,n);if(this.m_deferredInit&&this.m_initInsFlag){this.m_initInsFlag=!1;let e=this.m_modules;this.coappIns.initialize(3,e[1].url,!0)}return i}return null}deferredInit(e){null==this.coappIns?(this.m_initCalls.push(e),this.loadSys()):null!=e&&e()}initCoSpaceSys(){if(null==this.coappIns&&"undefined"!==typeof CoSpaceApp){let e=CoSpaceApp.createInstance(),t=this.m_modules,r=JSON.stringify(this.m_dependencyGraphObj);e.setThreadDependencyGraphJsonString(r),e.setTaskModuleParams(t),this.m_deferredInit||e.initialize(3,t[1].url,!0);let n=this;n.coappIns=e;for(let i=0;i<this.m_initCalls.length;++i)null!=this.m_initCalls[i]&&this.m_initCalls[i]();this.m_initCalls=[]}null!=this.m_sysInitCallback&&this.m_sysInitCallback(),this.m_sysInitCallback=null}destroy(){}}t.CoDataModule=a,t.default=a},"7d28":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{}n.EDIT_BEGIN=20001,n.EDIT_END=20002,t.UserEditEvent=n},8875:function(e,t,r){var n,i,a;(function(r,s){i=[],n=s,a="function"===typeof n?n.apply(t,i):n,void 0===a||(e.exports=a)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(m){var r,n,i,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,s=/@([^@]*):(\d+):(\d+)\s*$/gi,o=a.exec(m.stack)||s.exec(m.stack),l=o&&o[1]||!1,c=o&&o[2]||!1,d=document.location.href.replace(document.location.hash,""),u=document.getElementsByTagName("script");l===d&&(r=document.documentElement.outerHTML,n=new RegExp("(?:[^\\n]+?\\n){0,"+(c-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=r.replace(n,"$1").trim());for(var h=0;h<u.length;h++){if("interactive"===u[h].readyState)return u[h];if(u[h].src===l)return u[h];if(l===d&&u[h].innerHTML&&u[h].innerHTML.trim()===i)return u[h]}return null}}return e}))},"8ccd":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},b6e0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),document.demoState=1;class n{isEnabled(){return!0}}let i=window;i["VoxVerify"]=new n;const a=r("bbe6");document.title="Vox Web GPU UI";let s=new a.DemoModelEditTrans4;function o(){if(s.initialize(),s.run){function e(t){s.run(),window.requestAnimationFrame(e)}window.requestAnimationFrame(e)}}o()},bbe6:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r("2a2b"),a=r("7d28"),s=r("c75a"),o=r("d1de"),l=r("634f"),c=r("3edd"),d=r("0efa"),u=r("f042"),h=r("2e41"),m=r("fd42"),_=r("ebc0"),p=n(r("5336")),f=n(r("7aa4")),M=r("5b39");class C{constructor(){}renderBegin(e){let t=e.getRenderProxy();t.clearDepth(1)}renderEnd(e){}}class b{constructor(){this.m_verTool=null,this.m_teamLoader=new m.CoModelTeamLoader,this.m_edit3DUIRScene=null,this.m_graph=null,this.m_rscene=null,this.m_uiScene=null,this.m_entity=null,this.m_transCtr=null,this.m_selectFrame=null,this.m_valueFilter=new y,this.m_layouter=new _.CoEntityLayouter,this.m_entityQuery=null,this.m_entities=[]}initialize(){document.oncontextmenu=function(e){e.preventDefault()},this.loadInfo()}loadInfo(){let e="static/cospace/info.json";e=f.default.filterUrl(e);let t=new M.HttpFileLoader;t.load(e,(e,t)=>{this.m_verTool=new i.CoModuleVersion(e),this.initEngineModule()},null,null,"json")}initEngineModule(){let e="static/cospace/engine/uiInteract/CoUIInteraction.umd.js",t=new i.CoModuleLoader(2,()=>{},this.m_verTool),r="static/cospace/engine/renderer/CoRenderer.umd.js",n="static/cospace/engine/rscene/CoRScene.umd.js",a="static/cospace/math/CoMath.umd.js",s="static/cospace/ageom/CoAGeom.umd.js",l="static/cospace/comesh/CoMesh.umd.js",c="static/cospace/coentity/CoEntity.umd.js",d="static/cospace/particle/CoParticle.umd.js",m="static/cospace/coMaterial/CoMaterial.umd.js",_=" static/cospace/cotexture/CoTexture.umd.js",p="static/cospace/ui/Lib_VoxUI.umd.js",f="static/cospace/modelEdit/Lib_VoxModelEdit.umd.js";new i.CoModuleLoader(2,()=>{o.VoxRScene.isEnabled()&&new i.CoModuleLoader(3,()=>{new i.CoModuleLoader(6,()=>{o.VoxRScene.initialize(),u.VoxMath.initialize(),h.VoxModelEdit.initialize(),this.initRenderer(),this.initMouseInteract(),this.createEditEntity(),this.initUIScene()},this.m_verTool).load(s).load(c).load(d).load(_).load(p).load(f)},this.m_verTool).load(a).load(l).load(m)},this.m_verTool).addLoader(t).load(r).load(n),t.load(e)}initMouseInteract(){const e=l.VoxUIInteraction.createMouseInteraction();e.initialize(this.m_rscene,2).setAutoRunning(!0)}initRenderer(){document.body.style.overflow="hidden";let e=o.RendererDevice;e.SHADERCODE_TRACE_ENABLED=!1,e.VERT_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED=!0;let t=this.m_graph=o.VoxRScene.createRendererSceneGraph(),r=t.createRendererSceneParam();r.setAttriAntialias(!0),r.setCamPosition(1e3,1e3,1e3),r.setCamProject(45,20,9e3),this.m_rscene=t.createScene(r),this.m_rscene.enableMouseEvent(!0),o.VoxRScene.setRendererScene(this.m_rscene),new p.default(this.m_rscene,!0);let n=this.m_rscene.createSubScene(r,3,!1);n.enableMouseEvent(!0),n.setAccessor(new C),this.m_edit3DUIRScene=n,t.addScene(this.m_edit3DUIRScene),this.m_outline=new s.PostOutline(this.m_rscene,this.m_verTool),this.init3DScene()}initUIScene(){let e=this.m_uiScene=c.VoxUI.createUIScene(this.m_graph);e.texAtlasNearestFilter=!0,e.rscene.addEventListener(o.MouseEvent.MOUSE_BG_DOWN,this,this.uiMouseDownListener),e.rscene.addEventListener(o.MouseEvent.MOUSE_UP,this,this.uiMouseUpListener),e.rscene.addEventListener(o.MouseEvent.MOUSE_MOVE,this,this.uiMouseMoveListener),this.initUIEntities(),this.m_entityQuery=h.VoxModelEdit.createRectFrameQuery(),this.m_entityQuery.initialize(this.m_rscene),null==this.m_selectFrame&&(this.m_selectFrame=h.VoxModelEdit.createUIRectLine(),this.m_selectFrame.initialize(e.rscene),this.m_selectFrame.enable());let t=this.m_rscene;t.addEventListener(o.KeyboardEvent.KEY_DOWN,this,this.keyDown),t.addEventListener(o.MouseEvent.MOUSE_BG_CLICK,this,this.mouseClickListener),t.addEventListener(o.MouseEvent.MOUSE_UP,this,this.mouseUpListener,!0,!0)}createBtn(e,t,r,n,i){let a=d.VoxMaterial.createColor4(1,1,1,1),s=c.VoxUI.createTextLabelButton(e,t,170,50,a);return s.setXY(r,n),this.m_uiScene.addEntity(s),s.addEventListener(o.MouseEvent.MOUSE_UP,this,this.btnMouseUpListener),i.addButton(s),s}createSelectBtn(e,t,r,n,i,a,s){let l=c.VoxUI.createSelectionEntity();l.uuid=n;let d=[4284333731,4281578057,4284144565,4281578057];return l.setBGColorsWithARGBUint32(d),l.initialize(this.m_uiScene,r,i,a,30),l.addEventListener(o.SelectionEvent.SELECT,this,this.selectChange),s?l.select(!1):l.deselect(!1),l.setXY(e,t),this.m_uiScene.addEntity(l),l}selectChange(e){this.m_valueFilter.setAbsorbing(e.flag)}initUIEntities(){this.m_btnGroup0=c.VoxUI.createSelectButtonGroup(),this.m_btnGroup1=c.VoxUI.createSelectButtonGroup(),this.m_btnGroup2=c.VoxUI.createSelectButtonGroup();let e=100,t=110,r=(this.createSelectBtn(e,t+30+520,"吸附","absorb","ON","OFF",!1),this.createBtn("local","局部坐标",e,t+30+450,this.m_btnGroup0),this.createBtn("global","全局坐标",e,t+30+380,this.m_btnGroup0));t+=50;let n=this.createBtn("move","移动",e,t+240,this.m_btnGroup1);this.createBtn("rotate","旋转",e,t+170,this.m_btnGroup1),this.createBtn("scale","缩放",e,t+100,this.m_btnGroup1);t-=50;this.createBtn("redo","重做",e,t+30,this.m_btnGroup2),this.createBtn("undo","撤销",e,t-40,this.m_btnGroup2);this.m_btnGroup0.selectButton(r),this.m_btnGroup1.selectButton(n)}init3DScene(){this.loadModels()}createEditEntity(){let e=this.m_edit3DUIRScene;this.m_transCtr=h.VoxModelEdit.createTransformController();const t=this.m_transCtr;t.initialize(e),t.addEventListener(a.UserEditEvent.EDIT_BEGIN,this,this.trans3DEditBegin),t.addEventListener(a.UserEditEvent.EDIT_END,this,this.trans3DEditEnd),this.m_transCtr.setCtrlValueFilter(this.m_valueFilter),this.m_prevPos=u.VoxMath.createVec3(),this.m_currPos=u.VoxMath.createVec3(),this.m_keyInterac=l.VoxUIInteraction.createKeyboardInteraction();const r=this.m_keyInterac;r.initialize(this.m_rscene);let n=o.Keyboard,i=r.createKeysEventType([n.CTRL,n.Y]);r.addKeysDownListener(i,this,this.keyCtrlYDown),i=r.createKeysEventType([n.CTRL,n.Z]),r.addKeysDownListener(i,this,this.keyCtrlZDown),this.m_recoder=h.VoxModelEdit.createTransformRecorder()}keyCtrlZDown(e){this.m_recoder.undo();let t=this.m_recoder.getCurrList();this.selectEntities(t)}keyCtrlYDown(e){this.m_recoder.redo();let t=this.m_recoder.getCurrList();this.selectEntities(t)}trans3DEditBegin(e){let t=e.currentTarget.getTargetEntities(),r=this.m_rscene.getStage3D();this.m_prevPos.setXYZ(r.mouseX,r.mouseY,0),this.m_recoder.saveBegin(t),this.m_selectFrame.disable()}trans3DEditEnd(e){let t=this.m_rscene.getStage3D();if(this.m_currPos.setXYZ(t.mouseX,t.mouseY,0),u.Vector3D.Distance(this.m_prevPos,this.m_currPos)>.5){let t=e.currentTarget.getTargetEntities();this.m_recoder.saveEnd(t)}else this.m_recoder.saveEnd(null);this.m_selectFrame.enable()}uiMouseDownListener(e){this.m_selectFrame.begin(e.mouseX,e.mouseY)}uiMouseUpListener(e){if(this.m_selectFrame.isSelectEnabled()){let e=this.m_selectFrame.bounds,t=this.m_entityQuery.getEntities(e.min,e.max);this.selectEntities(t)}this.m_selectFrame.end(e.mouseX,e.mouseY)}uiMouseMoveListener(e){this.m_selectFrame.move(e.mouseX,e.mouseY)}btnMouseUpListener(e){let t=e.uuid;switch(t){case"local":this.m_transCtr.toLocal();break;case"global":this.m_transCtr.toGlobal();break;case"move":this.m_transCtr.toTranslation();break;case"scale":this.m_transCtr.toScale();break;case"rotate":this.m_transCtr.toRotation();break;case"redo":this.keyCtrlYDown(null);break;case"undo":this.keyCtrlZDown(null);break;default:break}}createTexByUrl(e=""){let t=this.m_rscene.textureBlock.createImageTex2D();e=""!=e?e:"static/assets/box.jpg",e=f.default.filterUrl(e);const r=new XMLHttpRequest;return r.open("GET",e,!0),r.responseType="blob",r.onload=e=>{let n=new Image;n.onload=e=>{t.setDataFromImage(n,0,0,0,!1)};let i=window;var a=(i.URL||i.webkitURL).createObjectURL(r.response);n.src=a},r.onerror=e=>{},r.send(null),t}keyDown(e){let t=o.Keyboard;switch(e.keyCode){case t.W:this.m_transCtr.toTranslation();break;case t.E:this.m_transCtr.toScale();break;case t.R:this.m_transCtr.toRotation();break;default:break}}loadModels(){let e="static/private/",t=e+"obj/base.obj";t=e+"fbx/base4.fbx",t="static/assets/fbx/base4.fbx",t=f.default.filterUrl(t);let r=this.m_teamLoader;r.verTool=this.m_verTool,r.load([t],(e,t)=>{this.m_layouter.layoutReset();for(let r=0;r<e.length;++r)this.createEntity(e[r],null!=t?t[r]:null,1);this.m_layouter.layoutUpdate(300,u.VoxMath.createVec3(-400,0,0))})}createEntity(e,t=null,r=1){let n=o.VoxRScene.createDefaultMaterial(!0);n.setRGB3f(.7,.7,.7),n.setTextureList([this.createTexByUrl()]),n.initializeByCodeBuf(!0);let i=o.VoxRScene.createDataMeshFromModel(e,n),a=o.VoxRScene.createMouseEventEntity();return a.setMaterial(n),a.setMesh(i),this.m_rscene.addEntity(a),a.addEventListener(o.MouseEvent.MOUSE_OVER,this,this.mouseOverTargetListener),a.addEventListener(o.MouseEvent.MOUSE_OUT,this,this.mouseOutTargetListener),a.addEventListener(o.MouseEvent.MOUSE_DOWN,this,this.mouseDownTargetListener),a.addEventListener(o.MouseEvent.MOUSE_UP,this,this.mouseUpTargetListener),this.m_entities.push(a),this.m_layouter.layoutAppendItem(a,o.VoxRScene.createMat4(t)),a}mouseOverTargetListener(e){}mouseOutTargetListener(e){}mouseDownTargetListener(e){}selectEntities(e,t=null){if(e&&e.length>0){let t=this.m_transCtr,r=u.VoxMath.createVec3();for(let n=0;n<e.length;++n)r.addBy(e[n].getGlobalBounds().center);r.scaleBy(1/e.length),t&&e.length>0&&(t.select(e,r),this.m_outline.select(e))}}mouseUpTargetListener(e){let t=e.target;this.selectEntities([t],e.wpos)}mouseUpListener(e){this.m_transCtr&&this.m_transCtr.decontrol()}mouseClickListener(e){this.m_transCtr&&this.m_transCtr.disable(),this.m_outline.deselect()}run(){this.m_graph&&(this.m_transCtr&&this.m_transCtr.run(),this.m_graph.run())}}t.DemoModelEditTrans4=b;class y{constructor(){this.m_absorb=!1}filterScale(e){return Math.abs(e)<1?e<0?e=-1:e>0&&(e=1):e=Math.floor(e),e}setAbsorbing(e){this.m_absorb=e}ctrlValueFilter(e,t){if(this.m_absorb)switch(e){case 0:t.x=10*Math.round(t.x/10),t.y=10*Math.round(t.y/10),t.z=10*Math.round(t.z/10);break;case 1:t.x=this.filterScale(t.x),t.y=this.filterScale(t.y),t.z=this.filterScale(t.z);break;case 2:t.x=5*Math.round(t.x/5),t.y=5*Math.round(t.y/5),t.z=5*Math.round(t.z/5);break;default:break}}}t.default=b},c333:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},c75a:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("2a2b");class i{constructor(e,t=null){this.m_rscene=e;let r="static/cospace/renderEffect/occPostOutline/OccPostOutlineModule.umd.js";new n.CoModuleLoader(1,null,t).setCallback(()=>{this.m_postOutline=OccPostOutlineModule.create(),this.initOutline(),this.m_rscene.appendRenderNode(this)}).load(r)}initOutline(){this.m_postOutline.initialize(this.m_rscene,0,[0]),this.m_postOutline.setFBOSizeScaleRatio(.5),this.m_postOutline.setRGB3f(0,1,0),this.m_postOutline.setOutlineDensity(2),this.m_postOutline.setOcclusionDensity(.2)}select(e){null!=this.m_postOutline&&this.m_postOutline.setTargetList(e)}deselect(){null!=this.m_postOutline&&this.m_postOutline.setTargetList(null)}render(){null!=this.m_postOutline&&(this.m_postOutline.drawBegin(),this.m_postOutline.draw(),this.m_postOutline.drawEnd())}}t.PostOutline=i},d07b:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},d1de:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("75f5"),i=r("dab7");var a=null;t.RendererDevice=a;var s=null;t.SelectionEvent=s;var o=null;t.ProgressDataEvent=o;var l=null;t.MouseEvent=l;var c=null;t.EventBase=c;var d=null;t.RendererState=d;var u=null;t.TextureConst=u;var h=null;t.Keyboard=h;var m=null;t.KeyboardEvent=m;var _=null;t.RenderDrawMode=_;var p=null;t.CullFaceMode=p;var f=null;t.DepthTestMode=f;var M=null;t.RenderBlendMode=M;var C=null;t.GLStencilFunc=C;var b=null;t.GLStencilOp=b;var y=null;t.GLBlendMode=y;var E=null;t.GLBlendEquation=E;class v{constructor(){this.m_init=!0}init(){const e=CoRScene,r=CoRenderer;"undefined"!==typeof e&&(t.RendererDevice=a=e.RendererDevice,t.SelectionEvent=s=e.SelectionEvent,t.ProgressDataEvent=o=e.ProgressDataEvent,t.EventBase=c=e.EventBase,t.MouseEvent=l=e.MouseEvent,t.RendererState=d=e.RendererState,t.TextureConst=u=e.TextureConst,t.Keyboard=h=e.Keyboard,t.KeyboardEvent=m=e.KeyboardEvent,t.RenderDrawMode=_=r.RenderDrawMode,t.CullFaceMode=p=r.CullFaceMode,t.DepthTestMode=f=r.DepthTestMode,t.RenderBlendMode=M=r.RenderBlendMode,t.GLStencilFunc=C=r.GLStencilFunc,t.GLStencilOp=b=r.GLStencilOp,t.GLBlendMode=y=r.GLBlendMode,t.GLBlendEquation=E=r.GLBlendEquation)}initialize(e=null,t=""){if(this.m_init=!this.isEnabled(),this.m_init||(i.VoxRenderer.initialize(),this.init()),this.m_init){this.m_init=!1;let r=!1,a=0,s="";return r=i.VoxRenderer.initialize(r=>{s=r[0],a++,a>1&&null!=e&&this.isEnabled()&&e([s,t])}),""!=t&&void 0!==t||(t="static/cospace/engine/rscene/CoRScene.umd.min.js"),new n.ModuleLoader(1,()=>{i.VoxRenderer.initialize(),this.init(),r?(a++,a>1&&null!=e&&this.isEnabled()&&e([s,t])):null!=e&&"undefined"!==typeof CoRScene&&e([t])}).load(t),!0}return!1}get RendererDevice(){return CoRScene.RendererDevice}get RendererState(){return CoRScene.RendererState}get RenderDrawMode(){return CoRScene.RenderDrawMode}get VtxBufConst(){return CoRScene.VtxBufConst}get TextureConst(){return CoRScene.TextureConst}get Vector3D(){return CoRScene.Vector3D}get MouseEvent(){return CoRScene.MouseEvent}get EventBase(){return CoRScene.EventBase}get SelectionEvent(){return CoRScene.SelectionEvent}get ProgressDataEvent(){return CoRScene.ProgressDataEvent}get KeyboardEvent(){return CoRScene.KeyboardEvent}get Keyboard(){return CoRScene.Keyboard}get ShaderCodeUUID(){return CoRScene.ShaderCodeUUID}get MaterialContextParam(){return CoRScene.MaterialContextParam}get MaterialPipeType(){return CoRScene.MaterialPipeType}createSelectionEvent(){return CoRScene.createSelectionEvent()}createProgressDataEvent(){return CoRScene.createProgressDataEvent()}createVec3(e,t,r,n){return CoRScene.createVec3(e,t,r,n)}createMat4(e,t){return CoRScene.createMat4(e,t)}createColor4(e,t,r,n){return CoRScene.createColor4(e,t,r,n)}createAABB(){return CoRScene.createAABB()}applySceneBlock(e){return CoRScene.applySceneBlock(e)}createRendererSceneParam(e){return CoRScene.createRendererSceneParam(e)}createRendererScene(e,t,r){return CoRScene.createRendererScene(e,t,r)}setRendererScene(e){return CoRScene.setRendererScene(e)}getRendererScene(){return CoRScene.getRendererScene()}createMouseEvt3DDispatcher(){return CoRScene.createMouseEvt3DDispatcher()}createEventBaseDispatcher(){return CoRScene.createEventBaseDispatcher()}createVtxDrawingInfo(){return CoRScene.createVtxDrawingInfo()}createDefaultMaterial(e){return CoRScene.createDefaultMaterial()}createLineMaterial(e){return CoRScene.createLineMaterial(e)}createQuadLineMaterial(e){return CoRScene.createQuadLineMaterial(e)}createShaderMaterial(e){return CoRScene.createShaderMaterial(e)}createMaterial(e){return CoRScene.createMaterial(e)}createDataMesh(){return CoRScene.createDataMesh()}createRawMesh(){return CoRScene.createRawMesh()}createBoundsMesh(){return CoRScene.createBoundsMesh()}createDataMeshFromModel(e,t,r){return CoRScene.createDataMeshFromModel(e,t,r)}createDisplayEntityFromModel(e,t,r){return CoRScene.createDisplayEntityFromModel(e,t,r)}createFreeAxis3DEntity(e,t,r){return CoRScene.createFreeAxis3DEntity(e,t,r)}createAxis3DEntity(e,t){return CoRScene.createAxis3DEntity(e,t)}createCrossAxis3DEntity(e,t){return CoRScene.createCrossAxis3DEntity(e,t)}createDisplayEntityWithDataMesh(e,t,r){return CoRScene.createDisplayEntityWithDataMesh(e,t,r)}createDisplayEntity(e){return CoRScene.createDisplayEntity(e)}createMouseEventEntity(e){return CoRScene.createMouseEventEntity(e)}createBoundsEntity(e){return CoRScene.createBoundsEntity(e)}createDisplayEntityContainer(){return CoRScene.createDisplayEntityContainer()}creatMaterialContextParam(){return CoRScene.creatMaterialContextParam()}createMaterialContext(){return CoRScene.createMaterialContext()}VerticalCCWOnXOY(e){return CoRScene.VerticalCCWOnXOY(e)}VerticalCWOnXOY(e){return CoRScene.VerticalCWOnXOY(e)}createRendererSceneGraph(){return CoRScene.createRendererSceneGraph()}createEvtNode(){return CoRScene.createEvtNode()}isEnabled(){return i.VoxRenderer.isEnabled()&&"undefined"!==typeof CoRScene}}const S=new v;t.VoxRScene=S},d82c:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("3347");t.CoGeomDataType=n.CoGeomDataType,t.CoDataFormat=n.CoDataFormat;const i=r("7c62");class a{constructor(){this.m_loadedCall=null,this.m_loadedAllCall=null,this.m_loadTotal=0,this.m_loadedTotal=0,this.verTool=null}setListener(e,t){this.m_loadedCall=e,this.m_loadedAllCall=t}load(e,t=""){if(a.s_coapp.verTool=this.verTool,null!=e&&e.length>0){a.s_coapp.initialize(null,!0);let r=e.slice(0);a.s_coapp.deferredInit(()=>{for(let e=0;e<r.length;++e)this.loadModel(r[e],t)})}}reset(){this.m_loadedTotal=0,this.m_loadTotal=0}loadModel(e,t=""){let r=t;if(""==t){let t=e.lastIndexOf(".")+1,n=e.lastIndexOf("?");r=n<0?e.slice(t):e.slice(t,n)}r=r.toLocaleLowerCase();let i=n.CoDataFormat.Undefined;switch(r){case"obj":i=n.CoDataFormat.OBJ;break;case"fbx":i=n.CoDataFormat.FBX;break;case"drc":i=n.CoDataFormat.Draco;break;case"ctm":i=n.CoDataFormat.CTM;break;default:break}i!=n.CoDataFormat.Undefined&&this.loadGeomModel(e,i)}loadGeomModel(e,t){let r=a.s_coapp;if(null!=r){let i=r.getCPUDataByUrlAndCallback(e,t,(e,r)=>{t!=n.CoDataFormat.FBX&&(this.loadedModels(e.data.models,e.data.transforms,t,e.url),this.m_loadTotal++,this.loadedModelFromUnit(e,r))},!0);t==n.CoDataFormat.FBX&&(i.data.modelReceiver=(e,r,n,a)=>{0==n&&this.m_loadTotal++,this.loadedModels(e,r,t,i.url),this.loadedModelFromUnit(i,0,n+1==a)})}}loadedModels(e,t,r,n){null!=this.m_loadedCall&&this.m_loadedCall(e,t,r,n)}loadedModelFromUnit(e,t=0,r=!0){if(r&&this.m_loadedTotal++,this.m_loadedTotal>=this.m_loadTotal){let t=this.m_loadedTotal;this.reset(),this.m_loadedAllCall(t,e.url)}}destroy(){this.m_loadedCall=null}}a.s_coapp=new i.CoDataModule,t.CoGeomModelLoader=a},dab7:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("75f5");var i,a,s,o,l,c,d,u;t.RenderDrawMode=i,t.CullFaceMode=a,t.DepthTestMode=s,t.RenderBlendMode=o,t.GLStencilFunc=l,t.GLStencilOp=c,t.GLBlendMode=d,t.GLBlendEquation=u;class h{constructor(){this.m_init=!0}init(){"undefined"!==typeof CoRenderer&&(t.RenderDrawMode=i=CoRenderer.RenderDrawMode,t.CullFaceMode=a=CoRenderer.CullFaceMode,t.DepthTestMode=s=CoRenderer.DepthTestMode,t.RenderBlendMode=o=CoRenderer.RenderBlendMode,t.GLStencilFunc=l=CoRenderer.GLStencilFunc,t.GLStencilOp=c=CoRenderer.GLStencilOp,t.GLBlendMode=d=CoRenderer.GLBlendMode,t.GLBlendEquation=u=CoRenderer.GLBlendEquation)}initialize(e=null,t=""){return this.init(),this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=t&&void 0!==t||(t="static/cospace/engine/renderer/CoRenderer.umd.min.js"),new n.ModuleLoader(1,()=>{this.init(),null!=e&&this.isEnabled()&&e([t])}).load(t),!0)}get RenderDrawMode(){return CoRenderer.RenderDrawMode}get CullFaceMode(){return CoRenderer.CullFaceMode}get DepthTestMode(){return CoRenderer.DepthTestMode}get RenderBlendMode(){return CoRenderer.RenderBlendMode}get GLStencilFunc(){return CoRenderer.GLStencilFunc}get GLStencilOp(){return CoRenderer.GLStencilOp}get GLBlendMode(){return CoRenderer.GLBlendMode}get GLBlendEquation(){return CoRenderer.GLBlendEquation}get RendererDevice(){return CoRenderer.RendererDevice}get RendererState(){return CoRenderer.RendererState}createRendererInstance(){return CoRenderer.createRendererInstance()}isEnabled(){return"undefined"!==typeof CoRenderer}}const m=new h;t.VoxRenderer=m},ebc0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.m_scaleV=null,this.m_tempMat=null,this.m_currMat=null,this.m_aabb=null,this.m_sizeScale=1,this.m_entities=[],this.m_transforms=[],this.rotationEnabled=!1}initialize(){null==this.m_scaleV&&(this.m_scaleV=CoRScene.createVec3(),this.m_tempMat=CoRScene.createMat4(),this.m_currMat=CoRScene.createMat4(),this.m_aabb=CoRScene.createAABB())}getAABB(){return this.m_aabb}layoutReset(){this.m_entities=[],this.m_transforms=[]}layoutAppendItem(e,t){this.m_entities.push(e),this.m_transforms.push(t)}layoutUpdate(e=300,t=null,r=!1){this.rotationEnabled=r;for(let n=0;n<this.m_entities.length;++n){let e=this.m_entities[n];e.setXYZ(0,0,0),e.setScaleXYZ(1,1,1),e.setRotationXYZ(0,0,0)}null==t&&(t=CoRScene.createVec3()),this.fixToPosition(this.m_entities,this.m_transforms,t,e)}calcAABB(e,t){this.initialize();let r=this.m_aabb;for(let n=0;n<e.length;++n)e[n].update(),n>0?r.union(e[n].getGlobalBounds()):r.copyFrom(e[n].getGlobalBounds());return r.update(),r}fixToPosition(e,t,r,n=300){this.initialize();let i,a=this.m_tempMat,s=this.m_currMat,o=this.m_aabb;for(let h=0;h<e.length;++h)i=t[h],a.identity(),this.rotationEnabled&&a.setRotationEulerAngle(.5*Math.PI,0,0),null!=i?(s.copyFrom(i),s.append(a),e[h].getTransform().setParentMatrix(s)):(s.copyFrom(a),e[h].getTransform().setParentMatrix(s)),e[h].update(),h>0?o.union(e[h].getGlobalBounds()):o.copyFrom(e[h].getGlobalBounds());o.update();let l=n/o.getWidth(),c=n/o.getHeight(),d=n/o.getLong();l=Math.min(l,c,d),this.m_sizeScale=l,this.m_scaleV.setXYZ(l,l,l),o.reset();for(let h=0;h<e.length;++h){i=t[h],a.identity(),a.setScale(this.m_scaleV),this.rotationEnabled&&a.setRotationEulerAngle(.5*Math.PI,0,0),null!=i?(s.copyFrom(i),s.append(a)):s.copyFrom(a);let r=s.decompose(CoMath.OrientationType.EULER_ANGLES);e[h].setScale3(r[2]),e[h].setRotation3(r[1]),e[h].setPosition(r[0]),e[h].getTransform().setParentMatrix(null),e[h].update(),h>0?o.union(e[h].getGlobalBounds()):o.copyFrom(e[h].getGlobalBounds())}o.update();let u=CoRScene.createVec3();u.subVecsTo(r,o.center),o.reset();for(let h=0;h<e.length;++h){let t=e[h].getPosition();t.addBy(u),e[h].setPosition(t),e[h].update(),h>0?o.union(e[h].getGlobalBounds()):o.copyFrom(e[h].getGlobalBounds())}o.update()}getSizeScale(){return this.m_sizeScale}}t.CoEntityLayouter=n},f042:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("75f5");var i,a,s;t.OrientationType=i,t.MathConst=a,t.Vector3D=s;class o{constructor(){this.m_init=!0}init(){this.isEnabled()&&(t.OrientationType=i=CoMath.OrientationType,t.MathConst=a=CoMath.MathConst,t.Vector3D=s=CoMath.Vector3D)}initialize(e=null,t=""){return this.init(),this.m_init=!this.isEnabled(),!!this.m_init&&(this.m_init=!1,""!=t&&void 0!==t||(t="static/cospace/math/CoMath.umd.min.js"),new n.ModuleLoader(1,()=>{this.init(),null!=e&&this.isEnabled()&&e([t])}).load(t),!0)}isEnabled(){return"undefined"!==typeof CoMath}get Vector3D(){return CoMath.Vector3D}get MathConst(){return CoMath.MathConst}get OrientationType(){return CoMath.OrientationType}createVec3(e,t,r,n){return CoMath.createVec3(e,t,r,n)}createMat4(e,t){return CoMath.createMat4(e,t)}createAABB(){return CoMath.createAABB()}createAABB2D(e,t,r,n){return CoMath.createAABB2D(e,t,r,n)}isZero(e){return CoMath.isZero(e)}isNotZero(e){return CoMath.isNotZero(e)}isGreaterPositiveZero(e){return CoMath.isGreaterPositiveZero(e)}isLessNegativeZero(e){return CoMath.isLessNegativeZero(e)}isLessPositiveZero(e){return CoMath.isLessPositiveZero(e)}isGreaterNegativeZero(e){return CoMath.isGreaterNegativeZero(e)}isPostiveZero(e){return CoMath.isPostiveZero(e)}isNegativeZero(e){return CoMath.isNegativeZero(e)}isGreaterRealZero(e){return CoMath.isGreaterRealZero(e)}isLessRealZero(e){return CoMath.isLessRealZero(e)}}const l=new o;t.VoxMath=l},fae3:function(e,t,r){"use strict";r.r(t);r("1eb2");var n=r("b6e0");for(var i in n)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(i)},fd42:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("d82c");t.CoGeomDataType=n.CoGeomDataType;class i{constructor(e){this.m_map=new Map,this.m_total=0,this.m_loadedTotal=0,this.models=[],this.transforms=[],this.init(e)}init(e){this.urls=e,this.m_total=e.length;for(let t=0;t<this.m_total;++t)this.m_map.set(e[t],0)}testWithUrl(e){let t=!1;if(this.m_map.has(e)&&this.m_map.get(e)<1&&(this.m_map.set(e,1),this.m_loadedTotal++,t=this.m_loadedTotal>=this.m_total,t)){let e=this.callback;e(this.models,this.transforms),this.callback=null}return t}}class a{constructor(){this.m_modelLoader=new n.CoGeomModelLoader,this.m_team=null,this.m_teams=[],this.m_enabled=!0,this.verTool=null,this.initialize()}initialize(){this.m_modelLoader.setListener((e,t)=>{if(null!=this.m_team)for(let r=0;r<e.length;++r)null!=e[r]&&null!=e[r].vertices&&(t?this.m_team.transforms.push(t[r]):this.m_team.transforms.push(null),this.m_team.models.push(e[r]))},(e,t)=>{let r=this.m_team.testWithUrl(t);r&&(this.m_enabled=!0,this.loadNext())})}loadNext(){if(this.m_enabled&&this.m_teams.length>0){let e=this.m_teams.shift();this.m_team=e,this.m_enabled=!1,this.m_modelLoader.load(e.urls)}}load(e,t){this.m_modelLoader.verTool=this.verTool;let r=new i(e);r.callback=t,this.m_teams.push(r),this.loadNext()}}t.CoModelTeamLoader=a}})}));