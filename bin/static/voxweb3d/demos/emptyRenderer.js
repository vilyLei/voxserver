(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["VoxApp"]=e():t["VoxApp"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fae3")}({"030e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static Initialize(t,e){let i=this;1==t?(i.OES_standard_derivatives=e.getExtension("OES_standard_derivatives"),i.OES_standard_derivatives,i.EXT_shader_texture_lod=e.getExtension("EXT_shader_texture_lod"),i.EXT_shader_texture_lod,i.WEBGL_draw_buffers=e.getExtension("WEBGL_draw_buffers"),i.WEBGL_draw_buffers,i.OES_vertex_array_object=e.getExtension("OES_vertex_array_object"),i.OES_vertex_array_object,i.ANGLE_instanced_arrays=e.getExtension("ANGLE_instanced_arrays"),i.ANGLE_instanced_arrays,i.EXT_color_buffer_float=e.getExtension("EXT_color_buffer_float"),i.EXT_color_buffer_float,i.EXT_color_buffer_half_float=e.getExtension("EXT_color_buffer_half_float"),i.EXT_color_buffer_half_float,i.OES_texture_half_float=e.getExtension("OES_texture_half_float"),i.OES_texture_half_float,i.OES_texture_half_float_linear=e.getExtension("OES_texture_half_float_linear"),i.OES_texture_half_float_linear,i.OES_texture_float=e.getExtension("OES_texture_float"),i.OES_texture_float,i.OES_element_index_uint=e.getExtension("OES_element_index_uint"),i.OES_element_index_uint,i.EXT_blend_minmax=e.getExtension("EXT_blend_minmax"),i.EXT_blend_minmax):(i.EXT_shader_texture_lod=e.getExtension("EXT_shader_texture_lod"),i.EXT_shader_texture_lod,i.EXT_color_buffer_half_float=e.getExtension("EXT_color_buffer_half_float"),i.EXT_color_buffer_half_float,i.OES_texture_half_float_linear=e.getExtension("OES_texture_half_float_linear"),i.OES_texture_half_float_linear,i.EXT_color_buffer_float=e.getExtension("EXT_color_buffer_float"),i.EXT_color_buffer_float),i.OES_texture_float_linear=e.getExtension("OES_texture_float_linear"),i.OES_texture_float_linear,i.WEBGL_depth_texture=e.getExtension("WEBGL_depth_texture"),i.WEBGL_depth_texture,i.WEBGL_debug_renderer_info=e.getExtension("WEBGL_debug_renderer_info"),i.WEBGL_debug_renderer_info}}s.OES_standard_derivatives=null,s.EXT_shader_texture_lod=null,s.WEBGL_draw_buffers=null,s.OES_vertex_array_object=null,s.ANGLE_instanced_arrays=null,s.EXT_color_buffer_float=null,s.EXT_color_buffer_half_float=null,s.OES_texture_float_linear=null,s.OES_texture_half_float_linear=null,s.OES_texture_half_float=null,s.OES_texture_float=null,s.OES_element_index_uint=null,s.EXT_blend_minmax=null,s.WEBGL_depth_texture=null,s.WEBGL_debug_renderer_info=null,e.default=s},"090c":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("030e")),a=s(i("3b73")),h=s(i("b0ef")),n=s(i("0c85")),_=i("e08e");class l{constructor(){this.A=l.B_O++,this.B=new n.default,this.C=null,this.D=null,this.E=null,this.F=!1,this.G=!0,this.H=!0,this.I=null,this.J=null,this.K=null,this.L=0,this.M=0,this.N=800,this.O=600,this.P=2,this.Q=2,this.R=1,this.S=new h.default,this.autoSyncRenderBufferAndWindowSize=!0,this.offscreenRenderEnabled=!1,this.T=null,this.U=0,this.V=0,this.W=0,this.X=0,this.Y=null,this.Z=null}contextrestoredHandler(t){}contextlostHandler(t){}setWebGLMaxVersion(t){1!=t&&2!=t||(this.P=t)}getWebGLVersion(){return this.Q}getDiv(){return this.C}setDivStyleLeftAndTop(t,e){this.S.setDivStyleLeftAndTop(t,e)}setDivStyleSize(t,e){this.S.setDivStyleSize(t,e)}getCanvas(){return this.D}isDepthTestEnabled(){return this.G}isStencilTestEnabled(){return this.H}initialize(t,e,i,s=null){this.K=e;var h=null,n=null;try{void 0!=document&&(h=document,n=window)}catch(o){}if(null!=h){this.S.setDiv(i),this.S.createViewEle(h,this.autoSyncRenderBufferAndWindowSize),this.C=i=this.S.getDiv();let o=this.D=this.S.getCanvas();this.R=window.devicePixelRatio,this.B.dpr=this.R;let m=s;null==s?m={depth:this.G,premultipliedAlpha:!1,alpha:!0,antialias:!1,stencil:this.H,preserveDrawingBuffer:!0,powerPreference:"default"}:(this.G=m.depth,this.H=m.stencil);let d=null;if(this.offscreenRenderEnabled&&(d=o.transferControlToOffscreen()),this.I=d,2==this.P&&(this.J=null==d?o.getContext("webgl2",m):d.getContext("webgl2",m),null!=this.J&&(this.Q=2)),null==this.J&&(this.J=null==d?o.getContext("webgl",m)||o.getContext("experimental-webgl",m):d.getContext("webgl",m)||d.getContext("experimental-webgl",m),null!=this.J&&(this.Q=1)),!this.J)throw this.Q=-1,alert("Unable to initialize WebGL. Your browser or machine may not support it."),Error("WebGL initialization failure.");let u=this.J;u.rcuid=t;let c=_.GLStencilFunc;c.NEVER=u.NEVER,c.LESS=u.LESS,c.EQUAL=u.EQUAL,c.GREATER=u.GREATER,c.NOTEQUAL=u.NOTEQUAL,c.GEQUAL=u.GEQUAL,c.ALWAYS=u.ALWAYS;let f=_.GLStencilOp;f.KEEP=u.KEEP,f.ZERO=u.ZERO,f.REPLACE=u.REPLACE,f.INCR=u.INCR,f.INCR_WRAP=u.INCR_WRAP,f.DECR=u.DECR,f.DECR_WRAP=u.DECR_WRAP,f.INVERT=u.INVERT;let R=_.GLBlendMode;R.ZERO=u.ZERO,R.ONE=u.ONE,R.SRC_COLOR=u.SRC_COLOR,R.DST_COLOR=u.DST_COLOR,R.SRC_ALPHA=u.SRC_ALPHA,R.DST_ALPHA=u.DST_ALPHA,R.ONE_MINUS_SRC_ALPHA=u.ONE_MINUS_SRC_ALPHA;let p=_.GLBlendEquation;p.FUNC_ADD=u.FUNC_ADD,p.FUNC_SUBTRACT=u.FUNC_SUBTRACT,p.FUNC_REVERSE_SUBTRACT=u.FUNC_REVERSE_SUBTRACT,p.MIN_EXT=u.MIN_EXT,p.MAX_EXT=u.MAX_EXT,p.MIN=u.MIN,p.MAX=u.MAX;let E=_.CullFaceMode;E.BACK=u.BACK,E.FRONT=u.FRONT,E.FRONT_AND_BACK=u.FRONT_AND_BACK;let g=a.default;g.MAX_TEXTURE_SIZE=this.J.getParameter(this.J.MAX_TEXTURE_SIZE),g.MAX_RENDERBUFFER_SIZE=this.J.getParameter(this.J.MAX_RENDERBUFFER_SIZE);let T=this.J.getParameter(this.J.MAX_VIEWPORT_DIMS);g.MAX_VIEWPORT_WIDTH=T[0],g.MAX_VIEWPORT_HEIGHT=T[1],r.default.Initialize(this.Q,this.J),a.default.Initialize([this.Q]),null!=e&&this.B.initialize(o,i,e);let A=r.default.WEBGL_debug_renderer_info;if(null!=A){let t=this.J.getParameter(A.UNMASKED_VENDOR_WEBGL),e=this.J.getParameter(A.UNMASKED_RENDERER_WEBGL);g.GPU_VENDOR=t,g.GPU_RENDERER=e,a.default.IsWinExternalVideoCard()}var l=this;n.onresize=function(t){l.autoSyncRenderBufferAndWindowSize&&l.updateRenderBufferSize()},o.addEventListener("webglcontextrestored",this.contextrestoredHandler,!1),o.addEventListener("webglcontextlost",this.contextlostHandler,!1),this.updateRenderBufferSize()}}loseContext(){null==this.T&&(this.T=this.J.getExtension("WEBGL_lose_context")),null==this.T&&this.T.loseContext()}isContextLost(){return this.J.isContextLost()}getRC(){return this.J}setScissorEnabled(t){t?this.F||(this.F=!0,this.J.enable(this.J.SCISSOR_TEST)):this.F&&(this.F=!1,this.J.disable(this.J.SCISSOR_TEST))}setScissorRect(t,e,i,s){this.J.scissor(t,e,i,s)}setResizeCallback(t,e){this.Z=t,this.Y=e}getDevicePixelRatio(){return this.R}resizeBufferSize(t,e){t=Math.floor(t),e=Math.floor(e);let i=window.devicePixelRatio,s=Math.abs(i-this.R)>.02;this.R=i,this.B.dpr=i,a.default.SetDevicePixelRatio(this.R),(this.U!=t||this.V!=e||s)&&(this.U=t,this.V=e,this.W=Math.floor(t*i),this.X=Math.floor(e*i),null==this.I?(this.D.width=this.W,this.D.height=this.X):(this.I.width=this.W,this.I.height=this.X),this.D.style.width=this.U+"px",this.D.style.height=this.V+"px",null!=this.K&&(this.K.stageWidth=this.W,this.K.stageHeight=this.X,this.K.viewWidth=this.U,this.K.viewHeight=this.V,this.K.pixelRatio=i,this.K.update()),null!=this.Y&&this.Y.call(this.Z))}getStage(){return this.K}getStageWidth(){return this.K.stageWidth}getStageHeight(){return this.K.stageHeight}getDisplayWidth(){return this.U}getDisplayHeight(){return this.V}setViewport(t,e,i,s){let r=this.L!=t||this.M!=e;(this.N!=i||this.O!=s||r)&&(this.L=t,this.M=e,this.N=i,this.O=s)}setViewportSize(t,e){this.N==t&&this.O==e||(this.N=t,this.O=e)}testViewPortChanged(t,e,i,s){return this.L!=t||this.M!=e||this.N!=i||this.O!=s}getViewportX(){return this.L}getViewportY(){return this.M}getViewportWidth(){return this.N}getViewportHeight(){return this.O}getFBOWidth(){return this.N<a.default.MAX_RENDERBUFFER_SIZE?this.N:a.default.MAX_RENDERBUFFER_SIZE}getFBOHeight(){return this.O<a.default.MAX_RENDERBUFFER_SIZE?this.O:a.default.MAX_RENDERBUFFER_SIZE}getRCanvasWidth(){return this.W}getRCanvasHeight(){return this.X}updateRenderBufferSize(){let t=this.C.getBoundingClientRect();this.resizeBufferSize(t.width,t.height)}}l.B_O=0,e.default=l},"0c85":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3b73"));class a{constructor(){this.a=!1,this.b=0,this.c=0,this.d=0,this.dpr=1}initMobile(t,e,i){var s=null;try{void 0!=document&&(s=document)}catch(a){}if(null!=s){let t=this;if(e.addEventListener("touchstart",t=>{let e=t.targetTouches,s=0,r=0;if(e.length<2)s=0|this.dpr*t.targetTouches[0].pageX,r=0|this.dpr*t.targetTouches[0].pageY,i.mouseX=s,i.mouseY=i.stageHeight-r,i.mouseViewX=s,i.mouseViewY=r,this.a=!0,this.b=i.mouseX,this.c=i.mouseY,this.d=Date.now(),i.mouseDown(1);else{let a=[];for(let i=0;i<e.length;++i)s=0|this.dpr*t.targetTouches[i].pageX,r=0|this.dpr*t.targetTouches[i].pageY,a.push({x:s,y:r});i.mouseMultiDown(a),this.a=!1}t.preventDefault(),t.stopPropagation()},!1),e.addEventListener("touchend",t=>{this.a=!1;let e=t.targetTouches,s=0,r=0;if(e.length<1)i.mouseUp(1),this.d=Date.now()-this.d,Math.abs(this.b-i.mouseX)<3&&Math.abs(this.c-i.mouseY)<3&&this.d<900&&(this.b=i.mouseX,this.c=i.mouseY,i.mouseClick());else{let a=[];for(let i=0;i<e.length;++i)s=0|this.dpr*t.targetTouches[i].pageX,r=0|this.dpr*t.targetTouches[i].pageY,a.push({x:s,y:r});i.mouseMultiUp(a)}t.preventDefault()},!1),e.addEventListener("touchcancel",e=>{t.a=!1;e.targetTouches;i.mouseCancel(),e.preventDefault()},!1),e.addEventListener("touchmove",t=>{t.preventDefault();let e=t.targetTouches,s=0,r=0;if(this.a&&(s=0|this.dpr*e[0].pageX,r=0|this.dpr*e[0].pageY,i.mouseViewX=s,i.mouseViewY=r,i.mouseX=s,i.mouseY=i.stageHeight-r,i.mouseMove()),e.length>1){let a=[];for(let i=0;i<e.length;++i)s=0|this.dpr*t.targetTouches[i].pageX,r=0|this.dpr*t.targetTouches[i].pageY,a.push({x:s,y:r});i.mouseMultiMove(a)}},{passive:!1},!1),r.default.IsIpadOS()){let t=document.createElement("meta");t.name="viewport",t.content="width=device-width,initial-scale=1.0,minimum-scale=1.0, maximum-scale=1.0, user-scalable=no",document.getElementsByTagName("head")[0].appendChild(t)}}}initialize(t,e,i){r.default.IsMobileWeb()||r.default.IsIpadOS()||this.initPC(t,e,i),this.initMobile(t,e,i)}initPC(t,e,i){var s=null;try{void 0!=document&&(s=document)}catch(r){}if(null!=s){if(void 0==t.onmousewheel&&void 0!=t.addEventListener){let e=function(t){t.wheelDeltaY=-t.detail,i.mouseWheel(t)};t.addEventListener("DOMMouseScroll",e,!1)}t.onmousewheel=t=>{t.preventDefault(),t.stopPropagation(),i.mouseWheel(t)},t.onmousedown=t=>{let s=e.getBoundingClientRect(),r=0|this.dpr*(t.clientX-s.left),a=0|this.dpr*(t.clientY-s.top);i.mouseX=r,i.mouseY=i.stageHeight-a,i.mouseViewX=r,i.mouseViewY=a,this.b=i.mouseX,this.c=i.mouseY,this.d=Date.now(),0==t.button?i.mouseDown(1):2==t.button&&i.mouseRightDown(1)},t.onmouseup=t=>{let s=e.getBoundingClientRect(),r=0|this.dpr*(t.clientX-s.left),a=0|this.dpr*(t.clientY-s.top);i.mouseX=r,i.mouseY=i.stageHeight-a,0==t.button?i.mouseUp(1):2==t.button&&i.mouseRightUp(1)},document.onmouseup=t=>{0==t.button?i.mouseWindowUp(1):2==t.button&&i.mouseWindowRightUp(1)},t.onmousemove=t=>{let s=e.getBoundingClientRect(),r=0|this.dpr*(t.clientX-s.left),a=0|this.dpr*(t.clientY-s.top);i.mouseX=r,i.mouseY=i.stageHeight-a,i.mouseViewX=r,i.mouseViewY=a,i.mouseMove()},t.onclick=t=>{let s=e.getBoundingClientRect(),r=0|this.dpr*(t.clientX-s.left),a=0|this.dpr*(t.clientY-s.top);i.mouseX=r,i.mouseY=i.stageHeight-a,i.mouseViewX=r,i.mouseViewY=a,this.d=Date.now()-this.d,Math.abs(this.b-i.mouseX)<3&&Math.abs(this.c-i.mouseY)<3&&this.d<900&&(this.b=i.mouseX,this.c=i.mouseY,0==t.button?i.mouseClick():2==t.button&&i.mouseRightClick())},t.ondblclick=t=>{let s=e.getBoundingClientRect(),r=0|this.dpr*(t.clientX-s.left),a=0|this.dpr*(t.clientY-s.top);i.mouseX=r,i.mouseY=i.stageHeight-a,i.mouseViewX=r,i.mouseViewY=a,0==t.button?i.mouseDoubleClick():t.button}}}}e.default=a},"0e01":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("baae")),a=s(i("5326")),h=s(i("29ef")),n=s(i("de9d")),_=s(i("4f27")),l=s(i("7499"));class o{constructor(t){this.e=null,this.f=null,this.g=null,this.h=.1,this.i=5e3,this.j=45,this.k=0,this.k=t,this.f=new n.default(t)}getRCUid(){return this.k}getDiv(){return this.e.getDiv()}getCanvas(){return this.e.getCanvas()}getRenderAdapter(){return this.e}getRenderMaterialProxy(){return this.g}getRenderProxy(){return this.f}getTextureResTotal(){return this.f.Texture.getTextureResTotal()}getTextureAttachTotal(){return this.f.Texture.getAttachTotal()}getDevicePixelRatio(){return this.e.getDevicePixelRatio()}getStage3D(){return this.f.getStage3D()}getCamera(){return null!=this.f?this.f.getCamera():null}cameraLock(){this.f.cameraLock()}cameraUnlock(){this.f.cameraUnlock()}updateCamera(){null!=this.f&&this.f.updateCamera()}updateCameraDataFromCamera(t){null!=this.f&&this.f.updateCameraDataFromCamera(t)}lockRenderColorMask(){null!=this.f&&this.f.lockRenderColorMask()}unlockRendererColorMask(){null!=this.f&&this.f.unlockRenderState()}useGlobalRenderColorMask(t){null!=this.f&&(this.f.unlockRenderColorMask(),this.f.useRenderColorMask(t),this.f.lockRenderColorMask())}useGlobalRenderColorMaskByName(t){null!=this.f&&(this.f.unlockRenderColorMask(),this.f.useRenderColorMask(h.default.GetRenderColorMaskByName(t)),this.f.lockRenderColorMask())}getRenderColorMaskByName(t){return h.default.GetRenderColorMaskByName(t)}lockRenderState(){null!=this.f&&this.f.lockRenderState()}unlockRenderState(){null!=this.f&&this.f.unlockRenderState()}useGlobalRenderState(t){null!=this.f&&(this.f.unlockRenderState(),this.f.useRenderState(t),this.f.lockRenderState())}useGlobalRenderStateByName(t){null!=this.f&&(this.f.unlockRenderState(),this.f.useRenderState(h.default.GetRenderStateByName(t)),this.f.lockRenderState())}getRenderStateByName(t){return h.default.GetRenderStateByName(t)}lockMaterial(){null!=this.g&&this.g.lockMaterial()}unlockMaterial(){null!=this.g&&this.g.unlockMaterial()}isUnlockMaterial(){return this.g.isUnlockMatrial()}useGlobalMaterial(t,e=!1,i=!1){null!=this.g&&(this.g.unlockMaterial(),e?this.g.unlockTexture():this.g.lockTexture(),this.g.useGlobalMaterial(t,i),this.g.lockMaterial())}updateMaterialUniform(t){this.g.updateMaterialUniform(t)}clearBackBuffer(){this.f.clearBackBuffer()}setScissorRect(t,e,i,s){this.e.setScissorRect(t,e,i,s)}setScissorEnabled(t){this.e.setScissorEnabled(t)}setViewPort(t,e,i,s){this.f.setViewPort(t,e,i,s)}synFBOSizeWithViewport(){this.e.synFBOSizeWithViewport()}asynFBOSizeWithViewport(){this.e.asynFBOSizeWithViewport()}setFBOSizeFactorWithViewPort(t){this.e.setFBOSizeFactorWithViewPort(t)}createFBOAt(t,e,i,s,r=!1,a=!1,h=0){this.e.createFBOAt(t,e,i,s,r,a,h)}bindFBOAt(t,e){this.e.bindFBOAt(t,e)}setRenderToTexture(t,e=!1,i=!1,s=0){this.e.setRenderToTexture(t,e,i,s)}useFBO(t=!1,e=!1,i=!1){this.e.useFBO(t,e,i)}resetFBOAttachmentMask(t){this.e.resetFBOAttachmentMask(t)}setFBOAttachmentMaskAt(t,e){this.e.setFBOAttachmentMaskAt(t,e)}setRenderToBackBuffer(){null!=this.e&&(this.e.setRenderToBackBuffer(r.default.FRAMEBUFFER),this.g.renderBegin())}lockViewport(){this.e.lockViewport()}unlockViewport(){this.e.unlockViewport()}setClearDepth(t){this.e.setClearDepth(t)}getClearDepth(){return this.e.getClearDepth()}getViewportX(){return this.e.getViewportX()}getViewportY(){return this.e.getViewportY()}getViewportWidth(){return this.e.getViewportWidth()}getViewportHeight(){return this.e.getViewportHeight()}setContextViewSize(t,e){this.e.setContextViewSize(t,e)}setCameraParam(t,e,i){this.j=t,this.h=e,this.i=i,null!=this.f&&this.f.setCameraParam(t,e,i)}initialize(t,e,i,s,r){if(null==this.e){a.default.Initialize(this.f.getUid()),this.f.setCameraParam(this.j,this.h,this.i),this.f.setWebGLMaxVersion(t.maxWebGLVersion),this.f.initialize(t,e,i,s,s,r),this.k=this.f.getRCUid(),r.initialize(this.k,this.f.getRC(),this.f.getGLVersion()),this.e=this.f.getRenderAdapter(),this.e.bgColor.setRGBA4f(0,0,0,1);let h=this.f.getContext();h.setViewport(0,0,h.getRCanvasWidth(),h.getRCanvasHeight()),_.default.Initialize()}}initManager(t){null==this.g&&(this.g=new l.default,this.g.setDispBuilder(t))}setClearRGBColor3f(t,e,i){this.f.setClearRGBColor3f(t,e,i)}setClearRGBAColor4f(t,e,i,s){this.f.setClearRGBAColor4f(t,e,i,s)}getClearRGBAColor4f(t){t.copyFrom(this.e.bgColor)}updateRenderBufferSize(){this.e.updateRenderBufferSize()}vertexRenderBegin(){this.f.Vertex.renderBegin()}renderBegin(t=!0){null!=this.e&&(this.e.unlockViewport(),this.e.setClearDepth(1),this.f.Vertex.renderBegin(),this.g.renderBegin(),this.e.update(),this.e.setClearMaskClearAll(),this.e.renderBegin(),h.default.ResetInfo(),h.default.Reset(this.f.getRenderContext()),t&&(this.f.useCameraData(),this.f.updateCameraDataFromCamera(this.f.getCamera())))}resetState(){h.default.ResetState(),this.g.renderBegin()}resetmaterial(){this.g.renderBegin()}resetUniform(){this.g.resetUniform()}runEnd(){}}e.default=o},"11e6":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static AddContainerFlag(t){return 2147483648|t}static RemoveContainerFlag(t){return-2147483649&t}static AddSpaceUid(t,e){return-1048576&t|e}static RemoveSpaceUid(t){return-1048576&t}static GetSpaceUid(t){return 1048575&t}static AddRendererUid(t,e){return-133169153&t|e<<20}static RemoveRendererUid(t){return 133169152|t}static GetRendererUid(t){return t=(133169152&t)>>20,t<127?t:-1}static TestRendererUid(t){return t=(133169152&t)>>20,t<127}static AddSortEnabled(t){return 1073741824|t}static RemoveSortEnabled(t){return-1073741825&t}static TestSortEnabled(t){return 1073741824==(1073741824&t)}static AddRendererLoad(t){return 805306368|t}static RemoveRendererLoad(t){return-805306369&t}static TestSpaceContains(t){return(1048575&t)>0}static TestSpaceEnabled(t){return(1048575&t)<1}static TestSpaceEnabled2(t){return(1048575&t)<1&&2147483648!=(2147483648&t)}static TestContainerEnabled(t){return 133169152==(133169152&t)&&2147483648!=(2147483648&t)}static TestRendererEnabled(t){return 133169152==(938475520&t)&&2147483648!=(2147483648&t)}}s.DEFAULT=133169152,s.CONTAINER_FLAG=2147483648,s.CONTAINER_NOT_FLAG=-2147483649,s.SPACE_FLAG=1048575,s.SPACE_NOT_FLAG=-1048576,s.RENDERER_UID_FLAG=133169152,s.RENDERER_UID_NOT_FLAG=-133169153,s.RENDERER_UID_INVALID=127,s.SORT_FLAG=1073741824,s.SORT_NOT_FLAG=-1073741825,s.RENDERER_LOAD_FLAG=805306368,s.RENDERER_LOAD_NOT_FLAG=-805306369,s.RENDERER_ADN_LOAD_FLAG=938475520,e.default=s},1216:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("8e17")),a=s(i("3930")),h=s(i("baae")),n=s(i("722e")),_=s(i("8333")),l=s(i("6d49")),o=i("e08e"),m=i("8d98"),d=i("7c63"),u=s(i("29ef")),c=s(i("3024"));class f{constructor(t,e){this.k=0,this.l=null,this.J=null,this.m=!1,this.n={mr:!0,mg:!0,mb:!0,ma:!0},this.o=null,this.p=0,this.q=null,this.r=0,this.s=h.default.FRAMEBUFFER,this.t=[null,null,null,null,null,null,null,null],this.u=!0,this.v=!1,this.L=0,this.M=0,this.N=800,this.O=600,this.w=1,this.x=0,this.y=new r.default(0,0,800,600),this.z=1,this.A_=0,this.B_=new Uint16Array(8),this.C_=new Uint16Array(4),this.D_=1,this.F=!1,this.E_=null,this.F_=2,this.bgColor=new a.default,this.uViewProbe=null,this.G_=!1,this.H_=1,this.I_=!0,this.J_=!1,this.l=e,this.k=t}initialize(t,e,i){if(null==this.o&&(this.F_=t.getWebGLVersion(),this.E_=i,this.o=t,this.J=t.getRC(),this.J.disable(this.J.SCISSOR_TEST),t.isDepthTestEnabled()?this.J.enable(this.J.DEPTH_TEST):this.J.disable(this.J.DEPTH_TEST),t.isStencilTestEnabled()?this.J.enable(this.J.STENCIL_TEST):this.J.disable(this.J.STENCIL_TEST),this.J.enable(this.J.CULL_FACE),this.J.cullFace(this.J.BACK),this.J.enable(this.J.BLEND),e.getDitherEanbled()?this.J.enable(this.J.DITHER):this.J.disable(this.J.DITHER),this.J.frontFace(this.J.CCW),e.getPolygonOffsetEanbled()?this.J.enable(this.J.POLYGON_OFFSET_FILL):this.J.disable(this.J.POLYGON_OFFSET_FILL),this.p=this.J.COLOR_BUFFER_BIT|this.J.DEPTH_BUFFER_BIT|this.J.STENCIL_BUFFER_BIT,null==this.uViewProbe)){let t=this;t.uViewProbe=new c.default(1),this.uViewProbe.bindSlotAt(this.k),this.uViewProbe.setVec4DataWithArr4([this.L,this.M,this.N,this.O])}}setFrontFaceFlipped(t){this.m!=t&&(t?this.J.frontFace(this.J.CW):this.J.frontFace(this.J.CCW),this.m=t)}setPolygonOffset(t,e=0){this.J.polygonOffset(t,e),this.G_=!0}resetPolygonOffset(){this.G_&&(this.J.polygonOffset(0,0),this.G_=!1)}getDiv(){return this.o.getDiv()}getCanvas(){return this.o.getCanvas()}setClearDepth(t){this.w=t}getClearDepth(){return this.w}setContextViewSize(t,e){this.o.autoSyncRenderBufferAndWindowSize=!1,this.o.resizeBufferSize(t,e)}getViewportX(){return this.o.getViewportX()}getViewportY(){return this.o.getViewportY()}getViewportWidth(){return this.o.getViewportWidth()}getViewportHeight(){return this.o.getViewportHeight()}getFBOFitWidth(){return this.o.getFBOWidth()}getFBOFitHeight(){return this.o.getFBOHeight()}getRCanvasWidth(){return this.o.getRCanvasWidth()}getRCanvasHeight(){return this.o.getRCanvasHeight()}setColorMask(t,e,i,s){this.n.mr=t,this.n.mg=e,this.n.mb=i,this.n.ma=s}setClearMaskClearAll(){this.p=this.J.COLOR_BUFFER_BIT|this.J.DEPTH_BUFFER_BIT|this.J.STENCIL_BUFFER_BIT}setClearMaskClearOnlyColor(){this.p=this.J.COLOR_BUFFER_BIT}setClearMaskClearOnlyDepthAndStencil(){this.p=this.J.DEPTH_BUFFER_BIT|this.J.STENCIL_BUFFER_BIT}setScissorRect(t,e,i,s){this.F&&this.J.scissor(t,e,i,s)}setScissorEnabled(t){t?this.F||(this.F=!0,this.J.enable(this.J.SCISSOR_TEST)):this.F&&(this.F=!1,this.J.disable(this.J.SCISSOR_TEST))}clearDepth(t=1){this.w=t,this.x!==this.w&&(this.x=this.w,this.J.clearDepth(this.w)),this.J.clear(this.J.DEPTH_BUFFER_BIT)}clearColor(t){this.J.clearColor(t.r,t.g,t.b,t.a),this.J.clear(this.J.COLOR_BUFFER_BIT)}clear(){this.x!==this.w&&(this.x=this.w,this.J.clearDepth(this.w)),this.o.isStencilTestEnabled()&&this.J.clearStencil(this.A_),this.J.clearColor(this.bgColor.r,this.bgColor.g,this.bgColor.b,this.bgColor.a),this.J.clear(this.p)}reset(){this.E_.setCullFaceMode(o.CullFaceMode.BACK),this.E_.setDepthTestMode(o.DepthTestMode.OPAQUE),u.default.Reset(this.J)}getRenderContext(){return this.o}renderBegin(){null!=this.o&&(this.z=1,this.reseizeViewPort(),d.RenderStateObject.Unlock(),d.RenderStateObject.UseRenderState(u.default.NORMAL_STATE),d.RenderColorMask.Unlock(),d.RenderColorMask.UseRenderState(d.RenderColorMask.ALL_TRUE_COLOR_MASK),this.clear())}reseizeViewPort(){if(this.I_){let t=this.o.getDevicePixelRatio(),e=this.L!=this.o.getViewportX()||this.M!=this.o.getViewportY();e=e||this.N!=this.o.getViewportWidth(),e=e||this.O!=this.o.getViewportHeight(),e=e||Math.abs(this.H_-t)>.01,e&&(this.H_=t,this.L=this.o.getViewportX(),this.M=this.o.getViewportY(),this.N=this.o.getViewportWidth(),this.O=this.o.getViewportHeight(),this.uViewProbe.setVec4Data(this.L,this.M,this.N,this.O),this.uViewProbe.update(),this.J.viewport(this.L,this.M,this.N,this.O))}}reseizeFBOViewPort(){if(this.I_){let t=this.o.getDevicePixelRatio(),e=this.L!=this.y.x||this.M!=this.y.y;e=e||this.N!=this.y.z,e=e||this.O!=this.y.w,e=e||Math.abs(this.H_-t)>.01,e&&(this.H_=t,this.L=this.y.x,this.M=this.y.y,this.N=this.y.z,this.O=this.y.w,this.uViewProbe.setVec4Data(this.L,this.M,this.N,this.O),this.uViewProbe.update(),this.J.viewport(this.L,this.M,this.N,this.O))}}setViewProbeValue(t,e,i,s){this.uViewProbe.setVec4Data(t,e,i,s),this.uViewProbe.update()}lockViewport(){this.I_=!1}unlockViewport(){this.I_=!0}renderEnd(){}update(){}updateRenderBufferSize(){this.o.updateRenderBufferSize()}destroy(){this.o=null,this.E_=null}getDevicePixelRatio(){return this.o.getDevicePixelRatio()}loseContext(){this.o.loseContext()}isContextLost(){return this.o.isContextLost()}readPixels(t,e,i,s,r,a,h){this.J.readPixels(t,e,i,s,m.TextureFormat.ToGL(this.J,r),m.TextureDataType.ToGL(this.J,a),h)}setFBOViewRect(t,e,i,s){this.C_[0]=t,this.C_[1]=e,this.C_[2]=i,this.C_[3]=s,this.v=!0}createFBOAt(t,e,i,s,r=!1,a=!1,h=0){null==this.t[t]&&(t>7&&(t=7),this.s=e,this.q=new l.default(this.k,this.l,this.s),this.q.multisampleEnabled=h>0,this.q.multisampleLevel=h,this.q.writeDepthEnabled=r,this.q.writeStencilEnabled=a,this.q.initialize(this.J,i,s),this.t[t]=this.q,this.q.sizeFixed=!0)}resizeFBOAt(t,e,i){t>7?t=7:t<0&&(t=0),null!=this.t[t]&&this.t[t].resize(e,i)}getFBOWidthAt(t){return null!=this.t[t]?this.t[t].getWidth():0}getFBOHeightAt(t){return null!=this.t[t]?this.t[t].getHeight():0}synFBOSizeWithViewport(){this.J_=!0}asynFBOSizeWithViewport(){this.J_=!1}setFBOSizeFactorWithViewPort(t){this.z=t}bindFBOAt(t,e){if(t>7?t=7:t<0&&(t=0),this.q=this.t[t],null==this.q)throw Error("Fatal Error!!! this.q == null.");this.r=t,this.s=e,this.q.bind(e),this.u=!0}clearFBODepthAt(t,e=1){let i=this.t[t];null!=i&&i.clearOnlyDepth(e)}resetFBOAttachmentMask(t){null!=this.q&&this.q.resetAttachmentMask(t)}setFBOAttachmentMaskAt(t,e){null!=this.q&&this.q.setAttachmentMaskAt(t,e)}getFBOAttachmentTotal(){return null!=this.q?this.q.getAttachmentTotal():0}setRenderToTexture(t,e=!1,i=!1,s=0){(s<0||s>=8)&&(s=0),null==t&&0==s?this.setRenderToBackBuffer(h.default.FRAMEBUFFER):(0==s&&(null!=this.q&&(this.J_?this.q.initialize(this.J,Math.floor(this.o.getFBOWidth()*this.z),Math.floor(this.o.getFBOHeight()*this.z)):this.v?this.q.initialize(this.J,this.C_[2],this.C_[3]):this.q.sizeFixed||this.q.initialize(this.J,t.getWidth(),t.getHeight())),this.r>=0&&null==this.q&&(this.q=new l.default(this.k,this.l,this.s),this.t[this.r]=this.q,this.q.writeDepthEnabled=e,this.q.writeStencilEnabled=i,this.J_?this.q.initialize(this.J,Math.floor(this.o.getFBOWidth()*this.z),Math.floor(this.o.getFBOHeight()*this.z)):this.v?this.q.initialize(this.J,this.C_[2],this.C_[3]):this.q.initialize(this.J,t.getWidth(),t.getHeight()))),null!=this.q&&this.q.renderToTexAt(this.J,t,s),this.u=!0)}getActiveAttachmentTotal(){return this.D_}getAttachmentTotal(){return this.D_}useFBO(t=!1,e=!1,i=!1){null!=this.q&&this.u&&(this.u=!1,this.q.use(this.J),this.D_=this.q.getActiveAttachmentTotal(),t&&this.q.clearOnlyColor(this.bgColor),this.q.writeDepthEnabled?this.q.writeStencilEnabled?e&&i?this.q.clearOnlyDepthAndStencil(this.w,4294967295):e?this.q.clearOnlyDepth(this.w):i&&this.q.clearOnlyStencil(255):e&&this.q.clearOnlyDepth(this.w):i&&this.q.writeStencilEnabled&&this.q.clearOnlyStencil(255),1==this.F_&&this.J.clear(this.p),this.B_[4]=this.B_[0]=this.L,this.B_[5]=this.B_[1]=this.M,this.B_[6]=this.B_[2]=this.L+this.N,this.B_[7]=this.B_[3]=this.M+this.O,this.v?(this.v=!1,this.y.setTo(this.C_[0],this.C_[1],this.C_[2],this.C_[3]),this.reseizeFBOViewPort()):(this.J_?this.y.setTo(0,0,Math.floor(this.o.getFBOWidth()*this.z),Math.floor(this.o.getFBOHeight()*this.z)):(this.q.isSizeChanged()&&this.q.initialize(this.J,this.q.getWidth(),this.q.getHeight()),this.y.setTo(0,0,this.q.getWidth(),this.q.getHeight())),this.reseizeFBOViewPort()))}setRenderToBackBuffer(t=h.default.FRAMEBUFFER){this.D_=1,l.default.BindToBackbuffer(this.J,t),this.reseizeViewPort()}bindFBOToDraw(){null!=this.q&&this.q.bind(h.default.DRAW_FRAMEBUFFER)}bindFBOToWrite(){null!=this.q&&this.q.bind(h.default.READ_FRAMEBUFFER)}setBlitFboSrcRect(t,e,i,s){this.B_[0]=t,this.B_[1]=e,this.B_[2]=t+i,this.B_[3]=e+s}setBlitFboDstRect(t,e,i,s){this.B_[4]=t,this.B_[5]=e,this.B_[6]=t+i,this.B_[7]=e+s}blitFBO(t=0,e=0,i=_.default.COLOR_BUFFER_BIT,s=n.default.NEAREST,r=0,a=0,o=null){t>7&&(t=7),e>7&&(e=7),t>=0&&null!=this.t[t]?this.t[t].bind(h.default.READ_FRAMEBUFFER):l.default.BindToBackbuffer(this.J,h.default.READ_FRAMEBUFFER),e>=0&&null!=this.t[e]?this.t[e].bind(h.default.DRAW_FRAMEBUFFER):l.default.BindToBackbuffer(this.J,h.default.DRAW_FRAMEBUFFER),r>0&&(a<0&&(a=0),null==o&&(o=[0,0,0,1]),this.J.clearBufferfv(r,a,o));let m=this.B_;this.J.blitFramebuffer(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],i,s)}}e.default=f},1264:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("11e6")),a=i("e08e"),h=i("eca0");class n{constructor(t,e,i,s){this.K_=null,this.L_=null,this.M_=null,this.N_=[],this.O_=[],this.P_=-1,this.Q_=0,this.R_=null,this.S_=null,this.version=0,this.P_=t,this.L_=e,this.K_=i,this.M_=s}setListener(t){this.S_=t}isEmpty(){return this.Q_<1}isHaveEntity(){return this.Q_>0}removeEntity(t){this.Q_--;let e=t.getDisplay();if(null!=e&&null!=e.__$$runit){let t=e.__$ruid,i=this.K_.getRCRPObj(t);if(null!=i){if(i.count>0)if(i.count<2)i.rprocessUid>-1&&(this.R_=this.M_.getNodeByUid(i.rprocessUid),this.R_.removeDisp(e),i.rprocessUid=-1);else{let t=h.RCRPObj.RenerProcessMaxTotal;for(let s=0;s<t;++s)(i.idsFlag&1<<s)>0&&(this.R_=this.M_.getNodeByUid(s),this.R_.removeDisp(e))}}else this.R_=this.M_.getNodeByUid(e.__$$runit.getRPROUid()),this.R_.removeDisp(e);0==i.count&&(e.__$$rsign,a.DisplayRenderSign.LIVE_IN_RENDERER,e.__$$rsign=a.DisplayRenderSign.NOT_IN_RENDERER,this.K_.restoreByUid(t)),this.version++}t.__$rseFlag=r.default.RemoveRendererUid(t.__$rseFlag),t.__$rseFlag=r.default.RemoveRendererLoad(t.__$rseFlag),t.__$rseFlag=r.default.RemoveSortEnabled(t.__$rseFlag),null!=this.S_&&this.S_.removeFromRenderer(t,this.P_,-1)}addEntity(t,e,i=!1){if(null!=t){let s=t.getDisplay();if(null!=s){if(s.__$$rsign==a.DisplayRenderSign.LIVE_IN_RENDERER&&!this.K_.testRPNodeNotExists(s.__$ruid,e))return;this.R_=this.M_.getNodeByUid(e),t.__$rseFlag=this.R_.getSortEnabled()?r.default.AddSortEnabled(t.__$rseFlag):r.default.RemoveSortEnabled(t.__$rseFlag),i?(s.__$$rsign==a.DisplayRenderSign.NOT_IN_RENDERER&&(s.__$$rsign=a.DisplayRenderSign.GO_TO_RENDERER),t.__$rseFlag=r.default.AddRendererLoad(t.__$rseFlag),t.__$rseFlag=r.default.AddRendererUid(t.__$rseFlag,this.P_),this.N_.push(t),this.O_.push(e)):this.testValidData(t)?this.ensureAdd(t,s,e):(s.__$$rsign==a.DisplayRenderSign.NOT_IN_RENDERER&&(s.__$$rsign=a.DisplayRenderSign.GO_TO_RENDERER),t.__$rseFlag=r.default.AddRendererLoad(t.__$rseFlag),this.N_.push(t),this.O_.push(e))}else t.__$rseFlag=r.default.AddRendererUid(t.__$rseFlag,this.P_)}return!1}testValidData(t){if(null!=t.getMaterial()&&t.hasMesh()){if(t.getMaterial().hasShaderData())return!0;null!=t.getMaterial().getCodeBuf()&&t.activeDisplay()}return!1}ensureAdd(t,e,i){t.update(),t.__$rseFlag=r.default.AddRendererUid(t.__$rseFlag,this.P_),t.__$rseFlag=r.default.RemoveRendererLoad(t.__$rseFlag),t.__$setRenderProxy(this.L_.getRenderProxy()),this.Q_++,e.__$$rsign==a.DisplayRenderSign.NOT_IN_RENDERER&&(e.__$$rsign=a.DisplayRenderSign.GO_TO_RENDERER),this.R_=this.M_.getNodeByUid(i),(e.__$ruid>-1||this.L_.buildGpuDisp(e))&&this.R_.addDisp(e),null!=this.S_&&this.S_.addToRenderer(t,this.P_,i),null!=t.getGlobalBounds()&&(e.__$$runit.bounds=t.getGlobalBounds(),e.__$$runit.pos=e.__$$runit.bounds.center),this.version++}updateWaitList(){let t=this.N_.length,e=null,i=null;for(let s=0;s<t;++s)if(e=this.N_[s],(r.default.RENDERER_LOAD_FLAG&e.__$rseFlag)==r.default.RENDERER_LOAD_FLAG){if(this.testValidData(e)){if(i=e.getDisplay(),i.__$$rsign==a.DisplayRenderSign.LIVE_IN_RENDERER&&!this.K_.testRPNodeNotExists(i.__$ruid,this.O_[s])){this.N_.splice(s,1),this.O_.splice(s,1),--t,--s;continue}this.ensureAdd(e,i,this.O_[s]),this.N_.splice(s,1),this.O_.splice(s,1),--t,--s}}else i=e.getDisplay(),null!=i&&i.__$$rsign==a.DisplayRenderSign.GO_TO_RENDERER&&(i.__$$rsign=a.DisplayRenderSign.NOT_IN_RENDERER),e.__$rseFlag=r.default.RemoveRendererLoad(e.__$rseFlag),e.__$rseFlag=r.default.RemoveRendererUid(e.__$rseFlag),e.__$rseFlag=r.default.RemoveSortEnabled(e.__$rseFlag),this.N_.splice(s,1),this.O_.splice(s,1),--t,--s,null!=this.S_&&this.S_.removeFromRenderer(e,this.P_,-1)}update(){this.N_.length>0&&this.updateWaitList(),this.L_.update()}}e.default=n},"1e15":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("8a0a")),a=s(i("030e"));class h{constructor(){this.k=0,this.T_=2,this.U_=null,this.RGBA=0,this.UNSIGNED_BYTE=0,this.TRIANGLE_STRIP=0,this.TRIANGLE_FAN=0,this.TRIANGLES=0,this.LINES=0,this.LINE_STRIP=0,this.UNSIGNED_SHORT=0,this.UNSIGNED_INT=0,this.COLOR=0,this.DEPTH=0,this.STENCIL=0,this.DEPTH_STENCIL=0,this.MAX=0,this.MIN=0,this.RContext=null,this.vroUid=0,this.rioUid=0}getRC(){return this.U_}getRCUid(){return this.k}createBuf(){return this.U_.createBuffer()}deleteBuf(t){this.U_.deleteBuffer(t)}bindArrBuf(t){this.U_.bindBuffer(this.U_.ARRAY_BUFFER,t)}bindEleBuf(t){this.U_.bindBuffer(this.U_.ELEMENT_ARRAY_BUFFER,t)}arrBufSubData(t,e){this.U_.bufferSubData(this.U_.ARRAY_BUFFER,e,t)}arrBufData(t,e){this.U_.bufferData(this.U_.ARRAY_BUFFER,t,r.default.ToGL(this.U_,e))}eleBufSubData(t,e){this.U_.bufferSubData(this.U_.ELEMENT_ARRAY_BUFFER,e,t)}eleBufData(t,e){this.U_.bufferData(this.U_.ELEMENT_ARRAY_BUFFER,t,r.default.ToGL(this.U_,e))}arrBufDataMem(t,e){this.U_.bufferData(this.U_.ARRAY_BUFFER,t,r.default.ToGL(this.U_,e))}eleBufDataMem(t,e){this.U_.bufferData(this.U_.ELEMENT_ARRAY_BUFFER,t,r.default.ToGL(this.U_,e))}useVtxAttribsPtrTypeFloat(t,e,i,s,r,a){this.U_.bindBuffer(this.U_.ARRAY_BUFFER,e);for(let h=0;h<s;++h)t.vertexAttribPointerTypeFloat(i[h],a,r[h])}useVtxAttribsPtrTypeFloatMulti(t,e,i,s,r,a){for(let h=0;h<s;++h)this.U_.bindBuffer(this.U_.ARRAY_BUFFER,e[h]),t.vertexAttribPointerTypeFloat(i[h],a,r[h])}createVertexArray(){let t=null;return t=2==this.T_?this.U_.createVertexArray():a.default.OES_vertex_array_object.createVertexArrayOES(),t}bindVertexArray(t){return 2==this.T_?this.U_.bindVertexArray(t):a.default.OES_vertex_array_object.bindVertexArrayOES(t),t}deleteVertexArray(t){2==this.T_?this.U_.deleteVertexArray(t):a.default.OES_vertex_array_object.deleteVertexArrayOES(t)}testVROUid(t){return this.vroUid!=t&&(this.vroUid=t,!0)}testRIOUid(t){return this.rioUid!=t&&(this.rioUid=t,!0)}initialize(t,e,i){this.U_=e,this.k=t,this.T_=i;let s=this;s.RGBA=e.RGBA,s.UNSIGNED_BYTE=e.UNSIGNED_BYTE,s.TRIANGLE_STRIP=e.TRIANGLE_STRIP,s.TRIANGLE_FAN=e.TRIANGLE_FAN,s.TRIANGLES=e.TRIANGLES,s.LINES=this.U_.LINES,s.LINE_STRIP=e.LINE_STRIP,s.UNSIGNED_SHORT=e.UNSIGNED_SHORT,s.UNSIGNED_INT=e.UNSIGNED_INT,s.COLOR=e.COLOR,s.DEPTH=e.DEPTH,s.STENCIL=e.STENCIL,s.DEPTH_STENCIL=e.DEPTH_STENCIL,this.T_>1?(s.MIN=e.MIN,s.MAX=e.MAX):(s.MIN=a.default.EXT_blend_minmax.MIN_EXT,s.MAX=a.default.EXT_blend_minmax.MAX_EXT),s.RContext=e}renderBegin(){this.vroUid=-2,this.rioUid=-3}toString(){return"[Object ROVtxBuilder()]"}}e.default=h},"1eb2":function(t,e,i){"use strict";if("undefined"!==typeof window){var s=window.document.currentScript,r=i("8875");s=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var a=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(i.p=a[1])}},"20ef":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3b73")),a=s(i("8a0a"));class h{constructor(t){this.V_=null,this.A=-1,this.W_=null,this.k=-1,this.J=null,this.X_="",this.Y_=0,this.Z_=null,this.a_=null,this.b_=null,this.c_=null,this.d_=null,this.e_=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],this.f_=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],this.g_=null,this.h_=new Map,this.i_=new Map,this.j_=null,this.k_=null,this.dataUniformEnabled=!1,this.l_=0,this.p_=0,this.n_=null,this.o_=0,this.A=t}setShdData(t){this.V_=t,this.X_=t.getUniqueShaderName()}getUid(){return this.A}getTexTotal(){return this.V_.getTexTotal()}useTexLocation(){for(let t=0;t<this.Y_;t++)this.J.uniform1i(this.d_[t],t)}haveTexture(){return this.V_.haveTexture()}createLocations(){let t=0,e=0,i=this.V_.getAttriNSList();if(null!=i&&i.length>0&&null==this.Z_){this.dataUniformEnabled=!1;let s=this.V_.getAttriSizeList();this.Z_=[],this.a_=[],this.b_=[],e=i.length;let h=0,n=0;while(t<e)n=this.J.getAttribLocation(this.W_,i[t]),this.Z_.push(n),h=a.default.GetVBufAttributeTypeByNS(i[t]),this.a_.push(h),this.b_.push(s[t]),this.e_[h]=n,this.f_[h]=s[t],this.dataUniformEnabled=!0,++t;for(this.g_=[],t=0;t<this.f_.length;++t)this.f_[t]>0&&this.g_.push(this.f_[t]);r.default.SHADERCODE_TRACE_ENABLED}if(this.V_.haveCommonUniform()&&null==this.c_){let i=this.V_.getUniforms();this.c_=[],e=i.length,t=0;let s=null,a="";while(t<e)i[t].isTex||(a=i[t].name,s=this.J.getUniformLocation(this.W_,a),r.default.SHADERCODE_TRACE_ENABLED,null!=s?(s.uniformName=a,s.uniqueName=this.X_,i[t].location=s,this.h_.set(a,i[t]),this.i_.set(a,s),this.c_.push(s),this.dataUniformEnabled=!0):r.default.SHADERCODE_TRACE_ENABLED),++t}if(this.Y_=this.V_.getTexTotal(),this.Y_>0){this.d_=new Array(this.Y_);let e=this.V_.getTexUniformNames();for(t=0;t<this.Y_;++t)e[t]="u_sampler"+t,this.d_[t]=this.J.getUniformLocation(this.W_,e[t])}}getLayoutBit(){return this.V_.getLayoutBit()}getMid(){return this.V_.getMid()}getFragOutputTotal(){return this.V_.getFragOutputTotal()}getLocationsTotal(){return this.a_.length}getLocationTypeByIndex(t){return this.a_[t]}getLocationSizeByIndex(t){return this.b_[t]}testVertexAttribPointerOffset(t){let e=!1;if(null!=t&&null!=this.g_&&t.length>=this.g_.length){let i=0,s=0;for(;s<this.g_.length;++s){if(i!=t[s])break;i+=4*this.g_[s]}e=s>=this.g_.length}if(!e)throw Error("Shader program vertx attributes layout can not match float attribute vertex data !!!");return e}vertexAttribPointerType(t,e,i,s,r,a){this.l_=this.e_[t],this.l_>-1&&(this.J.enableVertexAttribArray(this.l_),this.J.vertexAttribPointer(this.l_,this.f_[t],i,s,r,a))}vertexAttribPointerTypeFloat(t,e,i){this.l_=this.e_[t],this.l_>-1&&(this.J.enableVertexAttribArray(this.l_),this.J.vertexAttribPointer(this.l_,this.f_[t],this.J.FLOAT,!1,e,i))}testVertexAttribPointerType(t){return this.e_[t]>-1}getVertexAttribByTpye(t){return this.e_[t]}vertexAttribPointerAt(t,e,i,s,r,a){this.p_=t,this.l_=this.Z_[t],this.l_>-1&&(this.J.enableVertexAttribArray(this.l_),this.J.vertexAttribPointer(this.l_,e,i,s,r,a))}vertexAttribPointerNext(t,e,i,s,r){this.l_=this.Z_[this.p_],this.l_>-1&&(this.J.enableVertexAttribArray(this.l_),this.J.vertexAttribPointer(this.l_,t,e,i,s,r)),this.p_++}vertexAttribPointerFirst(t,e,i,s,r){this.p_=1,this.l_=this.Z_[0],this.l_>-1&&(this.J.enableVertexAttribArray(this.l_),this.J.vertexAttribPointer(this.l_,t,e,i,s,r))}getUniformLocationAt(t){return this.o_=t+1,this.c_[t]}getUniformLocationNext(){return this.n_=this.c_[this.o_++],this.n_}getUniformLocationFirst(){return this.o_=1,this.c_[0]}getUniformLocationByNS(t){return this.i_.get(t)}getUniformTypeNameByNS(t){return this.h_.has(t)?this.h_.get(t).typeName:""}getUniformTypeByNS(t){return this.h_.has(t)?this.h_.get(t).type:0}hasUniformByName(t){return this.h_.has(t)}getUniformLengthByNS(t){return this.h_.has(t)?this.h_.get(t).arrLength:0}initShdProgram(){let t,e=this.V_.getVSCodeStr(),i=this.V_.getFSCodeStr();r.default.VERT_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED&&(e.indexOf(" mediump ")>=0&&(t=new RegExp(" mediump ","g"),e=e.replace(t," highp ")),e.indexOf(" lowp ")>=0&&(t=new RegExp(" lowp ","g"),e=e.replace(t," highp "))),r.default.SHADERCODE_TRACE_ENABLED;let s=this.loadShader(this.J.VERTEX_SHADER,e);r.default.FRAG_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED&&(i.indexOf(" mediump ")>=0&&(t=new RegExp(" mediump ","g"),i=i.replace(t," highp ")),i.indexOf(" lowp ")>=0&&(t=new RegExp(" lowp ","g"),i=i.replace(t," highp "))),r.default.SHADERCODE_TRACE_ENABLED;let a=this.loadShader(this.J.FRAGMENT_SHADER,i),h=this.J.createProgram();return this.J.attachShader(h,a),this.J.attachShader(h,s),this.J.linkProgram(h),this.J.getProgramParameter(h,this.J.LINK_STATUS)?(this.j_=s,this.k_=a,h):(r.default.SHADERCODE_TRACE_ENABLED,null)}loadShader(t,e){let i=this.J.createShader(t);return this.J.shaderSource(i,e),this.J.compileShader(i),this.J.getShaderParameter(i,this.J.COMPILE_STATUS)?i:(r.default.SHADERCODE_TRACE_ENABLED,this.J.deleteShader(i),null)}getUniqueShaderName(){return this.X_}enabled(){return null!=this.W_}upload(t,e){null==this.W_&&(this.k=e,this.J=t,this.W_=this.initShdProgram(),this.W_.uniqueName=this.X_,null!=this.W_&&this.createLocations())}getRCUid(){return this.k}uniformBlockBinding(t,e){this.J.uniformBlockBinding(this.W_,this.J.getUniformBlockIndex(this.W_,t),e)}toString(){return"[ShdProgram(uniqueName = "+this.X_+")]"}getGPUProgram(){return this.W_}destroy(){this.Z_=null,this.g_=null,this.Y_>0&&(this.d_.fill(null),this.Y_=0),null!=this.W_&&(this.J.deleteShader(this.j_),this.J.deleteShader(this.k_),this.j_=null,this.k_=null,this.J.deleteProgram(this.W_),this.W_=null),this.J=null,this.V_=null}}e.default=h},2560:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("ab73")),a=s(i("7279"));class h{create(t,e){let i=null,s=t.getCamera();return e.hasUniformByName(r.default.CameraViewMatUNS)&&e.hasUniformByName(r.default.CameraProjectiveMatUNS)?(i=new a.default,i.uns="u_viewAndProjMat",i.uniformNameList=[r.default.CameraViewMatUNS,r.default.CameraProjectiveMatUNS],i.copyDataFromProbe(s.matUProbe)):e.hasUniformByName(r.default.CameraViewMatUNS)?(i=new a.default,i.uns="u_viewMat",i.uniformNameList=[r.default.CameraViewMatUNS],i.copyDataFromProbeAt(0,s.matUProbe)):e.hasUniformByName(r.default.CameraProjectiveMatUNS)&&(i=new a.default,i.uns="u_projMat",i.uniformNameList=[r.default.CameraProjectiveMatUNS],i.copyDataFromProbeAt(1,s.matUProbe)),i}getIDNS(){return"CameraUniformBuilder"}}e.default=h},"264c":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t){this.q_=null,this.r_=null,this.B_P=null,this.t_=null,this.u_=[],this.v_=0,this.w_=null,this.x_=0,this.y_=null,this.sortEnabled=!0,this.w_=t}setSorter(t){this.y_=t}showInfo(){let t="",e=this.q_;while(null!=e)t+=e.unit.value+",",e=e.next}clear(){if(null!=this.w_){this.u_.length>0&&(this.u_=[]);let t=this.q_,e=null;while(null!=t)e=t,t=t.next,e.prev=null,e.next=null;this.q_=this.r_=null,this.v_=0,this.x_=0,this.sortEnabled=!0,this.w_=null}this.y_=null}update(){this.sortEnabled&&this.sort()}run(t){this.w_.resetUniform();let e=null,i=this.u_;for(let s=0;s<this.x_;++s)e=i[s],this.w_.bindToGpu(e.shdUid),e.run(t),e.partTotal<1?e.drawThis(t):e.drawPart(t)}runLockMaterial(t){this.w_.resetUniform();let e=null,i=this.u_;for(let s=0;s<this.x_;++s)e=i[s],this.w_.bindToGpu(e.shdUid),e.vro.run(),e.runLockMaterial2(null),e.partTotal<1?e.drawThis(t):e.drawPart(t)}sort(){if(this.v_>0){let t=this.q_;this.u_.length<this.v_&&(this.u_=new Array(Math.round(1.1*this.v_)+1));let e=0;while(null!=t)t.drawEnabled&&t.unit.drawEnabled&&(this.u_[e]=t.unit,++e),t=t.next;this.x_=e;let i=0;null!=this.y_&&(i=this.y_.sortRODisplay(this.u_,e)),i<1&&this.snsort(0,e-1)}}sorting(t,e){let i=this.u_;this.t_=i[t];let s=this.t_.value;while(t<e){while(t<e&&i[e].value>=s)--e;i[t]=i[e];while(t<e&&i[t].value<=s)++t;i[e]=i[t]}return i[t]=this.t_,t}snsort(t,e){if(t<e){let i=this.sorting(t,e);this.snsort(t,i-1),this.snsort(i+1,e)}}getNodesTotal(){return this.v_}getBegin(){return this.B_P=this.q_,this.q_}getNext(){return null!=this.B_P&&(this.B_P=this.B_P.next),this.B_P}isEmpty(){return this.v_<1}addNode(t){null==t.prev&&null==t.next&&(null==this.q_?this.r_=this.q_=t:null!=this.r_.prev?(this.r_.next=t,t.prev=this.r_,this.r_=t):(this.q_.next=t,t.prev=this.r_,this.r_=t),this.r_.next=null,this.v_++)}removeNode(t){null==t.prev&&null==t.next&&t!=this.q_||(t==this.q_?t==this.r_?this.q_=this.r_=null:(this.q_=t.next,this.q_.prev=null):t==this.r_?(this.r_=t.prev,this.r_.next=null):(t.next.prev=t.prev,t.prev.next=t.next),t.prev=null,t.next=null,this.v_--)}}e.default=s},"265e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.__$ruid=-1,this.drawEnabled=!0,this.uid=-1,this.index=-1,this.drawMode=0,this.ivsIndex=0,this.ivsCount=0,this.insCount=0,this.shdUid=-1,this.vtxUid=-1,this.texMid=-1,this.rtokey=-1,this.prev=null,this.next=null,this.unit=null,this.vro=null,this.tro=null,this.rvroI=-1,this.rtroI=-1}setValue(t){this.unit.value=t}isVsible(){return null==this.unit||this.unit.drawEnabled}updateData(){let t=this.unit;this.drawMode=t.drawMode,this.ivsIndex=t.ivsIndex,this.ivsCount=t.ivsCount,this.insCount=t.insCount,t.drawOffset=t.ivsIndex*t.ibufStep,this.vtxUid=t.vtxUid,this.vro=t.vro,this.shdUid=t.shdUid,this.texMid=t.texMid,this.tro=t.tro}reset(){this.drawEnabled=!0,this.uid=-1,this.index=-1,this.drawMode=0,this.ivsIndex=0,this.ivsCount=0,this.insCount=0,this.shdUid=-1,this.vtxUid=-1,this.texMid=-1,this.rtokey=-1,this.unit=null,this.vro=null,this.tro=null,this.prev=null,this.next=null}toString(){return"[Object RPONode(uid = "+this.uid+", index = "+this.index+", shdUid = "+this.shdUid+", vtxUid = "+this.vtxUid+")]"}}e.default=s},"29ef":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("7c63"),r=i("e08e");class a{static Initialize(){if(a.B_Q){a.B_Q=!1;let t=a;t.Rstate=new s.RODrawState,s.RenderColorMask.Rstate=a.Rstate,s.RenderStateObject.Rstate=a.Rstate,t.COLOR_MASK_ALL_TRUE=s.RenderColorMask.Create("all_true",!0,!0,!0,!0),t.COLOR_MASK_ALL_FALSE=s.RenderColorMask.Create("all_false",!1,!1,!1,!1),t.COLOR_MASK_RED_TRUE=s.RenderColorMask.Create("red_true",!0,!1,!1,!1),t.COLOR_MASK_GREEN_TRUE=s.RenderColorMask.Create("green_true",!1,!0,!1,!1),t.COLOR_MASK_BLUE_TRUE=s.RenderColorMask.Create("blue_true",!1,!1,!0,!1),t.COLOR_MASK_ALPHA_TRUE=s.RenderColorMask.Create("alpha_true",!1,!1,!1,!0),t.COLOR_MASK_RED_FALSE=s.RenderColorMask.Create("red_false",!1,!0,!0,!0),t.COLOR_MASK_GREEN_FALSE=s.RenderColorMask.Create("green_false",!0,!1,!0,!0),t.COLOR_MASK_BLUE_FALSE=s.RenderColorMask.Create("blue_false",!0,!0,!1,!0),t.COLOR_MASK_ALPHA_FALSE=s.RenderColorMask.Create("alpha_false",!0,!0,!0,!1);let e=s.RenderStateObject,i=r.RenderBlendMode;i.NORMAL=e.CreateBlendMode("NORMAL",r.GLBlendMode.ONE,r.GLBlendMode.ZERO,r.GLBlendEquation.FUNC_ADD),i.OPAQUE=e.CreateBlendMode("OPAQUE",r.GLBlendMode.ONE,r.GLBlendMode.ZERO,r.GLBlendEquation.FUNC_ADD),i.TRANSPARENT=e.CreateBlendMode("TRANSPARENT",r.GLBlendMode.SRC_ALPHA,r.GLBlendMode.ONE_MINUS_SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),i.ALPHA_ADD=e.CreateBlendMode("ALPHA_ADD",r.GLBlendMode.ONE,r.GLBlendMode.ONE_MINUS_SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),i.ADD=e.CreateBlendMode("ADD",r.GLBlendMode.SRC_ALPHA,r.GLBlendMode.ONE,r.GLBlendEquation.FUNC_ADD),i.ADD_LINEAR=e.CreateBlendMode("ADD_LINEAR",r.GLBlendMode.ONE,r.GLBlendMode.ONE,r.GLBlendEquation.FUNC_ADD),i.INVERSE_ALPHA=e.CreateBlendMode("INVERSE_ALPHA",r.GLBlendMode.ONE,r.GLBlendMode.SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),i.BLAZE=e.CreateBlendMode("BLAZE",r.GLBlendMode.SRC_COLOR,r.GLBlendMode.ONE,r.GLBlendEquation.FUNC_ADD),i.OVERLAY=e.CreateBlendMode("OVERLAY",r.GLBlendMode.DST_COLOR,r.GLBlendMode.DST_ALPHA,r.GLBlendEquation.FUNC_ADD),i.OVERLAY2=e.CreateBlendMode("OVERLAY2",r.GLBlendMode.DST_COLOR,r.GLBlendMode.SRC_ALPHA,r.GLBlendEquation.FUNC_ADD),t.NORMAL_STATE=e.Create("normal",r.CullFaceMode.BACK,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),t.BACK_CULLFACE_NORMAL_STATE=t.NORMAL_STATE,t.FRONT_CULLFACE_NORMAL_STATE=e.Create("front_normal",r.CullFaceMode.FRONT,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),t.NONE_CULLFACE_NORMAL_STATE=e.Create("none_normal",r.CullFaceMode.NONE,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),t.ALL_CULLFACE_NORMAL_STATE=e.Create("all_cull_normal",r.CullFaceMode.FRONT_AND_BACK,r.RenderBlendMode.NORMAL,r.DepthTestMode.OPAQUE),t.BACK_NORMAL_ALWAYS_STATE=e.Create("back_normal_always",r.CullFaceMode.BACK,r.RenderBlendMode.NORMAL,r.DepthTestMode.ALWAYS),t.BACK_TRANSPARENT_STATE=e.Create("back_transparent",r.CullFaceMode.BACK,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.TRANSPARENT_SORT),t.BACK_TRANSPARENT_ALWAYS_STATE=e.Create("back_transparent_always",r.CullFaceMode.BACK,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.ALWAYS),t.NONE_TRANSPARENT_STATE=e.Create("none_transparent",r.CullFaceMode.NONE,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.TRANSPARENT_SORT),t.NONE_TRANSPARENT_ALWAYS_STATE=e.Create("none_transparent_always",r.CullFaceMode.NONE,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.ALWAYS),t.FRONT_CULLFACE_GREATER_STATE=e.Create("front_greater",r.CullFaceMode.FRONT,r.RenderBlendMode.NORMAL,r.DepthTestMode.TRUE_GREATER),t.BACK_ADD_BLENDSORT_STATE=e.Create("back_add_blendSort",r.CullFaceMode.BACK,r.RenderBlendMode.ADD,r.DepthTestMode.TRANSPARENT_SORT),t.BACK_ADD_ALWAYS_STATE=e.Create("back_add_always",r.CullFaceMode.BACK,r.RenderBlendMode.ADD,r.DepthTestMode.ALWAYS),t.BACK_ALPHA_ADD_ALWAYS_STATE=e.Create("back_alpha_add_always",r.CullFaceMode.BACK,r.RenderBlendMode.ALPHA_ADD,r.DepthTestMode.ALWAYS),t.NONE_ADD_ALWAYS_STATE=e.Create("none_add_always",r.CullFaceMode.NONE,r.RenderBlendMode.ADD,r.DepthTestMode.ALWAYS),t.NONE_ADD_BLENDSORT_STATE=e.Create("none_add_blendSort",r.CullFaceMode.NONE,r.RenderBlendMode.ADD,r.DepthTestMode.TRANSPARENT_SORT),t.NONE_ALPHA_ADD_ALWAYS_STATE=e.Create("none_alpha_add_always",r.CullFaceMode.NONE,r.RenderBlendMode.ALPHA_ADD,r.DepthTestMode.ALWAYS),t.FRONT_ADD_ALWAYS_STATE=e.Create("front_add_always",r.CullFaceMode.FRONT,r.RenderBlendMode.ADD,r.DepthTestMode.ALWAYS),t.FRONT_TRANSPARENT_STATE=e.Create("front_transparent",r.CullFaceMode.FRONT,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.TRANSPARENT_SORT),t.FRONT_TRANSPARENT_ALWAYS_STATE=e.Create("front_transparent_always",r.CullFaceMode.FRONT,r.RenderBlendMode.TRANSPARENT,r.DepthTestMode.ALWAYS),t.NONE_CULLFACE_NORMAL_ALWAYS_STATE=e.Create("none_normal_always",r.CullFaceMode.NONE,r.RenderBlendMode.NORMAL,r.DepthTestMode.ALWAYS),t.BACK_ALPHA_ADD_BLENDSORT_STATE=e.Create("back_alpha_add_blendSort",r.CullFaceMode.BACK,r.RenderBlendMode.ALPHA_ADD,r.DepthTestMode.TRANSPARENT_SORT)}}static CreateBlendMode(t,e,i,r=0){return s.RenderStateObject.CreateBlendMode(t,e,i,r)}static CreateBlendModeSeparate(t,e,i,r=0,a=0,h=0){return s.RenderStateObject.CreateBlendModeSeparate(t,e,i,r,a,h)}static CreateRenderState(t,e,i,r){return s.RenderStateObject.Create(t,e,i,r)}static CreateRenderColorMask(t,e,i,r,a){return s.RenderColorMask.Create(t,e,i,r,a)}static GetRenderStateByName(t){return s.RenderStateObject.GetRenderStateByName(t)}static GetRenderColorMaskByName(t){return s.RenderColorMask.GetColorMaskByName(t)}static UnlockBlendMode(){s.RenderStateObject.UnlockBlendMode()}static LockBlendMode(t){s.RenderStateObject.LockBlendMode(t)}static UnlockDepthTestMode(){s.RenderStateObject.UnlockDepthTestMode()}static LockDepthTestMode(t){s.RenderStateObject.LockDepthTestMode(t)}static ResetState(){s.RenderColorMask.Reset(),s.RenderStateObject.Reset(),a.Rstate.reset()}static Reset(t){s.RenderColorMask.Reset(),s.RenderStateObject.Reset(),a.Rstate.setRenderContext(t),a.Rstate.reset()}static ResetInfo(){a.DrawCallTimes=0,a.DrawTrisNumber=0,a.POVNumber=0}static SetDepthTestEnable(t){a.Rstate.setDepthTestEnable(t)}static SetBlendEnable(t){a.Rstate.setBlendEnable(t)}static SetStencilFunc(t,e,i){a.Rstate.setStencilFunc(t,e,i)}static SetStencilMask(t){a.Rstate.setStencilMask(t)}static SetStencilOp(t,e,i){a.Rstate.setStencilOp(t,e,i)}}a.B_Q=!0,a.Rstate=null,a.DrawCallTimes=0,a.DrawTrisNumber=0,a.POVNumber=0,a.COLOR_MASK_ALL_TRUE=0,a.COLOR_MASK_ALL_FALSE=1,a.COLOR_MASK_RED_TRUE=2,a.COLOR_MASK_GREEN_TRUE=3,a.COLOR_MASK_BLUE_TRUE=4,a.COLOR_MASK_ALPHA_TRUE=5,a.COLOR_MASK_RED_FALSE=6,a.COLOR_MASK_GREEN_FALSE=7,a.COLOR_MASK_BLUE_FALSE=8,a.COLOR_MASK_ALPHA_FALSE=9,a.NORMAL_STATE=0,a.BACK_CULLFACE_NORMAL_STATE=0,a.FRONT_CULLFACE_NORMAL_STATE=1,a.NONE_CULLFACE_NORMAL_STATE=2,a.ALL_CULLFACE_NORMAL_STATE=3,a.BACK_NORMAL_ALWAYS_STATE=4,a.BACK_TRANSPARENT_STATE=5,a.BACK_TRANSPARENT_ALWAYS_STATE=6,a.NONE_TRANSPARENT_STATE=7,a.NONE_TRANSPARENT_ALWAYS_STATE=8,a.FRONT_CULLFACE_GREATER_STATE=9,a.BACK_ADD_BLENDSORT_STATE=10,a.BACK_ADD_ALWAYS_STATE=11,a.BACK_ALPHA_ADD_ALWAYS_STATE=12,a.NONE_ADD_ALWAYS_STATE=13,a.NONE_ADD_BLENDSORT_STATE=14,a.NONE_ALPHA_ADD_ALWAYS_STATE=15,a.FRONT_ADD_ALWAYS_STATE=16,a.FRONT_TRANSPARENT_STATE=17,a.FRONT_TRANSPARENT_ALWAYS_STATE=18,a.NONE_CULLFACE_NORMAL_ALWAYS_STATE=19,a.BACK_ALPHA_ADD_BLENDSORT_STATE=20,e.default=a},"2be1":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.v_=0,this.u_=[],this.z_=[],this.AA=[]}createNode(){return null}restoreUid(t){}getFreeId(){return this.AA.length>0?this.AA.pop():-1}getNodeByUid(t){return this.u_[t]}create(){let t=null,e=this.getFreeId();return e>=0?(t=this.u_[e],t.uid=e,this.z_[e]=s.S_BUSY):(t=this.createNode(),this.u_.push(t),this.z_.push(s.S_BUSY),t.uid=this.v_,this.v_++),t}restore(t){return null!=t&&t.uid>=0&&this.z_[t.uid]==s.S_BUSY&&(this.restoreUid(t.uid),this.AA.push(t.uid),this.z_[t.uid]=s.S_FREE,t.reset(),!0)}restoreByUid(t){return t>=0&&t<this.v_&&this.z_[t]==s.S_BUSY&&(this.restoreUid(t),this.AA.push(t),this.z_[t]=s.S_FREE,this.u_[t].reset(),!0)}}s.S_BUSY=1,s.S_FREE=0,e.default=s},3024:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3077"));class a extends r.default{constructor(t){super(),this.AB=null,this.AC=1,t<1&&(t=1),this.AC=t,this.AB=new Float32Array(4*t)}bindSlotAt(t){super.bindSlotAt(t),this.addVec4Data(this.AB,this.AC)}destroy(){super.destroy(),this.AB=null}}e.default=a},3077:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("644c")),a=s(i("5326"));class h{constructor(){this.A=h.B_O++,this.AD=null,this.AE=null,this.AF=0,this.AG=-1,this.rst=-1,this.uniformsTotal=0,this.uniformTypes=null,this.dataSizeList=null}getUid(){return this.A}getSlotBeginIndex(){return this.AG}getSlotUid(){return this.AD.getUid()}getFS32At(t){return this.AE[t]}setFS32At(t,e){this.AE[e]=t}setVec4DataAt(t,e,i,s,r){let a=this.AE[t];a[0]=e,a[1]=i,a[2]=s,a[3]=r}setVec4Data(t,e,i,s){let r=this.AE[0];r[0]=t,r[1]=e,r[2]=i,r[3]=s}setVec4DataAtWithArr4(t,e){this.AE[t].set(e,0)}setVec4DataWithArr4(t){this.AE[0].set(t,0)}addVec4Data(t,e){t.length,this.AE.push(t),this.uniformTypes.push(r.default.SHADER_VEC4),this.dataSizeList.push(e),this.AD.dataList[this.AF]=t,this.AF++,this.uniformsTotal++,this.AD.index++}addMat4Data(t,e){this.AE.push(t),this.uniformTypes.push(r.default.SHADER_MAT4),this.dataSizeList.push(e),this.AD.dataList[this.AF]=t,this.AF++,this.uniformsTotal++,this.AD.index++}isEnabled(){return this.rst>=0}bindSlotAt(t){let e=a.default.GetSlotAt(t);this.rst>=0&&this.reset(),null==this.AE&&(this.AE=[],this.uniformTypes=[],this.dataSizeList=[]),this.AD=e,this.rst=1,this.AG=e.index,this.AF=e.index}update(){if(this.rst++,this.uniformsTotal<2)this.AD.flagList[this.AG]=this.rst;else for(let t=this.AG;t<=this.AF;++t)this.AD.flagList[t]=this.rst}reset(){this.rst=-1,this.AG=-1,this.uniformsTotal=0,this.AF=0,null!=this.AE&&(this.AE=null,this.uniformTypes=null,this.dataSizeList=null),this.AD=null}destroy(){this.reset()}}h.B_O=0,e.default=h},"36cb":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i("e08e"),a=s(i("ab73")),h=i("b02c"),n=s(i("4f27")),_=s(i("b30a")),l=s(i("9156")),o=i("9b81");class m{constructor(){this.AH=null,this.w_=null,this.K_=null,this.M_=null,this.AI=null,this.U_=null,this.AJ=null,this.AK=null,this.AL=[],this.AM=[],this.AN=[],this.AO=!1}initialize(t,e,i,s){null==this.w_&&(this.U_=t,this.AJ=t.Vertex,this.AK=t.Texture,this.w_=new _.default(t.getRCUid(),t.getRC(),t.getRenderAdapter()),this.K_=e,this.M_=i,this.AI=s,this.AH=new h.EmptyTexRenderObj(this.AK))}getRenderProxy(){return this.U_}getRenderShader(){return this.w_}getTextureResource(){return this.AK}updateTextureData(t,e){this.AK.hasResUid(t.getResUid())&&(e?(this.AN.push(t),this.AO=!0):t.__$updateToGpu(this.AK))}updateDispTRO(t,e){t.__$ruid>-1&&(e?(this.AM.push(t),this.AO=!0):this.updateTextureTRO(t))}createTRO(t,e){if(null!=t){for(let e=0;e<t.length;++e)null!=t[e]&&t[e].__$setRenderProxy(this.U_);return h.TextureRenderObj.Create(this.AK,t,e)}return null}updateTextureTRO(t){if(null!=t.__$$runit){let e=t.getMaterial();if(null!=e){let i=this.AK,s=t.__$$runit,r=h.TextureRenderObj.GetByMid(i.getRCUid(),e.__$troMid);if(null!=s.tro&&(null==r||s.tro.getMid()!=r.getMid())){let t=this.w_.findShdProgramByShdData(e.getShaderData());null!=t&&(t.getTexTotal()>0?(null==r&&(r=this.createTRO(e.getTextureList(),t.getTexTotal())),s.tro!=r&&(null!=s.tro&&s.tro.__$detachThis(),s.tro=r,r.__$attachThis(),s.texMid=s.tro.getMid(),this.M_.rejoinRunitForTro(s),e.__$troMid=s.tro.getMid())):s.tro!=this.AH&&(null!=s.tro&&s.tro.__$detachThis(),s.tro=this.AH,s.texMid=s.tro.getMid(),this.M_.rejoinRunitForTro(s),e.__$troMid=s.texMid))}}}}updateDispMaterial(t,e){let i=null;if(e.__$ruid>=0){let s=this.U_,r=e.getMaterial();if(null!=r){if(null==r.getShaderData()){let t=r.getTextureList(),e=null!=t&&null!=t&&t.length>0;r.initializeByCodeBuf(e)}i=this.w_.create(r.getShaderData()),i.upload(s.RContext,s.getUid()),t.shdUid=i.getUid();let h=null;if(i.getTexTotal()>0?(h=this.createTRO(r.getTextureList(),i.getTexTotal()),t.tro!=h&&(null!=t.tro&&t.tro.__$detachThis(),t.tro=h,h.__$attachThis(),t.texMid=t.tro.getMid(),t.__$rprouid>=0&&this.M_.rejoinRunitForTro(t),r.__$troMid=t.tro.getMid())):t.tro!=this.AH&&(null!=t.tro&&t.tro.__$detachThis(),t.tro=this.AH,t.texMid=t.tro.getMid(),t.__$rprouid>=0&&this.M_.rejoinRunitForTro(t),r.__$troMid=t.texMid),null==this.w_.getSharedUniformByShd(i)){let t=this.createsharedMList(r,i);if(null!=t)for(let e=0;e<t.length;++e)t[e].program=i.getGPUProgram();this.w_.setSharedUniformByShd(i,n.default.BuildShared(t,s,i))}let _=i.hasUniformByName(a.default.LocalTransformMatUNS);null==r.__$uniform&&(r.__$uniform=n.default.BuildLocalFromData(r.createSelfUniformData(),i)),_&&null!=e.getTransform()&&(t.transUniform=l.default.GetTransUniform(e.getTransform())),null==t.transUniform?(t.transUniform=n.default.BuildLocalFromTransformV(_?e.getMatrixFS32():null,i),l.default.SetTransUniform(e.getTransform(),t.transUniform)):t.transUniform=n.default.UpdateLocalFromTransformV(t.transUniform,_?e.getMatrixFS32():null,i),t.uniform=r.__$uniform}}return i}updateVtxDataToGpuByUid(t,e){this.AJ.updateDataToGpu(t,e)}updateDispVbuf(t,e){if(t.__$ruid>-1)if(e)this.AL.push(t),this.AO=!0;else{let e=t.__$$runit;if(null!=e&&e.vtxUid!=t.vbuf.getUid()){let i=e.vtxUid,s=this.AJ;s.hasResUid(i)&&s.__$detachRes(i),e.vro.__$detachThis(),this.buildVtxRes(t,e,this.w_.findShdProgramByUid(e.shdUid)),e.__$rprouid>=0&&this.M_.rejoinRunitForVro(e)}}}buildVtxRes(t,e,i){if(null!=t.vbuf){let s=this.AJ;e.ivsIndex=t.ivsIndex,e.ivsCount=t.ivsCount,e.insCount=t.insCount,e.visible=t.visible,e.setVisible(t.visible),e.drawMode=t.drawMode,e.renderState=t.renderState,e.rcolorMask=t.rcolorMask,e.trisNumber=t.trisNumber;let r,a=t.vbuf.getUid(),h=!0;s.hasResUid(a)?(r=s.getVertexRes(a),h=r.version!=t.vbuf.version,h&&(s.destroyRes(a),r.rcuid=s.getRCUid(),r.resUid=a)):(r=new o.GpuVtxObect,r.rcuid=s.getRCUid(),r.resUid=a,s.addVertexRes(r)),h&&(r.indices.ibufStep=t.vbuf.getIBufStep(),r.indices.initialize(this.AI,t.vbuf),r.vertex.initialize(this.AI,i,t.vbuf),r.version=t.vbuf.version),s.__$attachRes(a),e.vro=r.createVRO(this.AI,i,!0),e.indicesRes=e.vro.indicesRes,e.vro.__$attachThis(),e.vtxUid=t.vbuf.getUid(),e.ibufStep=e.vro.ibufStep,e.ibufType=4!=e.ibufStep?this.U_.UNSIGNED_SHORT:this.U_.UNSIGNED_INT}}buildGpuDisp(t){if(t.__$ruid<0&&null!=t.getMaterial()){t.__$$rsign=r.DisplayRenderSign.LIVE_IN_RENDERER;let e=this.K_.create();if(t.__$ruid=e.uid,t.__$$runit=e,null!=t.getPartGroup()){e.partGroup=t.getPartGroup().slice(0),e.partTotal=e.partGroup.length;let i=e.partGroup;for(let t=0,s=e.partTotal;t<s;)t++,i[t++]*=e.ibufStep}return e.setDrawFlag(t.renderState,t.rcolorMask),this.buildVtxRes(t,e,this.updateDispMaterial(e,t)),!0}return!1}update(){if(this.AO){this.AO=!1;let t=this.AL.length,e=0;if(t>0){for(;e<t;++e)this.updateDispVbuf(this.AL[e],!1);this.AL=[]}if(t=this.AM.length,t>0){for(e=0;e<t;++e)this.updateTextureTRO(this.AM[e]);this.AM=[]}if(t=this.AN.length,t>0){for(e=0;e<t;++e)this.AN[e].__$updateToGpu(this.AK);this.AN=[]}}}createsharedMList(t,e){let i=t.createSharedUniforms();if(null==i){let s=t.createSharedUniformsData();if(null!=s&&s.length>0){i=[];for(let t=0;t<s.length;++t)if(null!=s[t]){let r=n.default.BuildLocalFromData(s[t],e);i.push(r)}i.length<1&&(i=null)}}return i}updateGlobalMaterial(t,e=!1){if(null!=t){let i=this.U_,s=null,r=null,a=null,h=!1;null==t.getShaderData()?(a=t.getTextureList(),h=null!=a&&a.length>0,t.initializeByCodeBuf(h)):a=t.getTextureList(),r=this.w_.create(t.getShaderData()),r.upload(i.RContext,i.getUid());let _=r.getTexTotal();if(_>0&&(s=this.createTRO(a,_)),null==this.w_.getSharedUniformByShd(r)){let e=this.createsharedMList(t,r);if(null!=e)for(let t=0;t<e.length;++t)e[t].program=r.getGPUProgram();this.w_.setSharedUniformByShd(r,n.default.BuildShared(e,i,r))}null==t.__$uniform&&(t.__$uniform=n.default.BuildLocalFromData(t.createSelfUniformData(),r)),this.w_.__$globalUniform=t.__$uniform,this.w_.bindToGpu(r.getUid()),e&&null!=t.__$uniform&&this.w_.useUniform(t.__$uniform),null!=s&&s.run()}}reset(){this.AL=[],this.AM=[]}}e.default=m},3787:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("8e17")),a=s(i("fecb"));class h{constructor(t){this.AP=0,this.AQ=new r.default,this.AR=new r.default,this.AS=new r.default,this.AT=new r.default,this.AU=!0,this.AV=new r.default,this.AW=new r.default,this.AX=new r.default,this.AY=new r.default,this.AZ=new r.default,this.Aa=new a.default,this.Ab=1,this.Ac=1,this.L=0,this.M=0,this.Ad=800,this.Ae=600,this.Af=400,this.Ag=300,this.Ah=0,this.Ai=1,this.Aj=.1,this.Ak=1e3,this.Al=0,this.Am=0,this.An=0,this.Ao=0,this.Ap=!1,this.Aq=!1,this.Ar=!0,this.As=new r.default(0,0,0),this.At=new r.default(1,1,1),this.Au=1,this.Av=!0,this.Aw=!0,this.version=0,this.matUProbe=null,this.ufrustumProbe=null,this.ucameraPosProbe=null,this.uniformEnabled=!1,this.name="Camera",this.Ax=new r.default,this.Ay=new r.default,this.Az=new r.default,this.A0=new r.default,this.A1=new r.default,this.A2=0,this.A3=new r.default,this.A4=null,this.A5=!1,this.AP=t}lock(){this.Aw=!1}unlock(){this.Aw=!0}lookAtLH(t,e,i){this.Aw&&(this.AV.copyFrom(t),this.AW.copyFrom(e),this.AX.copyFrom(i),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AU=!1,this.AY.copyFrom(this.AZ),this.AY.normalize(),this.AT.copyFrom(i),this.AT.normalize(),r.default.Cross(this.AZ,this.AX,this.AS),this.AS.normalize(),this.Av=!0)}lookAtRH(t,e,i){this.Aw&&(this.AV.copyFrom(t),this.AW.copyFrom(e),this.AX.copyFrom(i),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AU=!0,this.AY.copyFrom(this.AZ),this.AY.normalize(),this.AT.copyFrom(i),this.AT.normalize(),r.default.Cross(this.AZ,this.AX,this.AS),this.AS.normalize(),this.Av=!0)}getLookAtLHToCamera(t){t.lookAtLH(this.AV,this.AW,this.AX)}getLookAtRHToCamera(t){t.lookAtRH(this.AV,this.AW,this.AX)}perspectiveLH(t,e,i,s){}perspectiveRH(t,e,i,s){}perspectiveRH2(t,e,i,s,r){}getAspect(){return this.Ai}getViewFieldZoom(){return this.Au}orthoRH(t,e,i,s,r,a){}orthoLH(t,e,i,s,r,a){}isPerspectiveEnabled(){return this.Ap}isRightHandEnabled(){return this.Ar}setViewXY(t,e){this.Aw&&(this.L=t,this.M=e)}setViewSize(t,e){this.Aw&&(t==this.Ad&&e==this.Ae||(this.Ad=t,this.Ae=e,this.Af=.5*t,this.Ag=.5*e,this.Ap?this.Aq?this.Ar&&this.perspectiveRH2(this.Ah,t,e,this.Aj,this.Ak):this.Ar?this.perspectiveRH(this.Ah,t/e,this.Aj,this.Ak):this.perspectiveLH(this.Ah,t/e,this.Aj,this.Ak):this.orthoRH(this.Aj,this.Ak,-.5*e,.5*e,-.5*t,.5*t)))}getViewX(){return this.L}getViewY(){return this.M}getViewWidth(){return this.Ad}getViewHeight(){return this.Ae}translation(t){this.Aw&&(this.AV.copyFrom(t),this.AW.x=t.x+this.AZ.x,this.AW.y=t.y+this.AZ.y,this.AW.z=t.z+this.AZ.z,this.Av=!0)}translationXYZ(t,e,i){this.AQ.setXYZ(t,e,i),this.Aw&&r.default.DistanceSquared(this.AV,this.AQ)>.01&&(this.AV.setTo(t,e,i),this.AW.x=t+this.AZ.x,this.AW.y=e+this.AZ.y,this.AW.z=i+this.AZ.z,this.Av=!0)}forward(t){this.Aw&&(this.AV.x+=this.AY.x*t,this.AV.y+=this.AY.y*t,this.AV.z+=this.AY.z*t,this.AW.x=this.AV.x+this.AZ.x,this.AW.y=this.AV.y+this.AZ.y,this.AW.z=this.AV.z+this.AZ.z,this.Av=!0)}forwardFixPos(t,e){this.Aw&&(this.AV.x=e.x+this.AY.x*t,this.AV.y=e.y+this.AY.y*t,this.AV.z=e.z+this.AY.z*t,this.AW.x=this.AV.x+this.AZ.x,this.AW.y=this.AV.y+this.AZ.y,this.AW.z=this.AV.z+this.AZ.z,this.Av=!0)}setPosition(t){if(this.Aw){r.default.Cross(this.AZ,this.AX,this.AQ);var e=this.AQ.dot(this.AT);this.AR.copyFrom(this.AT),this.AR.scaleBy(e),this.AQ.subtractBy(this.AR),this.AV.copyFrom(t),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AY.copyFrom(this.AZ),this.AY.normalize(),r.default.Cross(this.AQ,this.AZ,this.AX),this.AX.normalize(),this.Av=!0}}setPositionXYZ(t,e,i){if(this.Aw){r.default.Cross(this.AZ,this.AX,this.AQ);var s=this.AQ.dot(this.AT);this.AR.copyFrom(this.AT),this.AR.scaleBy(s),this.AQ.subtractBy(this.AR),this.AV.setTo(t,e,i),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AY.copyFrom(this.AZ),this.AY.normalize(),r.default.Cross(this.AQ,this.AZ,this.AX),this.AX.normalize(),this.Av=!0}}setLookPosXYZFixUp(t,e,i){this.Aw&&(this.AW.setTo(t,e,i),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AU=!0,this.AY.copyFrom(this.AZ),this.AY.normalize(),r.default.Cross(this.AZ,this.AX,this.AS),this.AS.normalize(),this.Av=!0)}setPositionXYZFixUp(t,e,i){this.Aw&&(this.AV.setTo(t,e,i),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AU=!0,this.AY.copyFrom(this.AZ),this.AY.normalize(),r.default.Cross(this.AZ,this.AX,this.AS),this.AS.normalize(),this.Av=!0)}setPositionFixUp(t){this.Aw&&(this.AV.copyFrom(t),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AU=!0,this.AY.copyFrom(this.AZ),this.AY.normalize(),r.default.Cross(this.AZ,this.AX,this.AS),this.AS.normalize(),this.Av=!0)}copyFrom(t){}getNV(){return this.Ax.copyFrom(this.AY),this.Ax}getUV(){return this.Ay.copyFrom(this.AX),this.Ay}getRV(){return this.Az.copyFrom(this.AS),this.Az}getPosition(){return this.A0.copyFrom(this.AV),this.A0}getLookAtPosition(){return this.A1.copyFrom(this.AW),this.A1}setLookAtPosition(t,e,i){this.Aw&&(this.AW.setTo(t,e,i),this.AZ.x=this.AW.x-this.AV.x,this.AZ.y=this.AW.y-this.AV.y,this.AZ.z=this.AW.z-this.AV.z,this.AY.copyFrom(this.AZ),this.AY.normalize(),this.Av=!0)}getPerspectiveEnabled(){return this.Ap}setPerspectiveEnabled(t){this.Ap=t}appendRotationByAxis(t,e,i=null){this.Aw&&(this.A2=t,this.Av=!0,this.A3.copyFrom(e),this.A4=i,this.A5=!0)}setRotationX(t){this.As.x=t,this.Av=!0,this.A5=!1}getRotationX(){return this.As.x}setRotationY(t){this.As.y=t,this.Av=!0,this.A5=!1}getRotationY(){return this.As.y}setRotationZ(t){this.As.z=t,this.Av=!0,this.A5=!1}getRotationZ(){return this.As.z}setRotationXYZ(t,e,i){this.Aw&&(this.As.setXYZ(t,e,i),this.Av=!0,this.A5=!1)}setScaleX(t){this.At.x=t,this.Av=!0,this.A5=!1}getScaleX(){return this.At.x}setScaleY(t){this.At.y=t,this.Av=!0,this.A5=!1}getScaleY(){return this.At.y}setScaleZ(t){this.At.z=t,this.Av=!0,this.A5=!1}getScaleZ(){return this.At.z}setScaleXYZ(t,e,i){this.Aw&&(this.At.setXYZ(t,e,i),this.Av=!0,this.A5=!1)}screenXYToViewXYZ(t,e,i){t-=this.L,e-=this.M,this.Ap&&(t=this.Ab*(t-this.Af)/this.Af,e=this.Ac*(this.Ag-e)/this.Ag),i.setTo(t,e,-this.Aj)}screenXYToWorldXYZ(t,e,i){t-=this.L,e-=this.M,this.Ap&&(t=.5*this.Ab*(t-this.Af)/this.Af,e=.5*this.Ac*(this.Ag-e)/this.Ag),i.setTo(t,e,-this.Aj),i.w=1}getWorldPickingRayByScreenXY(t,e,i,s){}calcScreenNormalizeXYByWorldPos(t,e){}worldPosToScreen(t){}calcViewRectByWorldSphere(t,e,i){}calcScreenRectByWorldSphere(t,e,i){}getZNear(){return this.Aj}setZNear(t){this.Aj=t}getZFar(){return this.Ak}setZFar(t){this.Ak=t}getNearPlaneWidth(){return this.Ab}setNearPlaneWidth(t){this.Ab=t}getNearPlaneHeight(){return this.Ac}setNearPlaneHeight(t){this.Ac=t}getFov(){return this.Ah}getWordFrustumWAABB(){return this.Aa}getWordFrustumWAABBCenter(){return this.Aa.center}visiTestSphere2(t,e){return!0}visiTestSphere3(t,e,i){return!0}visiTestPosition(t){return!0}visiTestPlane(t,e){return!1}visiTestSphere(t,e){return!0}visiTestAABB(t){return!0}update(){}updateCamMatToUProbe(t){}destroy(){}lookRHEnabled(){return this.AU}lookLHEnabled(){return!this.AU}}e.Camera=h},3930:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("6e01"));class a{constructor(t=1,e=1,i=1,s=1){this.r=1,this.g=1,this.b=1,this.a=1,this.r=t,this.g=e,this.b=i,this.a=s}setRGB3Bytes(t,e,i){this.r=t/255,this.g=e/255,this.b=i/255}setRGB3f(t,e,i){this.r=t,this.g=e,this.b=i}setRGBUint24(t){this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255}setRGBA4f(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}copyFrom(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}copyFromRGB(t){this.r=t.r,this.g=t.g,this.b=t.b}scaleBy(t){this.r*=t,this.g*=t,this.b*=t}inverseRGB(){this.r=1-this.r,this.g=1-this.g,this.b=1-this.b}randomRGB(t=1){this.r=Math.random()*t,this.g=Math.random()*t,this.b=Math.random()*t}normalizeRandom(t=1){this.r=Math.random(),this.g=Math.random(),this.b=Math.random();let e=Math.sqrt(this.r*this.r+this.g*this.g+this.b*this.b);e>r.default.MATH_MIN_POSITIVE&&(this.r=t*this.r/e,this.g=t*this.g/e,this.b=t*this.b/e)}normalize(t){void 0==t&&(t=1);let e=Math.sqrt(this.r*this.r+this.g*this.g+this.b*this.b);e>r.default.MATH_MIN_POSITIVE&&(this.r=t*this.r/e,this.g=t*this.g/e,this.b=t*this.b/e)}getCSSDecRGBAColor(){let t=Math.floor(255*this.r),e=Math.floor(255*this.g),i=Math.floor(255*this.b),s=this.a;return"rgba("+t+","+e+","+i+","+s+")"}getCSSHeXRGBColor(){let t="#",e=Math.floor(255*this.r);return t+=e<15?"0"+e.toString(16):""+e.toString(16),e=Math.floor(255*this.g),t+=e<15?"0"+e.toString(16):""+e.toString(16),e=Math.floor(255*this.b),t+=e<15?"0"+e.toString(16):""+e.toString(16),t}toString(){return"[Color4(r="+this.r+", g="+this.g+",b="+this.b+",a="+this.a+")]"}}e.default=a},"3b73":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static SetWebBodyColor(t="white"){const e=document.body;e.style.background=t}static SetLanguage(t){s.B_R=t}static GetLanguage(){return""!=s.B_R||(s.B_R=navigator.language),s.B_R}static SetThreadEnabled(t){s.B_S=t}static GetThreadEnabled(){return s.B_S}static GetDebugEnabled(){return s.B_T}static SetDebugEnabled(t){s.B_T=t}static SetDevicePixelRatio(t){s.B_U=t}static GetDevicePixelRatio(){return s.B_U}static Initialize(t){s.B_V&&(s.B_V=!1,s.B_W=t[0],s.TestMobileWeb(),s.B_R=navigator.language+"")}static IsWindowsPCOS(){return!(s.IsSafariWeb()||s.IsMobileWeb())}static IsWinExternalVideoCard(){if(s.B_X>0)return 2==s.B_X;let t=s.IsSafariWeb()||s.IsMobileWeb();return t||(t=s.GPU_RENDERER.indexOf("Intel(R)")<0),s.B_X=t?2:1,2==s.B_X}static TestSafariWeb(){return/Safari/.test(navigator.userAgent)&&/Mac OS/.test(navigator.userAgent)}static IsWebGL1(){return 1==s.B_W}static IsWebGL2(){return 2==s.B_W}static IsMobileWeb(){return s.B_c>0?2==s.B_c:s.TestMobileWeb()}static IsSafariWeb(){return s.B_Y>0||(s.B_Y=s.TestSafariWeb()?2:1),2==s.B_Y}static IsIOS(){if(s.B_Z>0)return 2==s.B_Z;let t=!1;return t=!!/iPad|iPhone|iPod/.test(navigator.platform)||void 0!=navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),s.B_Z=t?2:1,t}static IsIpadOS(){if(s.B_a>0)return 2==s.B_a;let t=navigator.maxTouchPoints>0&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform);return!t&&/iPod|iPad|iPadPro|iPodPro/i.test(navigator.userAgent)&&(t=!0),s.B_a=t?2:1,t}static IsAndroidOS(){if(s.B_b>0)return 2==s.B_b;let t=s.TestMobileWeb();return t=!(!t||!/Android|Linux/i.test(navigator.userAgent)),s.B_b=t?2:1,t}static TestMobileWeb(){return s.B_c>0?2==s.B_c:/mobile/.test(location.href)?(s.B_c=2,2==s.B_c):/Android/i.test(navigator.userAgent)?/Mobile/i.test(navigator.userAgent)?(s.B_c=2,2==s.B_c):(s.B_c=1,2==s.B_c):/webOS|iPhone|iPod|iPad|iPodPro|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(s.B_c=2,2==s.B_c):(s.B_c=1,2==s.B_c)}}s.B_V=!0,s.B_W=2,s.B_U=1,s.B_c=0,s.B_Y=0,s.B_b=0,s.B_Z=0,s.B_a=0,s.B_X=0,s.B_R="",s.B_T=!0,s.GPU_VENDOR="unknown",s.GPU_RENDERER="unknown",s.MAX_TEXTURE_SIZE=4096,s.MAX_RENDERBUFFER_SIZE=4096,s.MAX_VIEWPORT_WIDTH=4096,s.MAX_VIEWPORT_HEIGHT=4096,s.SHOWLOG_ENABLED=!1,s.SHADERCODE_TRACE_ENABLED=!1,s.VERT_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED=!0,s.FRAG_SHADER_PRECISION_GLOBAL_HIGHP_ENABLED=!0,s.B_S=!0,e.default=s},"3c81":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("2be1")),a=s(i("7696"));class h extends r.default{setCreateParams(t,e,i,s,r,a){this.w_=t,this.A6=e,this.K_=i,this.A7=s,this.A8=r,this.A9=a}createNode(){return new a.default(this.w_,this.A6,this.K_,this.A7,this.A8,this.A9)}rejoinRunitForTro(t){this.getNodeByUid(t.__$rprouid).rejoinRunitForTro(t)}rejoinRunitForVro(t){this.getNodeByUid(t.__$rprouid).rejoinRunitForVro(t)}}e.default=h},"442e":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("2be1")),a=s(i("265e"));class h extends r.default{createNode(){return new a.default}}e.default=h},"45db":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("8def")),a=s(i("fa60"));class h{constructor(){this.A_A=null,this.A_B=-1,this.A_C=[],this.A_D=0,this.A_E=0,this.A_F=0,this.A_G=0,this.A_H=null,this.A_I=null,this.A_J=null,this.A_K=[],this.A_L=0}updateToGpu(t){let e=this.A_C.length;if(e>0){let i=this.A_A;if(this.version!=i.vertexVer){let s,r=i.getBufDataUsage(),a=this.A_J;for(let h=0;h<e;++h)s=i.getF32DataAt(h),a[h]>=s.length?(t.bindArrBuf(this.A_C[h]),t.arrBufSubData(s,0)):(t.bindArrBuf(this.A_C[h]),t.arrBufData(s,r),a[h]=s.length);this.version=i.vertexVer}}}uploadCombined(t,e){let i=this.A_A,s=i.getF32DataAt(0);if(this.A_C.push(t.createBuf()),t.bindArrBuf(this.A_C[0]),t.arrBufData(s,i.getBufDataUsage()),this.A_D=1,this.A_J=[s.length],null==this.A_H){this.A_G=0,this.A_H=new Array(this.A_F),this.A_I=new Array(this.A_F);for(let t=0;t<this.A_F;++t)this.A_I[t]=this.A_G,this.A_G+=4*e.getLocationSizeByIndex(t),this.A_H[t]=e.getLocationTypeByIndex(t)}}uploadSeparated(t,e){let i=this.A_A,s=0,r=null,a=i.getBufDataUsage();if(this.A_D=this.A_A.getBuffersTotal(),this.A_J=new Array(this.A_F),null==i.bufData)for(;s<this.A_F;++s)r=t.createBuf(),this.A_C.push(r),t.bindArrBuf(r),t.arrBufData(i.getF32DataAt(s),a),this.A_J[s]=i.getF32DataAt(s).length;else{let e=null,h=0,n=0,_=0,l=0;for(;s<this.A_F;++s){for(r=t.createBuf(),this.A_C.push(r),t.bindArrBuf(r),t.arrBufDataMem(i.bufData.getAttributeDataTotalBytesAt(s),a),_=0,l=0,n=i.bufData.getAttributeDataTotalAt(s),h=0;h<n;++h)e=i.bufData.getAttributeDataAt(s,h),l+=e.length,t.arrBufSubData(e,_),_+=e.byteLength;this.A_J[s]=l}}if(null==this.A_H){this.A_H=new Array(this.A_F),this.A_I=new Array(this.A_F);for(let t=0;t<this.A_F;++t)this.A_I[t]=this.A_G,this.A_G+=4*e.getLocationSizeByIndex(t),this.A_H[t]=e.getLocationTypeByIndex(t);this.A_G=0}}initialize(t,e,i){this.A_C.length<1&&null!=i&&(this.version=i.vertexVer,this.A_A=i,this.A_B=i.getUid(),this.A_E=i.getType(),this.A_F=e.getLocationsTotal(),this.A_E<1?this.uploadCombined(t,e):this.uploadSeparated(t,e))}getVROMid(t,e,i,s){let r=(131+t.getRCUid())*this.A_B;return i?(r=131*r+e.getMid(),r=131*r+3):r=131*r+e.getMid(),r=131*r+e.getLocationsTotal(),r=131*r+s,r}createVRO(t,e,i,s,h){let n=e.getLocationsTotal();if(this.A_F*n>0&&n<=this.A_F){let _=this.getVROMid(t,e,i,h),l=0,o=a.default.GetByMid(_);if(null!=o)return o;e.testVertexAttribPointerOffset(this.A_I);if(i){let i=a.default.Create(t,_,this.A_A.getUid());if(i.indicesRes=s,i.vao=t.createVertexArray(),t.bindVertexArray(i.vao),this.A_E<1)for(t.bindArrBuf(this.A_C[0]),l=0;l<n;++l)e.vertexAttribPointerTypeFloat(this.A_H[l],this.A_G,this.A_I[l]);else for(l=0;l<n;++l)t.bindArrBuf(this.A_C[l]),e.vertexAttribPointerTypeFloat(this.A_H[l],0,0);o=i,i.ibuf=s.getGpuBuf(),t.bindVertexArray(null)}else{let i=r.default.Create(t,_,this.A_A.getUid());for(i.indicesRes=s,i.shdp=e,i.attribTypes=[],i.wholeOffsetList=[],i.wholeStride=this.A_G,this.A_E<1?i.vbuf=this.A_C[0]:i.vbufs=this.A_C,l=0;l<n;++l)e.testVertexAttribPointerType(this.A_H[l])&&(i.attribTypes.push(this.A_H[l]),i.wholeOffsetList.push(0));i.attribTypesLen=i.attribTypes.length,i.ibuf=s.getGpuBuf(),o=i}return this.A_K.push(o),++this.A_L,o}return null}destroy(t){if(this.A_C.length>0){this.A_E=-1;let e=0,i=null;for(;e<this.A_L;++e)i=this.A_K.pop(),i.restoreThis(),this.A_K[e]=null;for(this.A_L=0,e=0;e<this.A_F;++e)t.deleteBuf(this.A_C[e]),this.A_C[e]=null;this.A_F=0,this.A_C=[]}}}e.ROVertexRes=h},"4f27":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3b73")),a=i("d53d"),h=s(i("2560")),n=s(i("83d1")),_=s(i("a7ed")),l=s(i("857b")),o=s(i("e87b"));class m extends a.ShaderUniform{use(t){}useByLocation(t,e,i,s){}useByShd(t,e){}updateData(){}destroy(){}}m.EmptyUniform=new m;class d{static appendUniformBuilder(t){d.B_d.has(t.getIDNS())||(d.B_e.push(t),d.B_d.set(t.getIDNS(),t),d.B_f=d.B_e.length)}static Initialize(){d.B_Q&&(d.B_Q=!1,d.appendUniformBuilder(new h.default),d.appendUniformBuilder(new _.default),d.appendUniformBuilder(new l.default),d.appendUniformBuilder(new n.default),d.appendUniformBuilder(new o.default))}static AddSharedUniformBuilder(t){null==t||d.B_d.has(t.getIDNS())||(d.B_e.push(t),d.B_d.set(t.getIDNS(),t),++d.B_f)}static removeSharedUniformBuilder(t){if(null!=t&&d.B_d.has(t.getIDNS())){for(let e=0;e<d.B_f;++e)if(t==d.B_e[e]){d.B_e.splice(e,1),--d.B_f;break}d.B_d.delete(t.getIDNS())}}static removeSharedUniformBuilderByName(t){if(d.B_d.has(t)){let e=d.B_d.get(t);for(let t=0;t<d.B_f;++t)if(e==d.B_e[t]){d.B_e.splice(t,1),--d.B_f;break}d.B_d.delete(t)}}static BuildShared(t,e,i){let s,r=null,a=null,h=d.B_e,n=0,_=d.B_f,l=null;for(;n<_;++n)l=h[n].create(e,i),null!=l&&(null!=a?a.next=l:null==r&&(r=l),a=l);if(null==t)s=r;else if(null!=r){for(let e=0;e<t.length;++e)a.next=t[e],a=a.next;s=r}if(null==s)s=m.EmptyUniform;else{let t=s,e=0;while(null!=t){if(null!=t.uniformNameList&&null==t.locations)for(t.types=[],t.locations=[],t.uniformSize=t.uniformNameList.length,e=0;e<t.uniformSize;++e)t.types.push(i.getUniformTypeByNS(t.uniformNameList[e])),t.locations.push(i.getUniformLocationByNS(t.uniformNameList[e]));t=t.next}}return s}static BuildLocalFromTransformV(t,e){if(null!=t){let i;return i=new a.ShaderMat4Uniform,i.uniformSize=0,i.uniformNameList=[],i.types=[],i.locations=[],i.dataList=[],i.dataSizeList=[],i.uniformSize+=1,i.uniformNameList.push("u_objMat"),i.types.push(e.getUniformTypeByNS("u_objMat")),i.locations.push(e.getUniformLocationByNS("u_objMat")),i.dataList.push(t),i.dataSizeList.push(1),i}return d.B_g}static UpdateLocalFromTransformV(t,e,i){if(null!=e){let s,r=t;return null==r?(r=new a.ShaderMat4Uniform,s=r,s.uniformSize=0,s.uniformNameList=[],s.types=[],s.locations=[],s.dataList=[],s.dataSizeList=[],s.uniformSize+=1,s.uniformNameList.push("u_objMat"),s.types.push(i.getUniformTypeByNS("u_objMat")),s.locations.push(i.getUniformLocationByNS("u_objMat")),s.dataList.push(e),s.dataSizeList.push(1)):(s=r,s.locations=[],s.locations.push(i.getUniformLocationByNS("u_objMat"))),s}return d.B_g}static BuildLocalFromData(t,e){if(null!=t){let i;i=r.default.IsWebGL1()?new a.ShaderUniformV1:new a.ShaderUniformV2,i.uns=t.uns,i.uniformNameList=[],i.types=[],i.locations=[],i.dataList=[],i.dataSizeList=[],i.uniformSize=0;let s=t,h=0;while(null!=s){if(null!=s.uniformNameList&&null==s.locations)for(i.uniformSize+=s.uniformNameList.length,h=0;h<i.uniformSize;++h)i.uniformNameList.push(s.uniformNameList[h]),i.types.push(e.getUniformTypeByNS(s.uniformNameList[h])),i.locations.push(e.getUniformLocationByNS(s.uniformNameList[h])),i.dataList.push(s.dataList[h]),i.dataSizeList.push(e.getUniformLengthByNS(s.uniformNameList[h]));s=s.next}return i}return m.EmptyUniform}static BuildLocal(t,e){let i=new a.ShaderUniform;i.uniformNameList=[],i.types=[],i.locations=[],i.dataList=[],i.dataSizeList=[],i.uniformSize=0;let s=t,r=0;while(null!=s){if(null!=s.uniformNameList&&null==s.locations)for(i.uniformSize+=s.uniformNameList.length,r=0;r<i.uniformSize;++r)i.uniformNameList.push(s.uniformNameList[r]),i.types.push(e.getUniformTypeByNS(s.uniformNameList[r])),i.locations.push(e.getUniformLocationByNS(s.uniformNameList[r])),i.dataList.push(s.dataList[r]),i.dataSizeList.push(e.getUniformLengthByNS(s.uniformNameList[r]));s=s.next}return i}}d.B_Q=!0,d.B_d=new Map,d.B_e=[],d.B_f=0,d.B_g=new a.ShaderUniform,e.default=d},5326:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t){this.A_M=256,this.A=0,this.index=0,this.dataList=[],this.flagList=null,this.A=t}getUid(){return this.A}static GetSlotAt(t){return s.B_h[t]}static Initialize(t){let e=s.B_h[t];if(null==e&&(e=new s(t),s.B_h[t]=e),null==e.flagList){e.flagList=new Uint16Array(e.A_M);for(let t=0;t<e.A_M;++t)e.dataList.push(null),e.flagList[t]=0}}}s.B_h=new Array(16),e.default=s},"56c5":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("030e"));class a{static SetRenderer(t){a.U_=t.getRC(),a.A_N=t.getWebGLVersion();let e=a;1==a.A_N&&null!=r.default.WEBGL_draw_buffers?e.COLOR_ATTACHMENT0=r.default.WEBGL_draw_buffers.COLOR_ATTACHMENT0_WEBGL:e.COLOR_ATTACHMENT0=a.U_.COLOR_ATTACHMENT0}static DrawBuffers(t){2==a.A_N?a.U_.drawBuffers(t):null!=r.default.WEBGL_draw_buffers&&r.default.WEBGL_draw_buffers.drawBuffersWEBGL(t)}}a.U_=null,a.A_N=2,a.COLOR_ATTACHMENT0=0,e.default=a},"5b1e":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i("3787"),a=s(i("d958"));class h{constructor(){this.A_O=null,this.o=null,this.A_P=0}initialize(){this.A_O=new a.default,this.A_O.initialize(null,new r.Camera(this.A_O.getRCUid())),this.o=this.A_O.getRendererContext()}run(){let t=Math.abs(Math.cos(this.A_P+=.01));this.o.setClearRGBColor3f(0,t,1-t),this.o.renderBegin(),this.A_O.run(),this.o.runEnd()}}e.DemoEmptyRenderer=h,e.default=h},"5f3c":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3b73")),a=s(i("df9d")),h=i("7c63");class n{constructor(t){this.A=-1,this.A_Q=new a.default,this.index=-1,this.shdUid=-1,this.procuid=-1,this.batchEnabled=!0,this.fixedState=!0,this.runMode=0,this.rpoNodeBuilder=null,this.rpoUnitBuilder=null,this.vtxResource=null,this.w_=null,this.w_=t,this.A=n.__s_uid++}showInfo(){this.A_Q.showInfo()}addNode(t){this.A_Q.addNodeAndSort(t)}rejoinNode(t){this.A_Q.containsNode(t)&&(this.A_Q.removeNodeAndSort(t),this.A_Q.addNodeAndSort(t))}removeNode(t){this.A_Q.removeNodeAndSort(t)}isEmpty(){return null==this.A_Q.getBegin()}run(t){switch(this.runMode){case 2:this.run2(t);break;case 1:this.run1(t);break;case 0:this.run0(t);break;default:break}}run0(t){let e=this.A_Q.getBegin();if(null!=e){this.w_.bindToGpu(this.shdUid),this.w_.resetUniform();let i=null;while(null!=e)e.drawEnabled&&(i=e.unit,i.drawEnabled&&(i.run(t),i.partTotal<1?i.drawThis(t):i.drawPart(t))),e=e.next}}run1(t){let e=this.A_Q.getBegin();if(null!=e){this.w_.bindToGpu(this.shdUid),this.w_.resetUniform();let i=null,s=this.A_Q.getVtxTotalAt(e.rvroI),r=this.A_Q.getTexTotalAt(e.rtroI),a=s>0,h=r>0;while(null!=e)s<1&&(s=this.A_Q.getVtxTotalAt(e.rvroI),a=!0),s--,r<1&&(r=this.A_Q.getTexTotalAt(e.rtroI),h=!0),r--,e.drawEnabled&&(i=e.unit,i.drawEnabled&&(a&&(e.vro.run(),a=!1),h&&(e.tro.run(),h=!1),i.run2(t),i.partTotal<1?i.drawThis(t):i.drawPart(t))),e=e.next}}run2(t){let e=this.A_Q.getBegin();if(null!=e){this.w_.bindToGpu(this.shdUid),this.w_.resetUniform();let i=null;h.RenderStateObject.UseRenderState(e.unit.renderState),h.RenderColorMask.UseRenderState(e.unit.rcolorMask);let s=this.A_Q.getVtxTotalAt(e.rvroI),r=this.A_Q.getTexTotalAt(e.rtroI),a=s>0,n=r>0;while(null!=e)s<0&&(s=this.A_Q.getVtxTotalAt(e.rvroI),a=!0),s--,r<0&&(r=this.A_Q.getTexTotalAt(e.rtroI),n=!0),r--,e.drawEnabled&&(i=e.unit,i.drawEnabled&&(a&&(e.vro.run(),a=!1),n&&(e.tro.run(),n=!1),null!=i.ubo&&i.ubo.run(t),this.w_.useTransUniform(i.transUniform),this.w_.useUniform(i.uniform),i.partTotal<1?i.drawThis(t):i.drawPart(t))),e=e.next}}runLockMaterial(t){let e=this.A_Q.getBegin();if(null!=e){this.w_.bindToGpu(this.shdUid),this.w_.resetUniform();let i=this.w_.isTextureUnLocked();t.Texture.unlocked=i;let s=null;if(this.batchEnabled){let r=this.A_Q.getVtxTotalAt(e.rvroI),a=r>0;while(null!=e)r<1&&(r=this.A_Q.getVtxTotalAt(e.rvroI),a=!0),r--,s=e.unit,e.drawEnabled&&s.drawEnabled&&(a&&(e.vro.run(),a=!1),i&&e.tro.run(),s.runLockMaterial2(null),s.partTotal<1?s.drawThis(t):s.drawPart(t)),e=e.next}else while(null!=e)s=e.unit,e.drawEnabled&&s.drawEnabled&&(s.runLockMaterial(),i&&e.tro.run(),s.partTotal<1?s.drawThis(t):s.drawPart(t)),e=e.next;t.Texture.unlocked=!1}}drawUnit(t,e,i){e.drawEnabled&&(this.w_.bindToGpu(e.shdUid),e.run(t),e.partTotal<1?e.drawThis(t):e.drawPart(t))}drawLockMaterialByUnit(t,e,i,s,a){if(e.drawEnabled){if(a&&this.w_.resetUniform(),r.default.IsMobileWeb()){let t=this.vtxResource.getVROByResUid(i.vbuf.getUid(),this.w_.getCurrentShd(),!0);t.run()}else e.vro.run();e.runLockMaterial2(s?this.w_.__$globalUniform:null),e.partTotal<1?e.drawThis(t):e.drawPart(t)}}reset(){let t=this.A_Q.getBegin(),e=null;if(null!=t){let i;while(null!=t)e=t,t=t.next,this.rpoUnitBuilder.setRPNodeParam(e.__$ruid,this.procuid,-1),e.reset(),i=e.unit,this.rpoNodeBuilder.restore(e)&&this.rpoUnitBuilder.restore(i)}this.index=-1,this.shdUid=-1,this.procuid=-1,this.A_Q.clear(),this.rpoNodeBuilder=null,this.rpoUnitBuilder=null,this.vtxResource=null}destroy(){this.reset()}getUid(){return this.A}toString(){return"[RPOBlock(uid = "+this.A+", index = "+this.index+", shdUid = "+this.shdUid+")]"}}n.__s_uid=0,e.default=n},"644c":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){}static GetTypeByTypeNS(t){switch(t){case"mat4":return s.SHADER_MAT4;case"mat3":return s.SHADER_MAT3;case"mat2":return s.SHADER_MAT2;case"float":return s.SHADER_FLOAT;case"int":return s.SHADER_INT;case"vec4":return s.SHADER_VEC4;case"vec3":return s.SHADER_VEC3;case"vec2":return s.SHADER_VEC2;case"vec4[]":return s.SHADER_VEC4FV;case"vec3[]":return s.SHADER_VEC3FV;case"vec2[]":return s.SHADER_VEC2FV;case"sampler2D":return s.SHADER_SAMPLER2D;case"sampler3D":return s.SHADER_SAMPLER3D;case"samplerCube":return s.SHADER_SAMPLERCUBE;default:break}return s.SHADER_UNDEFINED}static GetTypeNSByType(t){switch(t){case s.SHADER_MAT4:return"mat4";case s.SHADER_MAT3:return"mat3";case s.SHADER_MAT2:return"mat2";case s.SHADER_FLOAT:return"float";case s.SHADER_VEC4:return"vec4";case s.SHADER_VEC3:return"vec3";case s.SHADER_VEC2:return"vec2";case s.SHADER_SAMPLER2D:return"sampler2D";case s.SHADER_SAMPLER3D:return"sampler3D";case s.SHADER_SAMPLERCUBE:return"samplerCube";case s.SHADER_UNDEFINED:return"undefined";default:break}return""}}s.ATTRINS_VTX_VS="a_vs",s.ATTRINS_VTX_UVS="a_uvs",s.ATTRINS_VTX_NVS="a_nvs",s.ATTRINS_VTX_CVS="a_cvs",s.UNIFORMNS_OBJ_MAT_NS="u_objMat",s.UNIFORMNS_VIEW_MAT_NS="u_viewMat",s.UNIFORMNS_PROJ_MAT_NS="u_projMat",s.SHADER_UNDEFINED=3010,s.SHADER_VEC2=3011,s.SHADER_VEC3=3012,s.SHADER_VEC4=3013,s.SHADER_VEC2FV=3014,s.SHADER_VEC3FV=3015,s.SHADER_VEC4FV=3016,s.SHADER_MAT2=3017,s.SHADER_MAT3=3018,s.SHADER_MAT4=3019,s.SHADER_FLOAT=3020,s.SHADER_INT=3021,s.SHADER_MAT2FV=3022,s.SHADER_MAT3FV=3023,s.SHADER_MAT4FV=3024,s.SHADER_SAMPLER2D=3031,s.SHADER_SAMPLERCUBE=3032,s.SHADER_SAMPLER3D=3033,s.SHADER_PRECISION_LOWP=3101,s.SHADER_PRECISION_MEDIUMP=3111,s.SHADER_PRECISION_HIGHP=3121,s.UNIFORM_TEX_SAMPLER2D="sampler2D",s.UNIFORM_TEX_SAMPLERCUBE="samplerCube",s.UNIFORM_TEX_SAMPLER3D="sampler3D",s.UNIFORMNS_TEX_SAMPLER_0="u_sampler0",s.UNIFORMNS_TEX_SAMPLER_1="u_sampler1",s.UNIFORMNS_TEX_SAMPLER_2="u_sampler2",s.UNIFORMNS_TEX_SAMPLER_3="u_sampler3",s.UNIFORMNS_TEX_SAMPLER_4="u_sampler4",s.UNIFORMNS_TEX_SAMPLER_5="u_sampler5",s.UNIFORMNS_TEX_SAMPLER_6="u_sampler6",s.UNIFORMNS_TEX_SAMPLER_7="u_sampler7",s.UNIFORMNS_TEX_SAMPLER_LIST=[s.UNIFORMNS_TEX_SAMPLER_0,s.UNIFORMNS_TEX_SAMPLER_1,s.UNIFORMNS_TEX_SAMPLER_2,s.UNIFORMNS_TEX_SAMPLER_3,s.UNIFORMNS_TEX_SAMPLER_4,s.UNIFORMNS_TEX_SAMPLER_5,s.UNIFORMNS_TEX_SAMPLER_6,s.UNIFORMNS_TEX_SAMPLER_7],e.default=s},"6d49":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3b73")),a=s(i("baae")),h=i("8d98"),n=s(i("56c5"));class _{constructor(t,e,i){this.A=-1,this.k=0,this.A_R=0,this.A_S=null,this.A_T=null,this.A_U=null,this.A_V=null,this.A_W=512,this.A_X=512,this.A_Y=0,this.J=null,this.A_Z=0,this.A_a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.A_b=[!0,!0,!0,!0,!0,!0,!0,!0],this.A_c=0,this.A_d=0,this.D_=0,this.A_e=0,this.A_f=new Float32Array(1),this.A_g=new Float32Array(4),this.A_h=new Int16Array(4),this.A_i=!1,this.textureLevel=0,this.sizeFixed=!1,this.writeDepthEnabled=!0,this.writeStencilEnabled=!1,this.multisampleEnabled=!1,this.multisampleLevel=0,this.A_j=new Uint32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.A_k=new Uint32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.A_l=0,this.A_m=!1,this.A_n=2,this.A_o=2,this.k=t,this.AK=e,this.A_Y=i,this.A=_.B_O++}getUid(){return this.A}resetAttachmentMask(t){let e=this.A_b.length-1;while(e>=0)this.A_b[e]=t,--e}setAttachmentMaskAt(t,e){this.A_b[t]=e}getActiveAttachmentTotal(){return this.A_m?this.D_-1:this.D_}getAttachmentTotal(){return this.A_b.length}bindToBackbuffer(t){switch(t){case a.default.DRAW_FRAMEBUFFER:this.J.bindFramebuffer(this.J.DRAW_FRAMEBUFFER,null);break;case a.default.READ_FRAMEBUFFER:this.J.indFramebuffer(this.J.READ_FRAMEBUFFER,null);break;default:this.J.bindFramebuffer(this.J.FRAMEBUFFER,null)}}bind(t){if(null!=this.A_S)switch(t){case a.default.DRAW_FRAMEBUFFER:this.J.bindFramebuffer(this.J.DRAW_FRAMEBUFFER,this.A_S);break;case a.default.READ_FRAMEBUFFER:this.J.bindFramebuffer(this.J.READ_FRAMEBUFFER,this.A_S);break;default:this.J.bindFramebuffer(this.J.FRAMEBUFFER,this.A_S)}}getFBO(){return this.A_S}getDepthStencilRBO(){return this.A_T}getDepthRBO(){return this.A_U}getWidth(){return this.A_W}getHeight(){return this.A_X}getFramebufferType(){return this.A_Y}renderToTexAt(t,e,i){let s=null!=e?e.internalFormat:-1;this.J=t,0==i&&(this.A_l=0,this.A_m=!1,this.J.bindFramebuffer(this.A_Z,this.A_S),s!=h.TextureFormat.DEPTH_COMPONENT&&s!=h.TextureFormat.DEPTH_STENCIL&&(this.D_=0,this.A_e=0));let r=-1,a=null;null!=e?(r=e.getTargetType(),a=this.AK.getGpuBuffer(e.getResUid()),e.uploadFromFbo(this.AK,this.A_W,this.A_X)):r=this.A_a[this.D_],this.framebufferTextureBind(t,r,s,a)}glFramebufferTex2D(t,e){let i=this.J;i.framebufferTexture2D(this.A_Z,t,i.TEXTURE_2D,e,0),this.A_j[this.A_l]=t,this.A_k[this.A_l]=i.TEXTURE_2D,this.A_l++}glFramebufferTexCube(t,e,i){let s=this.J;s.framebufferTexture2D(this.A_Z,t,s.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0),this.A_j[this.A_l]=t,this.A_k[this.A_l]=s.TEXTURE_CUBE_MAP_POSITIVE_X+e,this.A_l++}framebufferTexture2D(t,e,i,s){let r=-1;switch(i){case h.TextureFormat.DEPTH_COMPONENT:this.A_m=!0,r=this.J.DEPTH_ATTACHMENT;break;case h.TextureFormat.DEPTH_STENCIL:this.A_m=!0,r=this.J.DEPTH_STENCIL_ATTACHMENT;break;default:r=this.A_R+this.A_e;break}r>0&&(this.A_b[this.D_]?(this.glFramebufferTex2D(r,s),++this.A_e,this.A_a[this.D_]=null!=s?e:0):this.A_a[this.D_]=0,++this.D_)}framebufferTextureBind(t,e,i,s){switch(e){case h.TextureTarget.TEXTURE_2D:this.framebufferTexture2D(t,e,i,s);break;case h.TextureTarget.TEXTURE_CUBE:let r=0;for(let t=0;t<6;++t)this.A_b[t]?(this.glFramebufferTexCube(this.A_R+this.A_e,t,s),++this.A_e,this.A_a[this.D_+t]=null!=s?e:0,r++):this.A_a[this.D_+t]=0;r=r>0?r:6,this.D_+=r;break;case h.TextureTarget.TEXTURE_SHADOW_2D:this.A_b[this.D_]?(this.glFramebufferTex2D(this.J.DEPTH_ATTACHMENT,s),this.A_a[this.D_]=null!=s?e:0):this.A_a[this.D_]=0,++this.D_;break;default:break}}reset(){this.A_c=-1,this.A_d=-1}use(t){if(this.J=t,null!=this.A_S){if(this.D_>1){if(this.A_d!=this.A_e){let t=[],e=0;for(;e<this.A_e;++e)t.push(this.A_R+e);if(this.A_d>this.A_e)for(;e<this.A_d;++e)this.J.framebufferTexture2D(this.A_Z,this.A_j[e],this.A_k[e],null,0);n.default.DrawBuffers(t),this.A_d=this.A_e}}else if(this.A_d!=this.A_e){if(this.A_d>this.A_e)for(let e=1;e<this.A_d;++e)this.J.framebufferTexture2D(this.A_Z,this.A_j[e],this.A_k[e],null,0);let t=[this.A_R];n.default.DrawBuffers(t),this.A_d=this.A_e}this.A_c=this.D_}}clearOnlyColor(t){if(null!=this.A_S)if(r.default.IsWebGL2())if(this.A_g[0]=t.r,this.A_g[1]=t.g,this.A_g[2]=t.b,this.A_g[3]=t.a,this.A_c>1)for(let e=0;e<this.A_c;++e)this.J.clearBufferfv(this.J.COLOR,e,this.A_g);else this.J.clearBufferfv(this.J.COLOR,0,this.A_g);else this.J.clearColor(t.r,t.g,t.b,t.a)}clearOnlyDepth(t=1){r.default.IsWebGL2()?(this.A_f[0]=t,this.J.clearBufferfv(this.J.DEPTH,0,this.A_f)):this.J.clearDepth(t)}clearOnlyStencil(t){this.A_h[0]=t,this.J.clearBufferuiv(this.J.STENCIL,0,this.A_h)}clearOnlyDepthAndStencil(t,e){this.J.clearBufferfi(this.J.DEPTH_STENCIL,0,t,e)}invalidateFramebuffer(){}resize(t,e){this.A_n==t&&this.A_o==e||(this.A_i=!0,this.A_n=t,this.A_o=e)}initialize(t,e,i){this.J=t,this.A_R=n.default.COLOR_ATTACHMENT0,this.A_i&&(e=this.A_n,i=this.A_o),null==this.A_S?this.createNewFBO(t,e,i):this.A_W==e&&this.A_X==i||this.createNewFBO(t,e,i),this.A_i=!1}isSizeChanged(){return this.A_i}destroy(t){null!=this.A_S&&(null!=this.A_T&&(t.deleteFramebuffer(this.A_T),this.A_T=null),null!=this.A_U&&(t.deleteFramebuffer(this.A_U),this.A_U=null),null!=this.A_V&&(t.deleteFramebuffer(this.A_V),this.A_V=null),t.deleteFramebuffer(this.A_S),this.A_S=null),this.J=null,this.A_Z=0,this.A_i=!1}buildDepthStencilRBO(t,e,i){null==this.A_T&&(this.A_T=t.createRenderbuffer()),this.multisampleEnabled?(t.bindRenderbuffer(t.RENDERBUFFER,this.A_T),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multisampleLevel,t.DEPTH_STENCIL,e,i),t.framebufferRenderbuffer(this.A_Z,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.A_T),null==this.A_V&&(this.A_V=t.createRenderbuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.A_V),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multisampleLevel,t.RGBA8,e,i),t.framebufferRenderbuffer(this.A_Z,this.A_R,t.RENDERBUFFER,this.A_V)):(t.bindRenderbuffer(t.RENDERBUFFER,this.A_T),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e,i),t.framebufferRenderbuffer(this.A_Z,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.A_T))}buildDepthRBO(t,e,i){null==this.A_U&&(this.A_U=t.createRenderbuffer()),this.multisampleEnabled?(t.bindRenderbuffer(t.RENDERBUFFER,this.A_U),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multisampleLevel,t.DEPTH_COMPONENT24,e,i),t.framebufferRenderbuffer(this.A_Z,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.A_U),null==this.A_V&&(this.A_V=t.createRenderbuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.A_V),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multisampleLevel,t.RGBA8,e,i),t.framebufferRenderbuffer(this.A_Z,this.A_R,t.RENDERBUFFER,this.A_V)):(t.bindRenderbuffer(t.RENDERBUFFER,this.A_U),r.default.IsWebGL2()?t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT24,e,i):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e,i),t.framebufferRenderbuffer(this.A_Z,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.A_U))}buildStencilRBO(t,e,i){null==this.A_T&&(null==this.A_T&&(this.A_T=t.createRenderbuffer()),this.multisampleEnabled?(t.bindRenderbuffer(t.RENDERBUFFER,this.A_T),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multisampleLevel,t.STENCIL_INDEX8,e,i),t.framebufferRenderbuffer(this.A_Z,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,this.A_T),null==this.A_V&&(this.A_V=t.createRenderbuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.A_V),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multisampleLevel,t.RGBA8,e,i),t.framebufferRenderbuffer(this.A_Z,this.A_R,t.RENDERBUFFER,this.A_V)):(t.bindRenderbuffer(t.RENDERBUFFER,this.A_T),t.renderbufferStorage(t.RENDERBUFFER,t.STENCIL_INDEX8,e,i),t.framebufferRenderbuffer(this.A_Z,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,this.A_T)))}buildColorRBO(t,e,i){this.multisampleEnabled&&(null==this.A_V&&(this.A_V=t.createRenderbuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.A_V),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.multisampleLevel,t.RGBA8,e,i),t.framebufferRenderbuffer(this.A_Z,this.A_R,t.RENDERBUFFER,this.A_V))}createNewFBO(t,e,i){let s=null==this.A_S;switch(this.A_c=this.D_=0,this.A_d=this.A_e=0,this.A_W=e,this.A_X=i,this.A_n=e,this.A_o=i,s&&(this.A_S=t.createFramebuffer()),this.A_Y){case a.default.DRAW_FRAMEBUFFER:this.A_Z=t.DRAW_FRAMEBUFFER;break;case a.default.READ_FRAMEBUFFER:this.A_Z=t.READ_FRAMEBUFFER;break;default:this.A_Z=t.FRAMEBUFFER;break}if(t.bindFramebuffer(this.A_Z,this.A_S),this.writeDepthEnabled?this.writeStencilEnabled?null==this.A_T&&this.buildDepthStencilRBO(t,e,i):this.buildDepthRBO(t,e,i):this.writeStencilEnabled?this.buildStencilRBO(t,e,i):this.buildColorRBO(t,e,i),s){t.checkFramebufferStatus(this.A_Z);t.FRAMEBUFFER_COMPLETE}_.BindToBackbuffer(t,this.A_Y)}static BindToBackbuffer(t,e){switch(e){case a.default.DRAW_FRAMEBUFFER:t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null);break;case a.default.READ_FRAMEBUFFER:t.indFramebuffer(t.READ_FRAMEBUFFER,null);break;default:t.bindFramebuffer(t.FRAMEBUFFER,null);break}}}_.B_O=0,e.default=_},"6e01":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static Clamp(t,e,i){return Math.max(Math.min(t,i),e)}static IsPowerOf2(t){return 0==(t&t-1)}static CalcCeilPowerOfTwo(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}static CalcNearestCeilPow2(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))}static CalcFloorCeilPow2(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}static DegreeToRadian(t){return s.MATH_PI_OVER_180*t}static Log2(t){return Math.log(t)/Math.LN2}static GetMaxMipMapLevel(t,e){return Math.round(s.Log2(Math.max(t,e))+1)}static SafeACos(t){return t<=-1?s.MATH_PI:t>=1?0:Math.acos(t)}static GetNearestCeilPow2(t){let e=1;while(e<t)e<<=1;return e}static GetMinRadian(t,e){return e%=s.MATH_2PI,t%=s.MATH_2PI,e<t?(e=s.MATH_2PI-t+e,e>s.MATH_PI?e-s.MATH_2PI:e):e>t?(t=s.MATH_2PI-e+t,t>s.MATH_PI?s.MATH_2PI-t:-t):0}static GetMinDegree(t,e){let i=0;return e>=270&&t<90?i=(e-(t+360))%180:e<=90&&t>=270?i=(e+360-t)%180:(i=e-t,i>180?(i-=360,i%=360):i<-180&&(i+=360,i%=360)),i}static GetDegreeByXY(t,e){if(Math.abs(t)<1e-5)return e>=0?270:90;let i=180*Math.atan(e/t)/Math.PI;return t>=0?i:180+i}static GetRadianByXY(t,e){if(Math.abs(t)<s.MATH_MIN_POSITIVE)return e>=0?s.MATH_1PER2PI:s.MATH_3PER2PI;let i=Math.atan(e/t);return t>=0?i:s.MATH_PI+i}static GetRadianByCos(t,e,i){var r=Math.acos(t);return e>=0?r:s.MATH_PI+r}}s.MATH_MIN_POSITIVE=1e-5,s.MATH_MAX_NEGATIVE=-1e-5,s.MATH_MAX_POSITIVE=268435454,s.MATH_MIN_NEGATIVE=-268435454,s.MATH_1_OVER_255=1/255,s.MATH_PI=Math.PI,s.MATH_2PI=2*s.MATH_PI,s.MATH_3PER2PI=1.5*s.MATH_PI,s.MATH_1PER2PI=.5*s.MATH_PI,s.MATH_1_OVER_PI=1/s.MATH_PI,s.MATH_1_OVER_360=1/360,s.MATH_1_OVER_180=1/180,s.MATH_180_OVER_PI=180/s.MATH_PI,s.MATH_PI_OVER_180=s.MATH_PI/180,s.MATH_LN2=.6931471805599453,e.default=s},"722e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{}s.NEAREST=4001,s.LINEAR=4002,s.LINEAR_MIPMAP_LINEAR=4003,s.NEAREST_MIPMAP_NEAREST=4004,s.LINEAR_MIPMAP_NEAREST=4005,s.NEAREST_MIPMAP_LINEAR=4006,e.default=s},7279:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("5326")),a=s(i("3b73")),h=s(i("d53d"));class n extends h.default{constructor(){super(),this.slotId=0,this.slotIndex=0,this.uniformsTotal=0,this.locationIndexList=null,this.locations=null,this.rst=0,this.always=!1}clone(){let t=new n;return t.types=this.types.slice(0),t.uniformNameList=this.uniformNameList.slice(0),t.dataSizeList=this.dataSizeList.slice(0),t.slotIndex=this.slotIndex,t.uniformsTotal=this.uniformsTotal,t.slotId=this.slotId,t.always=this.always,t.rst=this.rst,t}copyDataFromProbe(t){this.types=t.uniformTypes.slice(0),this.dataSizeList=t.dataSizeList.slice(0),this.slotIndex=t.getSlotBeginIndex(),this.uniformsTotal=t.uniformsTotal,this.slotId=t.getSlotUid()}copyDataFromProbeAt(t,e){null==this.types&&(this.types=[],this.dataSizeList=[]),this.slotIndex=e.getSlotBeginIndex()+t,this.uniformsTotal=1,this.slotId=e.getSlotUid(),this.types[0]=e.uniformTypes[t],this.dataSizeList[0]=e.dataSizeList[t]}use(t){let e=r.default.GetSlotAt(t.getRCUid());if(this.always||this.rst!=e.flagList[this.slotIndex]){this.rst=e.flagList[this.slotIndex];let i=0;if(a.default.IsWebGL1())for(;i<this.uniformsTotal;++i)t.useUniformV1(this.locations[i],this.types[i],e.dataList[this.slotIndex+i],this.dataSizeList[i]);else for(;i<this.uniformsTotal;++i)t.useUniformV2(this.locations[i],this.types[i],e.dataList[this.slotIndex+i],this.dataSizeList[i],0)}}destroy(){this.types=null,this.dataSizeList=null,this.slotIndex=-1,this.uniformsTotal=0}}e.default=n},7499:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.A_p=null,this.w_=null,this.AK=null}setDispBuilder(t){null==this.A_p&&(this.A_p=t,this.w_=t.getRenderShader(),this.AK=t.getTextureResource())}unlockMaterial(){this.w_.unlock(),this.AK.unlocked=!0}lockMaterial(){this.w_.lock(),this.AK.unlocked=!1}isUnlockMatrial(){return this.AK.unlocked}unlockTexture(){this.w_.textureUnlock()}lockTexture(){this.w_.textureLock()}renderBegin(){this.w_.renderBegin(),this.AK.renderBegin()}resetUniform(){this.w_.resetUniform()}useGlobalMaterial(t,e=!1){null!=t&&this.A_p.updateGlobalMaterial(t,e)}updateMaterialUniform(t){this.w_.updateUniform(t.__$uniform)}}e.default=s},"74c3":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e,i){this.A_q=new Map,this.A_r=new Map,this.A_s=[],this.A_t=0,this.A_u=0,this.A_v=128,this.AO=!1,this.A_w=16,this.k=0,this.J=null,this.A_x=null,this.unlocked=!0,this.k=t,this.J=e,this.A_x=i}setVtxUpdateTimesTotal(t){this.A_w=t>4?t:4}createResByParams3(t,e,i,s){return!1}getRCUid(){return this.k}getRC(){return this.J}hasResUid(t){return this.A_q.has(t)}bindToGpu(t){}getGpuBuffer(t){return null}renderBegin(){this.A_x.renderBegin()}getVertexResTotal(){return this.A_t}updateDataToGpu(t,e){e?(this.A_s.push(t),this.AO=!0):this.A_q.has(t)&&this.A_q.get(t).updateToGpu(this.A_x)}addVertexRes(t){this.A_q.has(t.resUid)||(t.waitDelTimes=0,this.A_q.set(t.resUid,t),this.A_t++)}getVertexRes(t){return this.A_q.get(t)}destroyRes(t){this.A_q.has(t)&&this.A_q.get(t).destroy(this.A_x)}__$attachRes(t){if(this.A_q.has(t)){this.A_u++;let e=this.A_q.get(t);e.getAttachCount()<1&&this.A_r.has(t)&&this.A_r.delete(t),e.waitDelTimes=0,e.__$attachThis()}}__$detachRes(t){if(this.A_q.has(t)&&this.A_q.has(t)){let e=this.A_q.get(t);e.getAttachCount()>0&&(this.A_u--,e.__$detachThis(),e.getAttachCount()<1&&this.A_r.set(t,e))}}getVROByResUid(t,e,i){let s=this.A_q.get(t);return null!=s?s.createVRO(this.A_x,e,i):null}update(){if(this.AO){let t=this.A_s.length;if(t>0){let e;t>this.A_w&&(t=this.A_w);for(let i=0;i<t;++i)e=this.A_s.shift(),this.A_q.has(e)&&this.A_q.get(e).updateToGpu(this.A_x)}else this.AO=!1}if(this.A_v--,this.A_v<1){this.A_v=128;for(const[t,e]of this.A_r)e.waitDelTimes++,e.getAttachCount()<1?e.waitDelTimes>5&&(this.A_q.delete(e.resUid),this.A_r.delete(e.resUid),e.destroy(this.A_x),this.A_t--):this.A_r.delete(e.resUid)}}}e.ROVertexResource=s,e.default=s},7696:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("264c")),a=s(i("5f3c"));class h{constructor(t,e,i,s,r,a){this.k=-1,this.A_y=-1,this.A_z=0,this.A_0=!0,this.A_1=[],this.A_2=0,this.A_3=new Int8Array(h.B_i),this.A_4=h.B_i,this.w_=null,this.A6=null,this.K_=null,this.A7=null,this.A_5=null,this.A_6=null,this.y_=null,this.A8=!0,this.A9=!0,this.A_7=!1,this.A_8=0,this.uid=-1,this.w_=t,this.A6=e,this.K_=i,this.A7=s,this.A_5=this.createBlock(),this.A8=r,this.A9=a;for(let h=0;h<this.A_4;++h)this.A_3[h]=-1}createBlock(){let t=new a.default(this.w_);return t.rpoNodeBuilder=this.A6,t.rpoUnitBuilder=this.K_,t.vtxResource=this.A7,t}setRenderParam(t,e){this.A_2<1&&(this.A8=t,this.A9=e)}setRendererParam(t,e){this.U_=t,this.k=t.getRCUid(),this.A_y=e}getUid(){return this.uid}getRCUid(){return this.k}getRPIndex(){return this.A_y}hasSorter(){return null!=this.y_}setSorter(t){this.y_=t,null!=this.A_6&&this.A_6.setSorter(t)}setSortEnabled(t){this.A_z<1?this.A_7=t:null!=this.A_6&&(this.A_6.sortEnabled=t)}getSortEnabled(){return this.A_7}getUnitsTotal(){return this.A_z}addNodeToBlock(t){let e=null;if(t.shdUid>=h.B_i)throw Error("Shader uid >= "+h.B_i);this.A_3[t.shdUid]<0?(e=this.createBlock(),e.batchEnabled=this.A8,e.fixedState=this.A9,e.batchEnabled?e.fixedState?e.runMode=2:e.runMode=1:e.runMode=0,e.shdUid=t.shdUid,e.index=this.A_2,e.procuid=this.A_y,this.A_1.push(e),this.A_3[t.shdUid]=this.A_2,++this.A_2):e=this.A_1[this.A_3[t.shdUid]],t.index=e.index,e.addNode(t)}rejoinRunitForTro(t){let e=this.A6.getNodeByUid(t.__$rpuid);null!=e&&(e.tro=t.tro,e.texMid=e.unit.texMid,this.A_1[e.index].rejoinNode(e))}rejoinRunitForVro(t){let e=this.A6.getNodeByUid(t.__$rpuid);null!=e&&(e.drawMode=t.drawMode,e.ivsIndex=t.ivsIndex,e.ivsCount=t.ivsCount,e.insCount=t.insCount,t.drawOffset=t.ivsIndex*t.ibufStep,e.vtxUid=t.vtxUid,e.vro=t.vro,this.A_1[e.index].rejoinNode(e),this.A_8++)}addDisp(t){if(null!=t&&null!=t.__$$runit&&t.__$$runit.getRPROUid()<0&&t.__$$runit.getRPROUid()!=this.uid){let e=this.A6.create();e.unit=this.K_.getNodeByUid(t.__$ruid),e.unit.shader=this.w_,e.unit.__$rprouid=this.uid,t.__$rpuid=e.uid,e.__$ruid=t.__$ruid,e.unit.__$rpuid=e.uid,e.updateData(),++this.A_z,this.K_.setRPNodeParam(t.__$ruid,this.getUid(),e.uid),this.A_7?(null!=this.A_6||(this.A_6=new r.default(this.w_),this.A_6.setSorter(this.y_)),this.A_6.addNode(e)):this.addNodeToBlock(e),this.A_8++}}updateDispMateiral(t){if(null!=t.__$$runit){let e=t.__$$runit.getRPOUid(),i=this.A6.getNodeByUid(e);i.shdUid=i.unit.shdUid,i.texMid=i.unit.texMid,i.tro=i.unit.tro;let s=this.A_1[i.index];s.removeNode(i),this.addNodeToBlock(i)}}removeDisp(t){if(null!=t&&null!=t.__$$runit){let e=t.__$$runit.getRPOUid(),i=this.A6.getNodeByUid(e);if(null!=i){if(null==this.A_6){let t=this.A_1[i.index];t.removeNode(i)}else this.A_6.removeNode(i);this.K_.setRPNodeParam(t.__$ruid,this.getUid(),-1),--this.A_z;let e=i.unit;this.A6.restore(i)&&this.K_.restore(e),this.A7.__$detachRes(t.vbuf.getUid()),t.__$$runit=null,t.__$ruid=-1,this.A_8++}}}getStatus(){return this.A_8}removeDispUnit(t){if(null!=t&&t.__$ruid>-1){let e=t.__$$runit.getRPOUid(),i=this.A6.getNodeByUid(e);if(null!=i){if(null==this.A_6){let t=this.A_1[i.index];t.removeNode(i)}else this.A_6.removeNode(i);this.K_.setRPNodeParam(t.__$ruid,this.A_y,-1),i.unit.__$rprouid=-1,--this.A_z,this.A6.restore(i)}}}update(){this.A_0&&this.A_z>0&&null!=this.A_6&&this.A_6.update()}run(){if(this.A_0&&this.A_z>0){let t=this.U_;if(null==this.A_6)if(this.w_.isUnLocked())for(let e=0;e<this.A_2;++e)this.A_1[e].run(t);else for(let e=0;e<this.A_2;++e)this.A_1[e].runLockMaterial(t);else this.w_.isUnLocked()?this.A_6.run(t):this.A_6.runLockMaterial(t)}}drawDisp(t,e=!1,i=!0){if(null!=t){let s=t.__$$runit;null!=s&&(this.w_.isUnLocked()?(i&&this.w_.resetUniform(),this.A_5.drawUnit(this.U_,s,t)):this.A_5.drawLockMaterialByUnit(this.U_,s,t,e,i))}}drawLockMaterialByDisp(t,e=!1,i=!0){if(null!=t){let s=t.__$$runit;null!=s&&this.A_5.drawLockMaterialByUnit(this.U_,s,t,e,i)}}reset(){this.A_7=!1,this.A_z=0,this.uid=-1,this.A_y=-1,this.k=-1,this.A_y=-1;let t=0;for(;t<this.A_2;++t)this.A_1[t].reset();this.A_2=0,this.A_1=[],this.A6=null,this.K_=null,this.A7=null,this.U_=null,null!=this.A_6&&(this.A_6.clear(),this.A_6=null)}showInfo(){let t=0;for(;t<this.A_2;++t)this.A_1[t].showInfo()}destroy(){this.reset()}setEnabled(t){this.A_0=t}getEnabled(){return this.A_0}toString(){return"[RenderProcess(uid = "+this.A_y+")]"}}h.B_i=1024,e.default=h},"7c63":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("e08e");class r{constructor(t,e,i,s){this.A=-1,this.A_9=!0,this.A_=!0,this.BA=!0,this.BB=!0,this.A=r.B_O++,this.A_9=t,this.A_=e,this.BA=i,this.BB=s}getUid(){return this.A}getR(){return this.A_9}getG(){return this.A_}getB(){return this.BA}getA(){return this.BB}use(){r.B_j!=this.A&&(r.Rstate.setColorMask(this.A_9,this.A_,this.BA,this.BB),r.B_j=this.A)}static Create(t,e,i,s,a){if(r.B_k.has(t)){let e=r.B_k.get(t);return e.getUid()}let h=(e?64:32)|(i?16:8)|(s?4:2)|(a?1:0);if(r.B_l.has(h)){let t=r.B_l.get(h);h=t.getUid()}else{let n=new r(e,i,s,a);h=n.getUid(),r.B_l.set(h,n),r.B_k.set(t,n),r.B_m.push(n),++r.B_o}return h}static GetColorMaskByName(t){if(r.B_k.has(t)){let e=r.B_k.get(t);return e.getUid()}return-1}static UseRenderState(t){r.B_n&&r.Rstate.roColorMask!=t&&t>-1&&t<r.B_o&&r.B_m[t].use()}static UseColorMaskByName(t){let e=r.GetColorMaskByName(t);r.B_n&&r.Rstate.roColorMask!=e&&e>-1&&e<r.B_o&&r.B_m[e].use()}static Lock(){r.B_n=!1}static Unlock(){r.B_n=!0}static Reset(){r.B_j=-1}}r.B_O=0,r.B_j=-1,r.B_m=[],r.B_o=1,r.B_l=new Map,r.B_k=new Map,r.B_n=!0,r.ALL_TRUE_COLOR_MASK=0,r.ALL_FALSE_COLOR_MASK=1,r.Rstate=null,e.RenderColorMask=r;class a{constructor(t,e,i){this.A=-1,this.BC=0,this.BD=0,this.BE=0,this.BF=0,this.A=a.B_O++,this.BC=t,this.BD=e,this.BE=i}getUid(){return this.A}getCullFaceMode(){return this.BC}getDepthTestMode(){return this.BE}getBlendMode(){return this.BD}use(){if(a.B_j!=this.A){a.Rstate.setCullFaceMode(this.BC);a.B_v[a.BD];a.BD<0?a.Rstate.setBlendMode(this.BD,a.B_v[this.BD]):a.Rstate.setBlendMode(a.BD,a.B_v[a.BD]),a.B_t<0?a.Rstate.setDepthTestMode(this.BE):a.Rstate.setDepthTestMode(a.B_t),a.B_j=this.A}}static CreateBlendModeSeparate(t,e,i,r,h,n=0,_=0){if(null!=t&&""!=t){let l;if(a.B_p.has(t))return l=a.B_p.get(t),a.B_q.get(l);n<1&&(n=s.GLBlendEquation.FUNC_ADD),_<1&&(_=s.GLBlendEquation.FUNC_ADD);let o=1;if(l=31,l=131*l+e,l=131*l+i,r>0&&h>0&&(l=131*l+r,l=131*l+h,o=1),a.B_q.has(l))return a.B_p.set(t,l),a.B_q.get(l);let m=++a.B_r;a.B_p.set(t,l),a.B_q.set(l,m);let d=[o,n,_,e,i,r,h];return a.B_v[m]=d,m}return 0}static CreateBlendMode(t,e,i,r=0){if(null!=t&&""!=t){let h;if(a.B_p.has(t))return h=a.B_p.get(t),a.B_q.get(h);r<1&&(r=s.GLBlendEquation.FUNC_ADD);let n=0;if(h=31,h=131*h+e,h=131*h+i,a.B_q.has(h))return a.B_q.get(h);let _=++a.B_r;a.B_p.set(t,h),a.B_q.set(h,_);let l=[n,r,0,e,i,0,0];return a.B_v[_]=l,_}return 0}static Create(t,e,i,s){if(a.B_k.has(t)){let e=a.B_k.get(t);return e.getUid()}let r=31;if(r=131*r+s,r=131*r+i,r=131*r+e,a.B_l.has(r)){let t=a.B_l.get(r);r=t.getUid()}else{let h=new a(e,i,s);r=h.getUid(),a.B_l.set(r,h),a.B_k.set(t,h),a.B_m.push(h),++a.B_o}return r}static GetRenderStateByName(t){if(a.B_k.has(t)){let e=a.B_k.get(t);return e.getUid()}return-1}static UseRenderState(t){a.B_n&&a.B_j!=t&&t>-1&&t<a.B_o&&a.B_m[t].use()}static UseRenderStateByName(t){if(a.B_n){let e=a.GetRenderStateByName(t);a.B_j!=e&&e>-1&&e<a.B_o&&a.B_m[e].use()}}static UnlockBlendMode(){a.BD=a.B_s}static LockBlendMode(t){a.B_s=a.BD,a.BD=t}static UnlockDepthTestMode(){a.B_t=a.B_u}static LockDepthTestMode(t){a.B_u=a.B_t,a.B_t=t}static Lock(){a.B_n=!1}static Unlock(){a.B_n=!0}static Reset(){a.B_j=-1}}a.B_O=0,a.B_j=-1,a.B_m=[],a.B_o=1,a.BD=-1,a.B_t=-1,a.B_l=new Map,a.B_k=new Map,a.B_p=new Map,a.B_q=new Map,a.B_r=0,a.B_v=new Array(256),a.B_n=!0,a.Rstate=null,a.B_s=-1,a.B_u=-1,e.RenderStateObject=a;class h{constructor(){this.stencilMask=-1}}class n{constructor(){this.BG=new Array(128),this.BH=null,this.BD=s.RenderBlendMode.NORMAL,this.BI=s.CullFaceMode.NONE,this.BJ=s.DepthTestMode.DISABLE,this.BK=!0,this.BL=null,this.J=null,this.roColorMask=-11}reset(){this.roColorMask=-11}setRenderContext(t){this.BL=t,this.J=t.getRC();let e=this.J.rcuid;this.BH=this.BG[e],null==this.BH&&(this.BH=this.BG[e]=new h)}setColorMask(t,e,i,s){this.J.colorMask(t,e,i,s)}setStencilFunc(t,e,i){this.J.stencilFunc(t,e,i)}setStencilMask(t){this.BH.stencilMask!=t&&t>=0&&(this.BH.stencilMask=t,this.J.stencilMask(t))}setStencilOp(t,e,i){this.J.stencilOp(t,e,i)}setDepthTestEnable(t){t?this.J.enable(this.J.DEPTH_TEST):this.J.disable(this.J.DEPTH_TEST)}setCullFaceEnable(t){t?this.J.enable(this.J.CULL_FACE):this.J.disable(this.J.CULL_FACE)}setBlendEnable(t){t?this.J.enable(this.J.BLEND):this.J.disable(this.J.BLEND)}setCullFaceMode(t){this.BI!=t&&(this.BI=t,t!=s.CullFaceMode.NONE?(this.BK&&(this.BK=!1,this.J.enable(this.J.CULL_FACE)),this.J.cullFace(t)):this.BK||(this.BK=!0,this.J.disable(this.J.CULL_FACE)))}setBlendMode(t,e){this.BD!=t&&(this.BD=t,t>0?e[0]<1?(this.J.blendEquation(this.J.FUNC_ADD),this.J.blendFunc(this.J.ONE,this.J.ZERO),this.J.blendEquation(e[1]),this.J.blendFunc(e[3],e[4])):(this.J.blendEquationSeparate(e[1],e[2]),this.J.blendFuncSeparate(e[3],e[4],e[5],e[6])):this.J.disable(this.J.BLEND))}setDepthTestMode(t){if(this.BJ!=t)switch(this.BJ=t,t){case s.DepthTestMode.ALWAYS:this.J.depthMask(!1),this.J.depthFunc(this.J.ALWAYS);break;case s.DepthTestMode.SKY:this.J.depthMask(!0),this.J.depthFunc(this.J.LEQUAL);break;case s.DepthTestMode.OPAQUE:this.J.depthMask(!0),this.J.depthFunc(this.J.LESS);break;case s.DepthTestMode.OPAQUE_OVERHEAD:this.J.depthMask(!1),this.J.depthFunc(this.J.EQUAL);break;case s.DepthTestMode.DECALS:this.J.depthMask(!1),this.J.depthFunc(this.J.LEQUAL);break;case s.DepthTestMode.BLEND:this.J.depthMask(!1),this.J.depthFunc(this.J.LESS);break;case s.DepthTestMode.WIRE_FRAME:this.J.depthMask(!0),this.J.depthFunc(this.J.LEQUAL);break;case s.DepthTestMode.NEXT_LAYER:this.J.depthMask(!1),this.J.depthFunc(this.J.ALWAYS);break;case s.DepthTestMode.TRUE_EQUAL:this.J.depthMask(!0),this.J.depthFunc(this.J.EQUAL);break;case s.DepthTestMode.TRUE_GREATER:this.J.depthMask(!0),this.J.depthFunc(this.J.GREATER);break;case s.DepthTestMode.TRUE_GEQUAL:this.J.depthMask(!0),this.J.depthFunc(this.J.GEQUAL);break;case s.DepthTestMode.WIRE_FRAME_NEXT:break;default:break}}}e.RODrawState=n},8333:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{}s.COLOR_BUFFER_BIT=131,s.DEPTH_BUFFER_BIT=132,s.STENCIL_BUFFER_BIT=133,e.default=s},"83d1":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("ab73")),a=s(i("7279"));class h{create(t,e){let i=null,s=r.default.StageParam;return e.hasUniformByName(s.name)&&(i=new a.default,i.uns=s.name,i.uniformNameList=[s.name],i.copyDataFromProbe(t.getStage3D().uProbe)),i}getIDNS(){return"StageParamUniformBuilder"}}e.default=h},"857b":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("ab73")),a=s(i("7279"));class h{create(t,e){let i=null,s=r.default.CameraPosParam;return e.hasUniformByName(s.name)&&(i=new a.default,i.uns=s.name,i.uniformNameList=[s.name],i.copyDataFromProbe(t.getCamera().ucameraPosProbe)),i}getIDNS(){return"CameraPosUniformBuilder"}}e.default=h},8875:function(t,e,i){var s,r,a;(function(i,h){r=[],s=h,a="function"===typeof s?s.apply(e,r):s,void 0===a||(t.exports=a)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(u){var i,s,r,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,h=/@([^@]*):(\d+):(\d+)\s*$/gi,n=a.exec(u.stack)||h.exec(u.stack),_=n&&n[1]||!1,l=n&&n[2]||!1,o=document.location.href.replace(document.location.hash,""),m=document.getElementsByTagName("script");_===o&&(i=document.documentElement.outerHTML,s=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),r=i.replace(s,"$1").trim());for(var d=0;d<m.length;d++){if("interactive"===m[d].readyState)return m[d];if(m[d].src===_)return m[d];if(_===o&&m[d].innerHTML&&m[d].innerHTML.trim()===r)return m[d]}return null}}return t}))},"8a0a":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("ca6c"));class a{static ToGL(t,e){switch(e){case a.VTX_STATIC_DRAW:return t.STATIC_DRAW;case a.VTX_DYNAMIC_DRAW:return t.DYNAMIC_DRAW;case a.VTX_STREAM_DRAW:return t.STREAM_DRAW;case a.VTX_STATIC_READ:return t.STATIC_READ;case a.VTX_DYNAMIC_READ:return t.DYNAMIC_READ;case a.VTX_STREAM_READ:return t.STREAM_READ;case a.VTX_STATIC_COPY:return t.STATIC_COPY;case a.VTX_DYNAMIC_COPY:return t.DYNAMIC_COPY;case a.VTX_STREAM_COPY:return t.STREAM_COPY;default:break}return t.STATIC_DRAW}static GetVBufTypeByNS(t){switch(t){case a.VBUF_VS_NS:return a.VBUF_VS;case a.VBUF_UVS_NS:return a.VBUF_UVS;case a.VBUF_NVS_NS:return a.VBUF_NVS;case a.VBUF_CVS_NS:return a.VBUF_CVS;case a.VBUF_VS2_NS:return a.VBUF_VS2;case a.VBUF_UVS2_NS:return a.VBUF_UVS2;case a.VBUF_NVS2_NS:return a.VBUF_NVS2;case a.VBUF_CVS2_NS:return a.VBUF_CVS2;case a.VBUF_TVS_NS:return a.VBUF_TVS;case a.VBUF_TVS2_NS:return a.VBUF_TVS2;default:}return-1}static GetVBufNSByType(t){switch(t){case a.VBUF_VS:return a.VBUF_VS_NS;case a.VBUF_UVS:return a.VBUF_UVS_NS;case a.VBUF_NVS:return a.VBUF_NVS_NS;case a.VBUF_CVS:return a.VBUF_CVS_NS;case a.VBUF_VS2:return a.VBUF_VS2_NS;case a.VBUF_UVS2:return a.VBUF_UVS2_NS;case a.VBUF_NVS2:return a.VBUF_NVS2_NS;case a.VBUF_CVS2:return a.VBUF_CVS2_NS;case a.VBUF_TVS:return a.VBUF_TVS_NS;case a.VBUF_TVS2:return a.VBUF_TVS2_NS;default:}return""}static GetVBufAttributeTypeByNS(t){return a.GetVBufTypeByNS(t)-3e3}}a.VTXTYPE_GL_POINTS=101,a.VTXTYPE_GL_LINES=102,a.VTXTYPE_GL_LINE_STRIP=103,a.VTXTYPE_GL_TRIANGLES=111,a.VTX_STATIC_DRAW=0,a.VTX_DYNAMIC_DRAW=1,a.VTX_STREAM_DRAW=2,a.VTX_STATIC_READ=3,a.VTX_DYNAMIC_READ=4,a.VTX_STREAM_READ=5,a.VTX_STATIC_COPY=6,a.VTX_DYNAMIC_COPY=7,a.VTX_STREAM_COPY=8,a.VBUF_VS=3001,a.VBUF_UVS=3002,a.VBUF_NVS=3003,a.VBUF_CVS=3004,a.VBUF_TVS=3005,a.VBUF_VS2=3006,a.VBUF_UVS2=3007,a.VBUF_NVS2=3008,a.VBUF_CVS2=3009,a.VBUF_TVS2=3010,a.VBUF_VS_INDEX=r.default.BIT_ONE_0,a.VBUF_UVS_INDEX=r.default.BIT_ONE_1,a.VBUF_NVS_INDEX=r.default.BIT_ONE_2,a.VBUF_CVS_INDEX=r.default.BIT_ONE_3,a.VBUF_TVS_INDEX=r.default.BIT_ONE_4,a.VBUF_VS2_INDEX=r.default.BIT_ONE_5,a.VBUF_UVS2_INDEX=r.default.BIT_ONE_6,a.VBUF_NVS2_INDEX=r.default.BIT_ONE_7,a.VBUF_CVS2_INDEX=r.default.BIT_ONE_8,a.VBUF_TVS2_INDEX=r.default.BIT_ONE_9,a.VBUF_VS_NS="a_vs",a.VBUF_VS2_NS="a_vs2",a.VBUF_UVS_NS="a_uvs",a.VBUF_UVS2_NS="a_uvs2",a.VBUF_NVS_NS="a_nvs",a.VBUF_NVS2_NS="a_nvs2",a.VBUF_CVS_NS="a_cvs",a.VBUF_CVS2_NS="a_cvs2",a.VBUF_TVS_NS="a_tvs",a.VBUF_TVS2_NS="a_tvs2";class h{}h.FLAT=210,h.GOURAND=310,e.VtxNormalType=h,e.default=a},"8ae4":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.A=0,this.A_A=null,this.A_B=0,this.BM=null,this.BN=0,this.ibufStep=0,this.A=s.B_O+1}getUid(){return this.A}getVtxUid(){return this.A_B}getGpuBuf(){return this.BM}getVTCount(){return this.BN}updateToGpu(t){if(null!=this.BM&&this.BN>0){let e=this.A_A;this.version!=e.indicesVer&&(this.BO=e.getIvsData(),t.bindEleBuf(this.BM),this.BN>=this.BO.length?t.eleBufSubData(this.BO,e.getBufDataUsage()):t.eleBufData(this.BO,e.getBufDataUsage()),this.BN=this.BO.length,this.version=e.indicesVer)}}initialize(t,e){if(null==this.BM&&null!=e.getIvsData())if(this.version=e.indicesVer,this.A_A=e,this.A_B=e.getUid(),this.BO=e.getIvsData(),this.BM=t.createBuf(),t.bindEleBuf(this.BM),null==e.bufData)t.eleBufData(this.BO,e.getBufDataUsage()),this.BN=this.BO.length;else{t.eleBufDataMem(e.bufData.getIndexDataTotalBytes(),e.getBufDataUsage());let i=null,s=0;this.BN=0;for(let r=0,a=e.bufData.getIndexDataTotal();r<a;++r)i=e.bufData.getIndexDataAt(r),t.eleBufSubData(i,s),s+=i.byteLength,this.BN+=i.length}}destroy(t){null!=this.BM&&(this.A_A=null,t.deleteBuf(this.BM),this.BM=null,this.BO=null,this.BN=0)}}s.B_O=0,e.ROIndicesRes=s},"8d98":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3b73")),a=s(i("030e"));class h{static ToGL(t,e){switch(e){case h.RGBA:break;case h.R8:return t.R8;case h.RGB:return t.RGB;case h.RGB8:return t.RGB8;case h.RGBA8:return t.RGBA8;case h.ALPHA:return t.ALPHA;case h.RGB16F:return r.default.IsWebGL2()?t.RGB16F:t.RGB;case h.RGBA16F:return r.default.IsWebGL2()?t.RGBA16F:t.RGBA;case h.RGB32F:return r.default.IsWebGL2()&&t.RGB32F,t.RGB;case h.RGBA32F:return r.default.IsWebGL2()&&t.RGBA32F,t.RGBA;case h.RED:return t.RED;case h.DEPTH_COMPONENT:return t.DEPTH_COMPONENT;case h.DEPTH_STENCIL:return t.DEPTH_STENCIL;default:break}return t.RGBA}}h.R8=101,h.RGB=110,h.RED=111,h.RGBA=121,h.RGB8=122,h.RGBA8=123,h.ALPHA=132,h.RGB16F=331,h.RGBA16F=332,h.RGB32F=341,h.RGBA32F=342,h.DEPTH_COMPONENT=351,h.DEPTH_STENCIL=352,e.TextureFormat=h;class n{static ToGL(t,e){switch(e){case n.UNSIGNED_BYTE:return t.UNSIGNED_BYTE;case n.BYTE:return t.BYTE;case n.FLOAT:return t.FLOAT;case n.HALF_FLOAT:return t.HALF_FLOAT;case n.HALF_FLOAT_OES:return null!=a.default.OES_texture_half_float?a.default.OES_texture_half_float.HALF_FLOAT_OES:t.FLOAT;case n.UNSIGNED_SHORT:return t.UNSIGNED_SHORT;case n.UNSIGNED_INT:return t.UNSIGNED_INT;case n.UNSIGNED_SHORT_5_6_5:return t.UNSIGNED_SHORT_5_6_5;case n.UNSIGNED_SHORT_4_4_4_4:return t.UNSIGNED_SHORT_4_4_4_4;case n.UNSIGNED_SHORT_5_5_5_1:return t.UNSIGNED_SHORT_5_5_5_1;case n.UNSIGNED_INT_24_8_WEBGL:return a.default.WEBGL_depth_texture.UNSIGNED_INT_24_8_WEBGL;default:break}return t.UNSIGNED_BYTE}}n.UNSIGNED_BYTE=1108,n.UNSIGNED_SHORT=1109,n.UNSIGNED_INT=1110,n.BYTE=1111,n.FLOAT=1211,n.HALF_FLOAT=1212,n.HALF_FLOAT_OES=1213,n.UNSIGNED_SHORT_5_6_5=1214,n.UNSIGNED_SHORT_4_4_4_4=1215,n.UNSIGNED_SHORT_5_5_5_1=1216,n.UNSIGNED_INT_24_8_WEBGL=1217,e.TextureDataType=n;class _{static GetValue(t,e){switch(e){case _.TEXTURE_2D:return t.TEXTURE_2D;case _.TEXTURE_2D_ARRAY:return t.TEXTURE_2D_ARRAY;case _.TEXTURE_CUBE:return t.TEXTURE_CUBE_MAP;case _.TEXTURE_3D:return t.TEXTURE_3D;default:break}return t.TEXTURE_2D}}_.TEXTURE_2D=20,_.TEXTURE_2D_ARRAY=22,_.TEXTURE_SHADOW_2D=23,_.TEXTURE_CUBE=25,_.TEXTURE_3D=30,e.TextureTarget=_,function(t){t[t["Default"]=0]="Default",t[t["Depth"]=1]="Depth",t[t["Wrapper"]=2]="Wrapper",t[t["RTT"]=3]="RTT",t[t["Image"]=4]="Image",t[t["Float"]=5]="Float",t[t["Uint16"]=6]="Uint16",t[t["FloatCube"]=7]="FloatCube",t[t["Bytes"]=8]="Bytes",t[t["BytesCube"]=9]="BytesCube",t[t["ImageCube"]=10]="ImageCube",t[t["Texture3D"]=11]="Texture3D"}(e.TextureProxyType||(e.TextureProxyType={}));class l{static GetConst(t,e){switch(e){case l.NEAREST:return t.NEAREST;case l.LINEAR:return t.LINEAR;case l.LINEAR_MIPMAP_LINEAR:return t.LINEAR_MIPMAP_LINEAR;case l.NEAREST_MIPMAP_NEAREST:return t.NEAREST_MIPMAP_NEAREST;case l.LINEAR_MIPMAP_NEAREST:return t.LINEAR_MIPMAP_NEAREST;case l.NEAREST_MIPMAP_LINEAR:return t.NEAREST_MIPMAP_LINEAR;case l.WRAP_REPEAT:return t.REPEAT;case l.WRAP_CLAMP_TO_EDGE:return t.CLAMP_TO_EDGE;case l.WRAP_MIRRORED_REPEAT:return t.MIRRORED_REPEAT;default:break}return-1}}l.WRAP_REPEAT=3001,l.WRAP_CLAMP_TO_EDGE=3002,l.WRAP_MIRRORED_REPEAT=3003,l.NEAREST=4001,l.LINEAR=4002,l.LINEAR_MIPMAP_LINEAR=4003,l.NEAREST_MIPMAP_NEAREST=4004,l.LINEAR_MIPMAP_NEAREST=4005,l.NEAREST_MIPMAP_LINEAR=4006,e.TextureConst=l},"8def":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("919c"));class a extends r.default{constructor(){super(),this.shdp=null,this.vbufs=null,this.vbuf=null,this.attribTypes=null,this.wholeOffsetList=null,this.attribTypesLen=0,this.updateUnlocked=!0,this.wholeStride=0,this.A=a.B_O++}run(){this.U_.testVROUid(this.A)&&(null!=this.vbuf?this.U_.useVtxAttribsPtrTypeFloat(this.shdp,this.vbuf,this.attribTypes,this.attribTypesLen,this.wholeOffsetList,this.wholeStride):this.U_.useVtxAttribsPtrTypeFloatMulti(this.shdp,this.vbufs,this.attribTypes,this.attribTypesLen,this.wholeOffsetList,this.wholeStride),this.U_.testRIOUid(this.A_B)&&this.U_.bindEleBuf(this.ibuf))}__$destroy(){r.default.B_w.delete(this.BP),this.BP=0,this.A_B=-1,this.U_=null,this.shdp=null,this.vbufs=null,this.vbuf=null,this.ibuf=null,this.attribTypes=null,this.attribTypesLen=0,this.wholeStride=0}restoreThis(){a.Restore(this)}toString(){return"VertexRenderObj(uid = "+this.A+", type="+this.BP+")"}static HasMid(t){return r.default.B_w.has(t)}static GetByMid(t){return r.default.B_w.get(t)}static GetFreeId(){return a.B_x.length>0?a.B_x.pop():-1}static Create(t,e,i){let s=null,h=a.GetFreeId();return h>=0?(s=a.B_y[h],a.B_z[h]=a.S_FLAG_BUSY,s.setMidAndBufUid(e,i)):(s=new a,s.setMidAndBufUid(e,i),a.B_y.push(s),a.B_z.push(a.S_FLAG_BUSY),a.B_0++),s.setRC(t),r.default.B_w.set(e,s),s}static Restore(t){if(null!=t&&t.BQ<1&&a.B_z[t.getUid()]==a.S_FLAG_BUSY){let e=t.getUid();a.B_x.push(e),a.B_z[e]=a.S_FLAG_FREE,t.__$destroy()}}}a.B_O=0,a.S_FLAG_BUSY=1,a.S_FLAG_FREE=0,a.B_z=[],a.B_0=0,a.B_y=[],a.B_x=[],e.default=a},"8e17":function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("6e01"));class a{constructor(t=0,e=0,i=0,s=1){this.x=0,this.y=0,this.z=0,this.w=0,this.x=t,this.y=e,this.z=i,this.w=s}clone(){return new a(this.x,this.y,this.z,this.w)}setTo(t,e,i,s=1){this.x=t,this.y=e,this.z=i,this.w=s}setXYZ(t,e,i){this.x=t,this.y=e,this.z=i}copyFrom(t){this.x=t.x,this.y=t.y,this.z=t.z}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}multBy(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);t>r.default.MATH_MIN_POSITIVE&&(this.x/=t,this.y/=t,this.z/=t)}normalizeTo(t){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);e>r.default.MATH_MIN_POSITIVE?(t.x=this.x/e,t.y=this.y/e,t.z=this.z/e):(t.x=this.x,t.y=this.y,t.z=this.z)}scaleVector(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}scaleBy(t){this.x*=t,this.y*=t,this.z*=t}negate(){this.x=-this.x,this.y=-this.y,this.z=-this.z}equalsXYZ(t){return Math.abs(this.x-t.x)<r.default.MATH_MIN_POSITIVE&&Math.abs(this.y-t.y)<r.default.MATH_MIN_POSITIVE&&Math.abs(this.z-t.z)<r.default.MATH_MIN_POSITIVE}equalsAll(t){return Math.abs(this.x-t.x)<r.default.MATH_MIN_POSITIVE&&Math.abs(this.y-t.y)<r.default.MATH_MIN_POSITIVE&&Math.abs(this.z-t.z)<r.default.MATH_MIN_POSITIVE&&Math.abs(this.w-t.w)<r.default.MATH_MIN_POSITIVE}project(){let t=1/this.w;this.x*=t,this.y*=t,this.z*=t}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}getLengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}addBy(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}subtractBy(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}subtract(t){return new a(this.x-t.x,this.y-t.y,this.z-t.z)}add(t){return new a(this.x+t.x,this.y+t.y,this.z+t.z)}crossProduct(t){return new a(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}crossBy(t){let e=this.y*t.z-this.z*t.y,i=this.z*t.x-this.x*t.z,s=this.x*t.y-this.y*t.x;this.x=e,this.y=i,this.z=s}reflectBy(t){let e=2*(this.x*t.x+this.y*t.y+this.z*t.z);this.x=this.x-e*t.x,this.y=this.y-e*t.y,this.z=this.z-e*t.z}scaleVecTo(t,e){this.x=t.x*e,this.y=t.y*e,this.z=t.z*e}subVecsTo(t,e){this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z}addVecsTo(t,e){this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z}crossVecsTo(t,e){this.x=t.y*e.z-t.z*e.y,this.y=t.z*e.x-t.x*e.z,this.z=t.x*e.y-t.y*e.x}toString(){return"Vector3D("+this.x+this.y+this.z+")"}static Cross(t,e,i){i.x=t.y*e.z-t.z*e.y,i.y=t.z*e.x-t.x*e.z,i.z=t.x*e.y-t.y*e.x}static CrossSubtract(t,e,i,s,r){a.__vtor3Stv0.x=e.x-t.x,a.__vtor3Stv0.y=e.y-t.y,a.__vtor3Stv0.z=e.z-t.z,a.__vtor3Stv1.x=s.x-i.x,a.__vtor3Stv1.y=s.y-i.y,a.__vtor3Stv1.z=s.z-i.z,t=a.__vtor3Stv0,i=a.__vtor3Stv1,r.x=t.y*i.z-t.z*i.y,r.y=t.z*i.x-t.x*i.z,r.z=t.x*i.y-t.y*i.x}static Subtract(t,e,i){i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z}static DistanceSquared(t,e){return a.__vtor3Stv0.x=t.x-e.x,a.__vtor3Stv0.y=t.y-e.y,a.__vtor3Stv0.z=t.z-e.z,a.__vtor3Stv0.getLengthSquared()}static DistanceXYZ(t,e,i,s,r,h){return a.__vtor3Stv0.x=t-s,a.__vtor3Stv0.y=e-r,a.__vtor3Stv0.z=i-h,a.__vtor3Stv0.getLength()}static Distance(t,e){return a.__vtor3Stv0.x=t.x-e.x,a.__vtor3Stv0.y=t.y-e.y,a.__vtor3Stv0.z=t.z-e.z,a.__vtor3Stv0.getLength()}static AngleBetween(t,e){return t.normalizeTo(a.__vtor3Stv0),e.normalizeTo(a.__vtor3Stv1),Math.acos(a.__vtor3Stv0.dot(a.__vtor3Stv1))*r.default.MATH_180_OVER_PI}static RadianBetween(t,e){return t.normalizeTo(a.__vtor3Stv0),e.normalizeTo(a.__vtor3Stv1),Math.acos(a.__vtor3Stv0.dot(a.__vtor3Stv1))}static RadianBetween2(t,e){let i=t.getLengthSquared(),s=e.getLengthSquared();return a.__vtor3Stv0.x=t.x-e.x,a.__vtor3Stv0.y=t.y-e.y,a.__vtor3Stv0.z=t.z-e.z,Math.acos((i+s-a.__vtor3Stv0.getLengthSquared())/(2*Math.sqrt(i)*Math.sqrt(s)))}static Reflect(t,e,i){let s=2*(t.x*e.x+t.y*e.y+t.z*e.z);i.x=t.x-s*e.x,i.y=t.y-s*e.y,i.z=t.z-s*e.z}}a.X_AXIS=new a(1,0,0),a.Y_AXIS=new a(0,1,0),a.Z_AXIS=new a(0,0,1),a.__vtor3Stv0=new a,a.__vtor3Stv1=new a,a.ZERO=new a,e.default=a},9156:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static SetTransUniform(t,e){s.B_1.set(t.getUid(),e)}static GetTransUniform(t){if(t.getUid()<0)throw Error("mat.getUid() < 0");return s.B_1.has(t.getUid())?s.B_1.get(t.getUid()):null}static HasTransUniform(t){return s.B_1.has(t.getUid())}static RemoveTransUniform(t){s.B_1.delete(t.getUid())}}s.B_1=new Map,e.default=s},"919c":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.A=0,this.BP=0,this.A_B=0,this.U_=null,this.indicesRes=null,this.ibuf=null,this.ibufStep=2,this.BQ=0}getVTCount(){return null!=this.indicesRes?this.indicesRes.getVTCount():0}setRC(t){this.U_=t}setMidAndBufUid(t,e){this.BP=t,this.A_B=e,this.BQ=0}getUid(){return this.A}getVtxUid(){return this.A_B}getMid(){return this.BP}run(){}__$attachThis(){++this.BQ}__$detachThis(){--this.BQ,this.BQ<1&&(this.BQ=0)}__$destroy(){s.B_w.delete(this.BP),this.BP=0,this.A_B=-1,this.ibuf=null,this.U_=null,this.indicesRes=null}restoreThis(){}static HasMid(t){return s.B_w.has(t)}static GetByMid(t){return s.B_w.get(t)}}s.B_w=new Map,e.default=s},"984e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.waitDelTimes=0,this.rcuid=0,this.resUid=0,this.width=0,this.height=0,this.depth=0,this.sampler=0,this.texBuf=null,this.BQ=0}__$attachThis(){++this.BQ}__$detachThis(){--this.BQ,this.BQ<1&&(this.BQ=0)}bindToGpu(t){t.bindTexture(this.sampler,this.texBuf)}getAttachCount(){return this.BQ}}class r{constructor(t,e){this.A_q=new Map,this.A_r=new Map,this.BR=0,this.A_u=0,this.A_v=128,this.k=0,this.J=null,this.texMid=-1,this.unlocked=!0,this.k=t,this.J=e}createBuf(){return this.J.createTexture()}createResByParams3(t,e,i,r){if(!this.A_q.has(t)){let a=new s;return a.rcuid=this.getRCUid(),a.resUid=t,a.width=e,a.height=i,a.sampler=r,a.texBuf=this.createBuf(),a.texBuf.resUid=t,this.addTextureRes(a),!0}return!1}getRCUid(){return this.k}getRC(){return this.J}hasResUid(t){return this.A_q.has(t)}renderBegin(){this.texMid=-1}getTextureResTotal(){return this.BR}addTextureRes(t){this.A_q.has(t.resUid)||(t.waitDelTimes=0,this.A_q.set(t.resUid,t),this.BR++)}getGpuBuffer(t){return this.A_q.has(t)?this.A_q.get(t).texBuf:null}bindToGpu(t){this.A_q.has(t)&&this.A_q.get(t).bindToGpu(this.J)}getAttachTotal(){return this.A_u}__$attachRes(t){if(this.A_q.has(t)){this.A_u++;let e=this.A_q.get(t);e.getAttachCount()<1&&this.A_r.has(t)&&this.A_r.delete(t),e.waitDelTimes=0,e.__$attachThis()}}__$detachRes(t){if(this.A_q.has(t)&&this.A_q.has(t)){let e=this.A_q.get(t);e.getAttachCount()>0&&(this.A_u--,e.__$detachThis(),e.getAttachCount()<1&&this.A_r.set(t,e))}}update(){if(this.A_v--,this.A_v<1){this.A_v=128;for(const[t,e]of this.A_r)e.waitDelTimes++,e.waitDelTimes>5&&(this.A_q.delete(e.resUid),this.A_r.delete(e.resUid),this.J.deleteTexture(e.texBuf),e.texBuf=null,this.BR--)}}}e.default=r},"9b81":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("45db"),r=i("8ae4");class a{constructor(){this.version=-1,this.waitDelTimes=0,this.rcuid=0,this.resUid=0,this.vertex=new s.ROVertexRes,this.indices=new r.ROIndicesRes,this.BQ=0}__$attachThis(){++this.BQ}__$detachThis(){--this.BQ,this.BQ<1&&(this.BQ=0)}getAttachCount(){return this.BQ}createVRO(t,e,i){let s=this.vertex.createVRO(t,e,i,this.indices,this.indices.getUid());return s.ibufStep=this.indices.ibufStep,s}updateToGpu(t){this.indices.updateToGpu(t),this.vertex.updateToGpu(t)}destroy(t){this.getAttachCount()<1&&this.resUid>=0&&(this.vertex.destroy(t),this.indices.destroy(t),this.resUid=-1)}}e.GpuVtxObect=a},a7ed:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("ab73")),a=s(i("7279"));class h{create(t,e){let i=null,s=r.default.FrustumParam;return e.hasUniformByName(s.name)&&(i=new a.default,i.uns=s.name,i.uniformNameList=[s.name],i.copyDataFromProbe(t.getCamera().ufrustumProbe)),i}getIDNS(){return"FrustumUniformBuilder"}}e.default=h},ab73:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.type="vec4",this.data=null,this.name="u_vsmParams",this.arrayLength=3}}class r{constructor(){this.type="vec4",this.data=new Float32Array([.1,.1,.1,1,1,.1,600,3500,.3,0,.9,5e-4,0,0,800,800]),this.name="u_envLightParams",this.arrayLength=4}}class a{constructor(){this.type="mat4",this.data=null,this.name="u_shadowMat",this.arrayLength=0}}class h{constructor(){this.type="vec4",this.data=null,this.name="u_stageParam",this.arrayLength=0}}class n{constructor(){this.type="vec4",this.data=null,this.name="u_viewParam",this.arrayLength=0}}class _{constructor(){this.type="vec4",this.data=null,this.name="u_frustumParam",this.arrayLength=0}}class l{constructor(){this.type="vec4",this.data=null,this.name="u_cameraPosition",this.arrayLength=0}}class o{constructor(){this.type="vec4",this.positionName="u_lightPositions",this.colorName="u_lightColors"}}class m{}m.LocalTransformMatUNS="u_objMat",m.CameraViewMatUNS="u_viewMat",m.CameraProjectiveMatUNS="u_projMat",m.FrustumParam=new _,m.CameraPosParam=new l,m.StageParam=new h,m.ViewportParam=new n,m.ShadowMatrix=new a,m.ShadowVSMParams=new s,m.GlobalLight=new o,m.EnvLightParams=new r,e.default=m},b02c:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("6e01"));class a{constructor(t,e){this.A=-1,this.BP=-1,this.Y_=0,this.BS=null,this.BT=null,this.BU=null,this.k=0,this.AK=null,this.direct=!0,this.BQ=0,this.k=t,this.A=a.B_O++,this.BP=e}__$setParam(t,e){this.k=t,this.BP=e}getRCUid(){return this.k}getMid(){return this.BP}getTexTotal(){return this.Y_}collectTexList(t,e,i){this.AK=t;let s=0;if(this.direct)if(this.Y_<1&&e.length>0){let a,h=r.default.GetNearestCeilPow2(e.length);this.BT=new Uint16Array(h),this.BS=new Array(h),this.BU=e;while(s<i)a=e[s],a.__$attachThis(),a.__$$upload(t),this.BT[s]=a.getSampler(),this.BS[s]=this.AK.getGpuBuffer(a.getResUid()),this.AK.__$attachRes(a.getResUid()),s++;this.Y_=s}else this.Y_=0;else this.Y_=i;while(s<e.length)e[s++].__$attachThis()}run(){if(this.AK.unlocked&&this.AK.texMid!=this.BP){this.AK.texMid=this.BP;let t=this.AK.getRC(),e=t.TEXTURE0;if(this.direct)for(let i=0;i<this.Y_;++i)t.activeTexture(e++),t.bindTexture(this.BT[i],this.BS[i]);else{let i=this.BU;for(let s=0;s<this.Y_;++s)t.activeTexture(e++),i[s].__$$use(this.AK)}}}getUid(){return this.A}__$attachThis(){++this.BQ}__$detachThis(){--this.BQ,this.BQ<1&&(this.BQ=0,a.Restore(this))}reset(){if(null!=this.BU)for(let t=0,e=this.BU.length;t<e;++t)this.BU[t].__$detachThis(),this.AK.__$detachRes(this.BU[t].getResUid()),this.BS[t]=null;this.Y_=0,this.BU=null,this.AK=null}toString(){return"TextureRenderObj(uid = "+this.A+", mid="+this.BP+")"}static Create(t,e,i){let s=e.length;if(s>0&&i>0){if(s<i)throw Error("There are fewer textures than in the shader : (need "+i+",but only have "+s+") !!!");let r=31,h=0,n=!0;while(h<i)r=131*r+e[h].getUid(),e[h].isDirect()||(n=!1),++h;let _=a.B_3[t.getRCUid()],l=null;return _.has(r)?l=_.get(r):(l=a.B_2.length<1?new a(t.getRCUid(),r):a.B_2.pop(),l.collectTexList(t,e,i),_.set(r,l)),l.__$setParam(t.getRCUid(),r),l.direct=n,l}return null}static Restore(t){t.getMid()>-1&&(a.B_3[t.getRCUid()].delete(t.getMid()),t.__$setParam(0,0),a.B_2.push(t),t.reset())}static GetByMid(t,e){return a.B_3[t].get(e)}}a.B_O=0,a.B_3=[new Map,new Map,new Map,new Map,new Map,new Map,new Map,new Map],a.B_2=[],a.B_4=!0,a.B_5=-1,e.TextureRenderObj=a;class h{constructor(t){this.AK=null,this.AK=t}run(){this.AK.renderBegin()}getMid(){return 1}__$attachThis(){}__$detachThis(){}}e.EmptyTexRenderObj=h,e.default=a},b0ef:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.D=null,this.C=null,this.BV=-1,this.BW=-1,this.resized=!0}setDiv(t){this.C=t}createViewEle(t,e){null==this.C&&(this.C=document.getElementById("voxEngineDiv")),null==this.C&&(this.C=t.createElement("div"),this.C.style.width="400px",this.C.style.height="300px",document.body.appendChild(this.C)),this.C.style.display="bolck",this.C.style.position="absolute",""==this.C.style.left&&(this.C.style.left="0px",this.C.style.top="0px"),e&&(this.C.style.width="100%",this.C.style.height="100%"),null==this.D&&(this.D=document.createElement("canvas"),this.C.appendChild(this.D),this.D.width=800,this.D.height=600,this.D.style.display="bolck",this.D.style.left="0px",this.D.style.top="0px",this.D.style.position="absolute")}setDivStyleLeftAndTop(t,e){this.C.style.left=t+"px",this.C.style.top=e+"px"}setDivStyleSize(t,e){this.BV==t&&this.BW==e||(this.C.style.width=t+"px",this.C.style.height=e+"px",this.resized=!0)}getDiv(){return this.C}getCanvas(){return this.D}}e.default=s},b30a:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("3b73")),a=s(i("644c")),h=s(i("20ef"));class n{constructor(t,e,i){this.BX=new Map,this.BY=[],this.BZ=0,this.Ba=[],this.Bb=!0,this.Bc=!1,this.Bd=-1,this.Be=null,this.Bf=1,this.k=-1,this.U_=null,this.Bg=null,this.e=null,this.Bh=null,this.Bi=null,this.Bj=null,this.drawFlag=-1,this.__$globalUniform=null,this.k=t,this.e=i,this.U_=e}createResByParams3(t,e,i,s){return!1}getRC(){return this.U_}getGPUProgram(){return this.Bg}getRCUid(){return this.k}useTransUniform(t){this.Bj!=t&&(this.Bj=t,t.use(this))}useUniform(t){this.Bi!=t&&(this.Bi=t,t.use(this))}updateUniform(t){null!=t&&t.use(this)}create(t){let e=t.getUniqueShaderName();if(this.BX.has(e))return this.BX.get(e);let i=new h.default(this.BZ);return i.setShdData(t),this.BY[i.getUid()]=i,this.Ba[i.getUid()]=null,++this.BZ,this.BX.set(e,i),r.default.SHADERCODE_TRACE_ENABLED,i}findShdProgramByUid(t){return this.BY[t]}findShdProgram(t){return this.BX.has(t)?this.BX.get(t):null}findShdProgramByShdData(t){return null!=t&&this.BX.has(t.getUniqueShaderName())?this.BX.get(t.getUniqueShaderName()):null}unlock(){this.Bb=!0,this.__$globalUniform=null}isUnLocked(){return this.Bb}lock(){this.Bb=!1}textureUnlock(){this.Bc=!0}isTextureUnLocked(){return this.Bc}textureLock(){this.Bc=!1}setSharedUniformByShd(t,e){this.Ba[t.getUid()]=e}getSharedUniformByShd(t){return this.Ba[t.getUid()]}getCurrFragOutputTotal(){return this.Bf}hasResUid(t){return null!=this.BY[t]}bindToGpu(t){if(this.Bb&&t>-1&&t<this.BZ)if(this.Bd!=t){this.Bd=t;let e=this.BY[t];this.Bf=e.getFragOutputTotal(),this.Bf,this.getActiveAttachmentTotal(),this.Bg=e.getGPUProgram(),this.U_.useProgram(this.Bg),e.useTexLocation();let i=this.Ba[e.getUid()];this.Bh=i;while(null!=i)i.use(this),i=i.next;this.Be=e}else if(null==this.Bh&&null!=this.Be){let t=this.Ba[this.Be.getUid()];this.Bh=t;while(null!=t)t.use(this),t=t.next}}getGpuBuffer(t){return null}getCurrentShd(){return this.Be}getCurrentShdUid(){return this.Bd}resetUniform(){this.Bi=null,this.Bj=null,this.Bh=null}renderBegin(){this.Bf=1,this.Bd=-1,this.Be=null,this.drawFlag=-1}update(){}destroy(){this.U_=null,this.e=null}useUniformToCurrentShd(t){this.Bi!=t&&(this.Bi,t.useByShd(this,this.Be))}useUniform2ToCurrentShd(t,e){this.Bi!=t&&(this.Bi,t.useByShd(this,this.Be)),this.Bj!=e&&(this.Bj,e.useByShd(this,this.Be))}useUniformMat4(t,e){this.U_.uniformMatrix4fv(t,!1,e)}useUniformV2(t,e,i,s,r){switch(e){case a.default.SHADER_MAT4:r<1?this.U_.uniformMatrix4fv(t,!1,i):this.U_.uniformMatrix4fv(t,!1,i,r,16*s);break;case a.default.SHADER_MAT3:this.U_.uniformMatrix3fv(t,!1,i,0,9*s);break;case a.default.SHADER_VEC4FV:this.U_.uniform4fv(t,i,r,4*s);break;case a.default.SHADER_VEC3FV:this.U_.uniform3fv(t,i,r,3*s);break;case a.default.SHADER_VEC4:this.U_.uniform4f(t,i[0],i[1],i[2],i[3]);break;case a.default.SHADER_VEC3:this.U_.uniform3f(t,i[0],i[1],i[2]);break;case a.default.SHADER_VEC2:this.U_.uniform2f(t,i[0],i[1]);break;default:break}}useUniformV1(t,e,i,s){switch(e){case a.default.SHADER_MAT4:this.U_.uniformMatrix4fv(t,!1,i);break;case a.default.SHADER_MAT3:this.U_.uniformMatrix3fv(t,!1,i);break;case a.default.SHADER_VEC4FV:this.U_.uniform4fv(t,i,4*s);break;case a.default.SHADER_VEC3FV:this.U_.uniform3fv(t,i,3*s);break;case a.default.SHADER_VEC4:this.U_.uniform4f(t,i[0],i[1],i[2],i[3]);break;case a.default.SHADER_VEC3:this.U_.uniform3f(t,i[0],i[1],i[2]);break;case a.default.SHADER_VEC2:this.U_.uniform2f(t,i[0],i[1]);break;default:break}}getActiveAttachmentTotal(){return this.e.getActiveAttachmentTotal()}}e.default=n},b88e:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i("5b1e");document.title="Vox APP";let r=new s.DemoEmptyRenderer,a=r;if(void 0!=a.runBegin){function h(){function t(e){a.runBegin(),a.run(),a.runEnd(),window.requestAnimationFrame(t)}a.initialize(),window.requestAnimationFrame(t)}h()}else{function n(){function t(e){r.run(),window.requestAnimationFrame(t)}r.initialize(),window.requestAnimationFrame(t)}n()}},baae:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{}s.FRAMEBUFFER=71,s.DRAW_FRAMEBUFFER=72,s.READ_FRAMEBUFFER=73,e.default=s},c497:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("8e17"));class a{constructor(t=null){this.Bk=8192,this.Bl=null,this.Bm={depth:!0,premultipliedAlpha:!1,alpha:!0,antialias:!1,stencil:!1,preserveDrawingBuffer:!0,powerPreference:"high-performance"},this.Bn=20,this.Bo=!0,this.Bp=!1,this.autoSyncRenderBufferAndWindowSize=!0,this.maxWebGLVersion=2,this.cameraPerspectiveEnabled=!0,this.evtFlowEnabled=!1,this.camProjParam=new r.default(45,10,5e3),this.camPosition=new r.default(2e3,2e3,2e3),this.camLookAtPos=new r.default(0,0,0),this.camUpDirect=new r.default(0,1,0),this.batchEnabled=!0,this.processFixedState=!1,this.Bl=t,this.autoSyncRenderBufferAndWindowSize=null==t}setTickUpdateTime(t){t=Math.round(t),this.Bn=t>5?t:5}getTickUpdateTime(){return this.Bn}setPolygonOffsetEanbled(t){this.Bo=t}getPolygonOffsetEanbled(){return this.Bo}setDitherEanbled(t){this.Bp=t}getDitherEanbled(){return this.Bp}getDiv(){return this.Bl}getRenderContextAttri(){return this.Bm}setAttriDepth(t){this.Bm.depth=t}setAttriStencil(t){this.Bm.stencil=t}setAttriAlpha(t){this.Bm.alpha=t}setAttriPremultipliedAlpha(t){this.Bm.premultipliedAlpha=t}setAttriAntialias(t){this.Bm.antialias=t}setAttripreserveDrawingBuffer(t){this.Bm.preserveDrawingBuffer=t}setAttriHightPowerPreference(t){this.Bm.powerPreference=t?"high-performance":"default"}setMatrix4AllocateSize(t){t<1024&&(t=1024),this.Bk=t}getMatrix4AllocateSize(){return this.Bk}setCamProject(t,e,i){if(e>=i)throw Error("Error Camera cear > far !!!");this.camProjParam.setTo(t,e,i)}setCamPosition(t,e,i){this.camPosition.setTo(t,e,i)}setCamLookAtPos(t,e,i){this.camLookAtPos.setTo(t,e,i)}setCamUpDirect(t,e,i){this.camUpDirect.setTo(t,e,i)}}e.default=a},c62b:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i("e08e"),a=i("7c63"),h=s(i("29ef"));class n{constructor(){this.uid=-1,this.value=-1,this.__$rpuid=-1,this.__$rprouid=-1,this.shader=null,this.pos=null,this.bounds=null,this.ibufType=0,this.ibufStep=2,this.ivsIndex=0,this.ivsCount=0,this.insCount=0,this.drawOffset=0,this.partTotal=0,this.partGroup=null,this.trisNumber=0,this.visible=!0,this.drawEnabled=!0,this.drawMode=0,this.renderState=0,this.rcolorMask=0,this.drawFlag=0,this.vro=null,this.transUniform=null,this.uniform=null,this.shdUid=-1,this.vtxUid=-1,this.tro=null,this.texMid=-1,this.ubo=null}testDrawFlag(){this.shader.drawFlag!=this.drawFlag&&(this.shader.drawFlag=this.drawFlag,a.RenderStateObject.UseRenderState(this.renderState),a.RenderColorMask.UseRenderState(this.rcolorMask))}getUid(){return this.uid}getRPOUid(){return this.__$rpuid}getRPROUid(){return this.__$rprouid}getShaderUid(){return this.shdUid}setIvsParam(t,e){this.ivsIndex=t,this.ivsCount=e,this.drawOffset=t*this.ibufStep,this.drawEnabled=this.visible&&this.ivsCount>0}setVisible(t){this.visible=t,this.drawEnabled=t&&this.ivsCount>0}setDrawFlag(t,e){this.renderState=t,this.rcolorMask=e,this.drawFlag=(e<<10)+t}drawThis(t){++h.default.DrawCallTimes,h.default.DrawTrisNumber+=this.trisNumber;let e=this.indicesRes.getVTCount();switch(this.ivsCount<=e&&(e=this.ivsCount),this.drawMode){case r.RenderDrawMode.ELEMENTS_TRIANGLES:t.RContext.drawElements(t.TRIANGLES,e,this.ibufType,this.drawOffset);break;case r.RenderDrawMode.ELEMENTS_LINES:t.RContext.drawElements(t.LINES,e,this.ibufType,this.drawOffset);break;case r.RenderDrawMode.ELEMENTS_TRIANGLE_STRIP:t.RContext.drawElements(t.TRIANGLE_STRIP,e,this.ibufType,this.drawOffset);break;case r.RenderDrawMode.ELEMENTS_INSTANCED_TRIANGLES:t.RContext.drawElementsInstanced(t.TRIANGLES,e,this.ibufType,this.drawOffset,this.insCount);break;case r.RenderDrawMode.ELEMENTS_TRIANGLE_FAN:t.RContext.drawElements(t.TRIANGLE_FAN,e,this.ibufType,this.drawOffset);break;case r.RenderDrawMode.ARRAYS_LINES:t.RContext.drawArrays(t.LINES,this.ivsIndex,this.ivsCount);break;case r.RenderDrawMode.ARRAYS_LINE_STRIP:t.RContext.drawArrays(t.LINE_STRIP,this.ivsIndex,this.ivsCount);break;default:break}}drawPart(t){++h.default.DrawCallTimes,h.default.DrawTrisNumber+=this.trisNumber;let e=0,i=t.RContext;switch(this.drawMode){case r.RenderDrawMode.ELEMENTS_TRIANGLES:for(;e<this.partTotal;)i.drawElements(t.TRIANGLES,this.partGroup[e++],this.ibufType,this.partGroup[e++]);break;case r.RenderDrawMode.ELEMENTS_LINES:for(;e<this.partTotal;)i.drawElements(t.LINES,this.partGroup[e++],this.ibufType,this.partGroup[e++]);break;case r.RenderDrawMode.ELEMENTS_TRIANGLE_STRIP:i.drawElements(t.TRIANGLE_STRIP,this.ivsCount,this.ibufType,this.drawOffset);break;case r.RenderDrawMode.ELEMENTS_INSTANCED_TRIANGLES:i.drawElementsInstanced(t.TRIANGLES,this.ivsCount,this.ibufType,this.drawOffset,this.insCount);break;case r.RenderDrawMode.ELEMENTS_TRIANGLE_FAN:i.drawElements(t.TRIANGLE_FAN,this.ivsCount,this.ibufType,this.drawOffset);break;case r.RenderDrawMode.ARRAYS_LINES:i.drawArrays(t.LINES,this.ivsIndex,this.ivsCount);break;case r.RenderDrawMode.ARRAYS_LINE_STRIP:i.drawArrays(t.LINE_STRIP,this.ivsIndex,this.ivsCount);break;default:break}}run2(t){null!=this.ubo&&this.ubo.run(t),this.shader.useTransUniform(this.transUniform),this.shader.useUniform(this.uniform),this.testDrawFlag()}run(t){null!=this.ubo&&this.ubo.run(t),this.vro.run(),this.tro.run(),this.shader.useTransUniform(this.transUniform),this.shader.useUniform(this.uniform),this.testDrawFlag()}runLockMaterial2(t){this.testDrawFlag(),this.shader.useUniform2ToCurrentShd(null==t?this.uniform:t,this.transUniform)}runLockMaterial(){this.vro.run(),this.testDrawFlag(),this.shader.useUniform2ToCurrentShd(this.uniform,this.transUniform)}reset(){this.indicesRes=null,this.vro.__$detachThis(),this.vro=null,this.tro.__$detachThis(),this.tro=null,this.texMid=-1,this.__$rprouid=-1,this.ubo=null,this.shdUid=-1,this.vtxUid=-1,this.uniform=null,this.transUniform=null,this.partGroup=null,this.ivsIndex=0,this.ivsCount=0,this.insCount=0,this.partTotal=0,this.drawMode=0,this.drawFlag=0,this.renderState=0,this.rcolorMask=0,this.drawEnabled=!0,this.shader=null,this.bounds=null,this.pos=null}destroy(){this.reset()}toString(){return"[RPOUnit(uid = "+this.uid+")]"}}e.default=n},ca6c:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static PushThreeBitValueToInt(t,e){return(t<<3)+e}static PopThreeBitValueFromInt(t){return s.value=7&t,t>>3}static ContainsBit(t,e){return(e&t)>0}static RemoveBit(t,e){return~e&t}static AddBit(t,e){return e|t}static AssembleFromIntArray(t){let e=0,i=0,s=t.length;for(;e<s;++e)t[e]>0&&(i|=1<<e);return i}}s.BIT_ZERO=0,s.BIT_ONE_0=1,s.BIT_ONE_1=2,s.BIT_ONE_2=4,s.BIT_ONE_3=8,s.BIT_ONE_4=16,s.BIT_ONE_5=32,s.BIT_ONE_6=64,s.BIT_ONE_7=128,s.BIT_ONE_8=256,s.BIT_ONE_9=512,s.BIT_ONE_10=1024,s.BIT_ONE_11=2048,s.value=0,e.default=s},d53d:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.uns="",this.program=null,this.types=null,this.uniformSize=0,this.uniformNameList=null,this.locations=null,this.dataSizeList=null,this.dataList=null,this.calcModels=null,this.always=!0,this.next=null}getDataRefFromUniformName(t){if(null!=this.uniformNameList){let e=this.uniformNameList,i=e.length;for(let s=0;s<i;++s)if(t==e[s])return this.dataList[s]}return null}setDataRefFromUniformName(t,e){if(null!=this.uniformNameList){let i=this.uniformNameList,s=i.length;for(let r=0;r<s;++r)if(t==i[r]){this.dataList[r]=e;break}}}copyDataFromProbe(t){this.types=[],this.dataSizeList=[];for(let e=0;e<t.uniformsTotal;++e)this.types.push(t.uniformTypes[e]),this.dataSizeList.push(t.dataSizeList[e]);this.uniformSize=t.uniformsTotal}useByLocation(t,e,i,s){}useByShd(t,e){}use(t){}updateData(){}destroy(){}}e.ShaderUniform=s;class r extends s{constructor(){super()}use(t){let e=0;for(;e<this.uniformSize;++e)t.useUniformV1(this.locations[e],this.types[e],this.dataList[e],this.dataSizeList[e])}useByLocation(t,e,i,s){t.useUniformV1(i,e,this.dataList[s],this.dataSizeList[s])}useByShd(t,e){let i=0;for(;i<this.uniformSize;++i)t.useUniformV1(e.getUniformLocationByNS(this.uniformNameList[i]),this.types[i],this.dataList[i],this.dataSizeList[i])}updateData(){if(null!=this.calcModels){let t=this.calcModels.length,e=null;for(let i=0;i<t;++i)e=this.calcModels[i],e.buildData(),e.updateMaterialDataList(this.dataList),e.initializeParam()}}destroy(){let t=0,e=this.dataList.length;for(;t<e;++t)this.dataList[t]=null;if(null!=this.calcModels)for(e=this.calcModels.length,t=0;t<e;++t)this.calcModels[t].destroy(),this.calcModels[t]=null;this.dataList=null,this.types=null,this.locations=null,this.dataSizeList=null,this.calcModels=null}}e.ShaderUniformV1=r;class a extends s{constructor(){super()}use(t){let e=0;for(;e<this.uniformSize;++e)t.useUniformV2(this.locations[e],this.types[e],this.dataList[e],this.dataSizeList[e],0)}useByLocation(t,e,i,s){t.useUniformV2(i,e,this.dataList[s],this.dataSizeList[s],0)}useByShd(t,e){let i=0;for(;i<this.uniformSize;++i)t.useUniformV2(e.getUniformLocationByNS(this.uniformNameList[i]),this.types[i],this.dataList[i],this.dataSizeList[i],0)}updateData(){if(null!=this.calcModels){let t=this.calcModels.length,e=null;for(let i=0;i<t;++i)e=this.calcModels[i],e.buildData(),e.updateMaterialDataList(this.dataList),e.initializeParam()}}destroy(){let t=0,e=this.dataList.length;for(;t<e;++t)this.dataList[t]=null;if(null!=this.calcModels)for(e=this.calcModels.length,t=0;t<e;++t)this.calcModels[t].destroy(),this.calcModels[t]=null;this.dataList=null,this.types=null,this.locations=null,this.dataSizeList=null,this.calcModels=null,this.program=null}}e.ShaderUniformV2=a;class h extends s{constructor(){super()}use(t){t.useUniformMat4(this.locations[0],this.dataList[0])}useByLocation(t,e,i,s){t.useUniformMat4(i,this.dataList[0])}useByShd(t,e){t.useUniformMat4(e.getUniformLocationByNS(this.uniformNameList[0]),this.dataList[0])}destroy(){this.dataList[0]=null,this.dataList=null,this.types=null,this.locations=null,this.dataSizeList=null}}e.ShaderMat4Uniform=h,e.default=s},d958:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("11e6")),a=s(i("36cb")),h=s(i("c497")),n=s(i("3c81")),_=s(i("1e15")),l=s(i("0e01")),o=i("eca0"),m=s(i("442e")),d=s(i("1264"));class u{constructor(){this.___$$$$$$$Author="VilyLei(vily313@126.com)",this.A=-1,this.Bq=null,this.Br=[],this.Bs=0,this.Bt=[],this.Bu=0,this.f=null,this.e=null,this.L_=null,this.Bv=null,this.A8=!0,this.Bw=!0,this.K_=new o.RPOUnitBuilder,this.A6=new m.default,this.M_=new n.default,this.AI=null,this.Bx=null,this.By=null,this.A=u.B_O++,this.Bv=new l.default(this.A)}__$setStage3D(t){null!=t&&null==this.Bx&&(this.Bx=t)}getUid(){return this.A}getRCUid(){return this.A}getRPONodeBuilder(){return this.A6}getDataBuilder(){return this.L_}getRendererContext(){return this.Bv}getRenderProxy(){return null!=this.f||(this.f=this.Bv.getRenderProxy()),this.f}getStage3D(){return this.f.getStage3D()}getViewX(){return this.e.getViewportX()}getViewY(){return this.e.getViewportY()}getViewWidth(){return this.e.getViewportWidth()}getViewHeight(){return this.e.getViewportHeight()}getCamera(){return this.Bv.getCamera()}createCamera(){return null}useCamera(t,e=!1){}useMainCamera(){}updateCamera(){null!=this.f&&this.f.updateCamera()}initialize(t=null,e=null){null==this.L_&&null!=e&&(null==t&&(t=new h.default),this.A8=t.batchEnabled,this.Bw=t.processFixedState,this.f=this.Bv.getRenderProxy(),this.L_=new a.default,this.AI=new _.default,this.Bv.setCameraParam(t.camProjParam.x,t.camProjParam.y,t.camProjParam.z),this.Bv.initialize(t,e,this.Bx,this.L_,this.AI),this.e=this.f.getRenderAdapter(),this.A=this.f.getUid(),this.L_.initialize(this.f,this.K_,this.M_,this.AI),this.Bv.initManager(this.L_),this.Bq=new d.default(this.A,this.L_,this.K_,this.M_),this.By=this.createSeparatedProcess(),this.appendProcess(this.A8,this.Bw))}getRendererStatus(){return this.Bq.version}update(){this.f.Texture.update(),this.f.Vertex.update(),this.Bq.update()}updateAllProcess(){for(let t=0;t<this.Bs;++t)this.Br[t].update()}updateProcessAt(t){t>-1&&t<this.Bs&&this.Br[t].update()}setEntityManaListener(t){this.Bq.setListener(t)}addEntity(t,e=0,i=!0){null!=t&&t.__$testRendererEnabled()&&e>-1&&e<this.Bs&&this.Bq.addEntity(t,this.Br[e].getUid(),i)}addEntityToProcess(t,e,i=!0){null!=e&&null!=t&&t.__$testRendererEnabled()&&e.getRCUid()==this.A&&this.Bq.addEntity(t,e.getUid(),i)}moveEntityToProcessAt(t,e){if(null!=t&&t.getRendererUid()==this.A&&t.isRenderEnabled()&&e>-1&&e<this.Bs){let i=t.getDisplay().__$$runit.getRPROUid(),s=this.M_.getNodeByUid(i),a=this.Br[e];s!=a&&(s.removeDispUnit(t.getDisplay()),t.__$rseFlag=a.getSortEnabled()?r.default.AddSortEnabled(t.__$rseFlag):r.default.RemoveSortEnabled(t.__$rseFlag),a.addDisp(t.getDisplay()))}}moveEntityToProcess(t,e){if(null!=e&&null!=t&&t.getRendererUid()==this.A&&t.isRenderEnabled()){let i=t.getDisplay().__$$runit.getRPROUid(),s=this.M_.getNodeByUid(i);if(s!=e){let i=e;s.removeDispUnit(t.getDisplay()),t.__$rseFlag=e.getSortEnabled()?r.default.AddSortEnabled(t.__$rseFlag):r.default.RemoveSortEnabled(t.__$rseFlag),i.addDisp(t.getDisplay())}}}removeEntity(t){null!=t&&t.getRendererUid()==this.A&&(this.Bq.removeEntity(t),t.__$setRenderProxy(null))}removeEntityFromProcess(t,e){null!=e&&e.getRCUid()==this.A&&null!=t&&t.getRendererUid()==this.A&&(e.removeDisp(t.getDisplay()),t.__$setRenderProxy(null))}removeEntityByProcessIndex(t,e){e>=0&&e<this.Bs&&null!=t&&t.getRendererUid()==this.A&&(this.Br[e].removeDisp(t.getDisplay()),t.__$setRenderProxy(null))}setProcessSortEnabledAt(t,e){t>=0&&t<this.Bs&&this.Br[t].setSortEnabled(e)}setProcessSortEnabled(t,e){if(null!=t&&t.getRCUid()==this.A){let i=t;i.setSortEnabled(e)}}getRenderProcessAt(t){return this.Br[t]}appendProcess(t=!0,e=!1){this.M_.setCreateParams(this.L_.getRenderShader(),this.A6,this.K_,this.f.Vertex,t,e);let i=this.M_.create();return this.Br.push(i),i.setRendererParam(this.f,this.Bs),++this.Bs,i}createSeparatedProcess(t=!0,e=!1){this.M_.setCreateParams(this.L_.getRenderShader(),this.A6,this.K_,this.f.Vertex,t,e);let i=this.M_.create();return this.Bt.push(i),i.setRendererParam(this.f,this.Bu),i}setRendererProcessParam(t,e,i){t>-1&&t<this.Bs&&this.Br[t].setRenderParam(e,i)}getProcessAt(t){return t>-1&&t<this.Bs?this.Br[t]:null}showInfoAt(t){t>-1&&t<this.Bs&&this.Br[t].showInfo()}getProcessesTotal(){return this.Bs}updateMaterialUniformToCurrentShd(t){this.L_.getRenderShader().useUniformToCurrentShd(t.__$uniform)}drawEntityByLockMaterial(t,e=!1,i=!0){null!=t&&t.getVisible()&&t.getRendererUid()==this.A&&!this.f.isContextLost()&&this.By.drawLockMaterialByDisp(t.getDisplay(),e,i)}drawEntity(t,e=!1,i=!0){null!=t&&t.getVisible()&&!this.f.isContextLost()&&(t.getRendererUid()==this.A?this.By.drawDisp(t.getDisplay(),e,i):t.__$testRendererEnabled()&&this.Bq.addEntity(t,this.By.getUid(),!1))}runAt(t){this.f.isContextLost()||this.Br[t].run()}runProcess(t){t.getRCUid()!=this.A||this.f.isContextLost()||t.run()}runFromIndexTo(t){if(!this.f.isContextLost())for(let e=t;e<this.Bs;++e)this.Br[e].run()}run(){if(this.Bq.isHaveEntity()&&!this.f.isContextLost())for(let t=0;t<this.Bs;++t)this.Br[t].run()}getRenderUnitsTotal(){let t=0;for(let e=0;e<this.Bs;++e)t+=this.Br[e].getUnitsTotal();return t}renderflush(){this.f.flush()}toString(){return"[RendererInstance(uid = "+this.A+")]"}}u.B_O=0,e.RendererInstance=u,e.default=u},de9d:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("722e")),a=s(i("8333")),h=s(i("6e01")),n=s(i("8e17")),_=i("7c63"),l=s(i("090c")),o=s(i("1216")),m=s(i("56c5")),d=s(i("030e")),u=s(i("74c3")),c=s(i("984e")),f=s(i("29ef")),R=s(i("3077"));class p{constructor(t){this.RGBA=0,this.UNSIGNED_BYTE=0,this.TRIANGLE_STRIP=0,this.TRIANGLE_FAN=0,this.TRIANGLES=0,this.LINES=0,this.LINE_STRIP=0,this.UNSIGNED_SHORT=0,this.UNSIGNED_INT=0,this.COLOR=0,this.DEPTH=0,this.STENCIL=0,this.DEPTH_STENCIL=0,this.MAX=0,this.MIN=0,this.RContext=null,this.RState=null,this.Vertex=null,this.Texture=null,this.VtxBufUpdater=null,this.MaterialUpdater=null,this.adapter=null,this.A=0,this.Bz=null,this.e=null,this.B0=new l.default,this.U_=null,this.Ap=!0,this.L=0,this.M=0,this.Ad=800,this.Ae=600,this.h=.1,this.i=5e3,this.j=45,this.P=2,this.B1=2,this.B2=null,this.B3=!1,this.B4=!0,this.B5=!0,this.A=t}getRC(){return this.U_}getUid(){return this.A}getRCUid(){return this.A}isAutoSynViewAndStage(){return this.B4}enableSynViewAndStage(){this.B4=!0}lockViewport(){this.e.lockViewport()}unlockViewport(){this.e.unlockViewport()}getDiv(){return this.e.getDiv()}getCanvas(){return this.e.getCanvas()}cameraLock(){this.B2.lock()}cameraUnlock(){this.B2.unlock()}getCamera(){return this.B2}updateCamera(){return this.B2.update()}createCameraUBO(t){}updateCameraDataFromCamera(t){null!=t&&(this.B3||t!=this.B2)&&(this.B3=t!=this.B2,t.updateCamMatToUProbe(this.B2.matUProbe),null!=this.Bz&&(this.Bz.setSubDataArrAt(0,t.matUProbe.getFS32At(0)),this.Bz.setSubDataArrAt(16,t.matUProbe.getFS32At(1))))}useCameraData(){null!=this.Bz&&this.Bz.run()}getActiveAttachmentTotal(){return this.e.getActiveAttachmentTotal()}drawInstanced(t,e,i){2==this.B1?this.U_.drawElementsInstanced(this.TRIANGLES,t,this.UNSIGNED_SHORT,e,i):d.default.ANGLE_instanced_arrays.drawElementsInstancedANGLE(this.TRIANGLES,t,e,i)}createUBOBufferByBytesCount(t){let e=this.U_.createBuffer();return this.U_.bindBuffer(this.U_.UNIFORM_BUFFER,e),this.U_.bufferData(this.U_.UNIFORM_BUFFER,t,this.U_.DYNAMIC_DRAW),e}createUBOBufferByDataArray(t){let e=this.U_.createBuffer();return this.U_.bindBuffer(this.U_.UNIFORM_BUFFER,e),this.U_.bufferData(this.U_.UNIFORM_BUFFER,t,this.U_.DYNAMIC_DRAW),e}bindUBOBuffer(t){this.U_.bindBuffer(this.U_.UNIFORM_BUFFER,t)}deleteUBOBuffer(t){this.U_.deleteBuffer(t)}bufferDataUBOBuffer(t){this.U_.bufferData(this.U_.UNIFORM_BUFFER,t,this.U_.STATIC_DRAW)}bindBufferBaseUBOBuffer(t,e){this.U_.bindBufferBase(this.U_.UNIFORM_BUFFER,t,e)}setWebGLMaxVersion(t){1!=t&&2!=t||(this.P=t)}getContext(){return this.B0}getStage3D(){return this.B0.getStage()}getRenderAdapter(){return this.e}getRenderContext(){return this.e.getRenderContext()}setCameraParam(t,e,i){this.j=t,this.h=e,this.i=i}getMouseXYWorldRay(t,e){let i=this.B0.getStage();this.B2.getWorldPickingRayByScreenXY(i.mouseX,i.mouseY,t,e)}testViewPortChanged(t,e,i,s){return this.L!=t||this.M!=e||this.Ad!=i||this.Ae!=s}testRCViewPortChanged(t,e,i,s){return this.B0.testViewPortChanged(t,e,i,s)}getViewX(){return this.L}getViewY(){return this.M}getViewWidth(){return this.Ad}getViewHeight(){return this.Ae}setViewPort(t,e,i,s){this.B4=!1,this.L=t,this.M=e,this.Ad=i,this.Ae=s;let r=this.B0.getStage();null!=r&&(r.setViewPort(i,e,i,s),null!=this.B2&&(this.B2.setViewXY(this.L,this.M),this.B2.setViewSize(this.Ad,this.Ae))),this.B0.setViewport(this.L,this.M,this.Ad,this.Ae)}setRCViewPort(t,e,i,s,r=!1){this.B4=r,this.B0.setViewport(t,e,i,s)}reseizeRCViewPort(){this.e.unlockViewport(),this.e.reseizeViewPort()}resizeCallback(){this.B4&&(this.L=0,this.M=0,this.Ad=this.B0.getRCanvasWidth(),this.Ae=this.B0.getRCanvasHeight(),this.createMainCamera(),this.B0.setViewport(this.L,this.M,this.Ad,this.Ae),this.B2.setViewXY(this.L,this.M),this.B2.setViewSize(this.Ad,this.Ae))}createMainCamera(){this.B5&&(this.B5=!1,this.B2.uniformEnabled=!0,this.Ap?this.B2.perspectiveRH(h.default.DegreeToRadian(this.j),this.Ad/this.Ae,this.h,this.i):this.B2.orthoRH(this.h,this.i,-.5*this.Ae,.5*this.Ae,-.5*this.Ad,.5*this.Ad),this.B2.setViewXY(this.L,this.M),this.B2.setViewSize(this.Ad,this.Ae))}readPixels(t,e,i,s,r,a,h){this.e.readPixels(t,e,i,s,r,a,h)}getGLVersion(){return this.B1}initialize(t,e,i,s,h,_){if(null!=this.U_)return;this.B2=e,null==e.matUProbe&&(e.matUProbe=new R.default,e.matUProbe.bindSlotAt(this.A),e.matUProbe.addMat4Data(new Float32Array(16),1),e.matUProbe.addMat4Data(new Float32Array(16),1)),null==e.ufrustumProbe&&(e.ufrustumProbe=new R.default,e.ufrustumProbe.bindSlotAt(this.A),e.ufrustumProbe.addVec4Data(new Float32Array([e.getZNear(),e.getZFar(),.5*e.getNearPlaneWidth(),.5*e.getNearPlaneHeight()]),1)),null==e.ucameraPosProbe&&(e.ucameraPosProbe=new R.default,e.ucameraPosProbe.bindSlotAt(this.A),e.ucameraPosProbe.addVec4Data(new Float32Array([500,500,500,1]),1));let l=t.camPosition,p=t.camLookAtPos,E=t.camUpDirect;null==l&&(l=new n.default(500,500,500)),null==p&&(p=new n.default(0,0,0)),null==E&&(E=new n.default(0,1,0)),this.Ap=t.cameraPerspectiveEnabled,this.B0.autoSyncRenderBufferAndWindowSize=t.autoSyncRenderBufferAndWindowSize,this.B0.setResizeCallback(this,this.resizeCallback),this.B0.setWebGLMaxVersion(this.P),this.B0.initialize(this.A,i,t.getDiv(),t.getRenderContextAttri()),this.B1=this.B0.getWebGLVersion(),this.U_=this.B0.getRC(),f.default.Initialize(),f.default.Rstate.setRenderContext(this.B0);let g=this,T=this.U_,A=new u.default(this.A,T,_),S=new c.default(this.A,T);if(this.AJ=A,g.Vertex=A,g.Texture=S,g.MaterialUpdater=s,g.VtxBufUpdater=h,this.Ad=this.B0.getViewportWidth(),this.Ae=this.B0.getViewportHeight(),this.e=new o.default(this.A,S),this.e.initialize(this.B0,t,f.default.Rstate),g.adapter=this.e,this.B4){let t=this.B0.getStage();null!=t&&(this.Ad=t.stageWidth,this.Ae=t.stageHeight)}this.createMainCamera(),this.B0.setViewport(this.L,this.M,this.Ad,this.Ae),this.B2.lookAtRH(l,p,E),this.B2.update(),this.e.bgColor.setRGB3f(0,0,0),g.RGBA=T.RGBA,g.UNSIGNED_BYTE=T.UNSIGNED_BYTE,g.TRIANGLE_STRIP=T.TRIANGLE_STRIP,g.TRIANGLE_FAN=T.TRIANGLE_FAN,g.TRIANGLES=T.TRIANGLES,g.LINES=this.U_.LINES,g.LINE_STRIP=T.LINE_STRIP,g.UNSIGNED_SHORT=T.UNSIGNED_SHORT,g.UNSIGNED_INT=T.UNSIGNED_INT,g.COLOR=T.COLOR,g.DEPTH=T.DEPTH,g.STENCIL=T.STENCIL,g.DEPTH_STENCIL=T.DEPTH_STENCIL,this.B1>1?(g.MIN=T.MIN,g.MAX=T.MAX):(g.MIN=d.default.EXT_blend_minmax.MIN_EXT,g.MAX=d.default.EXT_blend_minmax.MAX_EXT);let x=r.default;x.NEAREST=T.NEAREST,x.LINEAR=T.LINEAR,x.LINEAR_MIPMAP_LINEAR=T.LINEAR_MIPMAP_LINEAR,x.NEAREST_MIPMAP_NEAREST=T.NEAREST_MIPMAP_NEAREST,x.LINEAR_MIPMAP_NEAREST=T.LINEAR_MIPMAP_NEAREST,x.NEAREST_MIPMAP_LINEAR=T.NEAREST_MIPMAP_LINEAR;let b=a.default;b.COLOR_BUFFER_BIT=T.COLOR_BUFFER_BIT,b.DEPTH_BUFFER_BIT=T.DEPTH_BUFFER_BIT,b.STENCIL_BUFFER_BIT=T.STENCIL_BUFFER_BIT,m.default.SetRenderer(this.B0),g.RState=f.default.Rstate,g.RContext=this.U_}flush(){this.U_.flush()}setClearRGBColor3f(t,e,i){this.e.bgColor.setRGB3f(t,e,i)}setClearColor(t){this.e.bgColor.copyFrom(t)}setClearUint24Color(t,e){this.e.bgColor.setRGBUint24(t),this.e.bgColor.a=e}setClearRGBAColor4f(t,e,i,s){this.e.bgColor.setRGBA4f(t,e,i,s)}getClearRGBAColor4f(t){t.copyFrom(this.e.bgColor)}getViewportWidth(){return this.e.getViewportWidth()}getViewportHeight(){return this.e.getViewportHeight()}setRenderToBackBuffer(){this.e.setRenderToBackBuffer()}clearBackBuffer(){this.e.clear()}renderBegin(){this.B2.update(),this.e.renderBegin()}renderEnd(){}useRenderStateByName(t){_.RenderStateObject.UseRenderStateByName(t)}setScissorEnabled(t){this.B0.setScissorEnabled(t)}setScissorRect(t,e,i,s){this.B0.setScissorRect(t,e,i,s)}useRenderColorMask(t){_.RenderColorMask.UseRenderState(t)}unlockRenderColorMask(){_.RenderColorMask.Unlock()}lockRenderColorMask(){_.RenderColorMask.Lock()}useRenderState(t){_.RenderStateObject.UseRenderState(t)}unlockRenderState(){_.RenderStateObject.Unlock()}lockRenderState(){_.RenderStateObject.Lock()}setVtxUpdateTimesTotal(t){this.AJ.setVtxUpdateTimesTotal(t)}setFrontFaceFlipped(t){this.e.setFrontFaceFlipped(t)}setPolygonOffset(t,e=0){this.e.setPolygonOffset(t,e)}resetPolygonOffset(){this.e.resetPolygonOffset()}loseContext(){this.e.loseContext()}isContextLost(){return this.e.isContextLost()}setViewProbeValue(t,e,i,s){this.e.setViewProbeValue(t,e,i,s)}toString(){return"[Object RenderProxy()]"}}e.default=p},df9d:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(){this.A=-1,this.q_=null,this.r_=null,this.B6=new Map,this.B7=new Map,this.B8=1,this.B9=0,this.B_A=[],this.B_B=[],this.B_C=[],this.B_D=[],this.B_E=0,this.B_F=[],this.B_G=[],this.B_H=[],this.BU=[],this.B_I=0,this.A=s.B_O++}getFreeVtxId(){return this.B_C.length>0?this.B_C.pop():-1}getVtxIndex(){let t=-1,e=this.getFreeVtxId();return e>=0?(t=e,this.B_D[e]=0,this.B_A[e]=this.B8):(t=this.B_E,this.B_D.push(0),this.B_B.push(this.B9),this.B_A.push(this.B8),this.B_E++),t}restoreVtxIndex(t){this.B_A[t]==this.B8&&(this.B_C.push(t),this.B_A[t]=this.B9,this.B_D[t]=0)}attachVtxAt(t){++this.B_D[t]}detachVtxAt(t){this.B_D[t]>0&&(--this.B_D[t],this.B_D[t]<1&&this.restoreVtxIndex(t))}getVtxTotalAt(t){return this.B_D[t]}getFreeTexId(){return this.B_H.length>0?this.B_H.pop():-1}getTexIndex(){let t=-1,e=this.getFreeTexId();return e>=0?(t=e,this.BU[e]=0,this.B_F[e]=this.B8):(t=this.B_I,this.BU.push(0),this.B_G.push(this.B9),this.B_F.push(this.B8),this.B_I++),t}restoreTexIndex(t){this.B_F[t]==this.B8&&(this.B_H.push(t),this.B_F[t]=this.B9,this.BU[t]=0)}attachTexAt(t){++this.BU[t]}detachTexAt(t){this.BU[t]>0&&(--this.BU[t],this.BU[t]<1&&this.restoreTexIndex(t))}getTexTotalAt(t){return this.BU[t]}destroy(){this.clear()}clear(){this.q_=this.r_=null,this.B6=new Map,this.B7=new Map,this.B_A=[],this.B_B=[],this.B_D=[],this.B_C=[],this.B_E=0,this.B_F=[],this.B_G=[],this.BU=[],this.B_H=[],this.B_I=0}getBegin(){return this.q_}containsNode(t){let e=this.B6.get(t.vtxUid);if(null!=e){let i=131*(31+e.rvroI);return i*=i+e.texMid,t.rtokey==i}return!1}addNodeAndSort(t){let e=this.B6.get(t.vtxUid);if(null==e){this.B6.set(t.vtxUid,t),t.rvroI=this.getVtxIndex(),this.attachVtxAt(t.rvroI);let e=131*(31+t.rvroI);e*=e+t.texMid,t.rtokey=e,t.rtroI=this.getTexIndex(),this.B7.set(e,t.rtroI),this.attachTexAt(t.rtroI)}else{t.rvroI=e.rvroI,this.attachVtxAt(t.rvroI);let i=131*(31+t.rvroI);if(i*=i+t.texMid,this.B7.has(i)?t.rtroI=this.B7.get(i):(t.rtroI=this.getTexIndex(),this.B7.set(i,t.rtroI)),t.rtokey=i,this.attachTexAt(t.rtroI),e!=this.r_)if(e.texMid==t.texMid)e.next.prev=t,t.next=e.next,t.prev=e,e.next=t;else while(null!=e){if(e.vtxUid!=t.vtxUid){e=e.prev,e.next.prev=t,t.next=e.next,t.prev=e,e.next=t;break}if(e.texMid==t.texMid){e.next.prev=t,t.next=e.next,t.prev=e,e.next=t;break}if(e.next==this.r_){this.r_.vtxUid!=t.vtxUid?(e.next.prev=t,t.next=e.next,t.prev=e,e.next=t):e=null;break}e=e.next}else e=null}null==e&&(null==this.q_?this.r_=this.q_=t:null!=this.r_.prev?(this.r_.next=t,t.prev=this.r_,this.r_=t):(this.q_.next=t,t.prev=this.r_,this.r_=t),this.r_.next=null)}showInfo(){let t=this.getBegin();if(null!=t){let e="",i="",s="";while(null!=t)e+=t.vtxUid+",",i+=t.texMid+",",s+=t.ivsCount+",",t=t.next}}removeNodeAndSort(t){let e=this.B6.get(t.vtxUid);e!=t?e=null:(this.B6.set(t.vtxUid,null),null!=t.next&&t.next.vtxUid==t.vtxUid?this.B6.set(t.vtxUid,t.next):null!=t.prev&&t.prev.vtxUid==t.vtxUid?this.B6.set(t.vtxUid,t.prev):this.B6.delete(t.vtxUid)),t==this.q_?t==this.r_?this.q_=this.r_=null:(this.q_=t.next,this.q_.prev=null):t==this.r_?(this.r_=t.prev,this.r_.next=null):(t.next.prev=t.prev,t.prev.next=t.next),this.detachVtxAt(t.rvroI),this.detachTexAt(t.rtroI),t.prev=null,t.next=null}addNode(t){null==this.q_?this.r_=this.q_=t:null!=this.r_.prev?(this.r_.next=t,t.prev=this.r_,this.r_=t):(this.q_.next=t,t.prev=this.r_,this.r_=t),this.r_.next=null}removeNode(t){t==this.q_?t==this.r_?this.q_=this.r_=null:(this.q_=t.next,this.q_.prev=null):t==this.r_?(this.r_=t.prev,this.r_.next=null):(t.next.prev=t.prev,t.prev.next=t.next),t.prev=null,t.next=null}}s.B_O=0,e.default=s},e08e:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{}s.ELEMENTS_TRIANGLES=1,s.ELEMENTS_TRIANGLE_STRIP=2,s.ELEMENTS_TRIANGLE_FAN=3,s.ELEMENTS_INSTANCED_TRIANGLES=4,s.ARRAYS_LINES=5,s.ARRAYS_LINE_STRIP=6,s.ARRAYS_POINTS=7,s.ELEMENTS_LINES=8,s.DISABLE=0,e.RenderDrawMode=s;class r{}r.NORMAL=1,r.OPAQUE=1,r.TRANSPARENT=2,r.ALPHA_ADD=3,r.ADD=4,r.ADD_LINEAR=5,r.INVERSE_ALPHA=6,r.BLAZE=7,r.OVERLAY=8,r.OVERLAY2=8,r.DISABLE=0,e.RenderBlendMode=r;class a{}a.NEVER=1,a.LESS=1,a.EQUAL=1,a.GREATER=1,a.NOTEQUAL=1,a.GEQUAL=1,a.ALWAYS=1,e.GLStencilFunc=a;class h{}h.KEEP=1,h.ZERO=1,h.REPLACE=1,h.INCR=1,h.INCR_WRAP=1,h.DECR=1,h.DECR_WRAP=1,h.INVERT=1,e.GLStencilOp=h;class n{}n.ZERO=1,n.ONE=1,n.SRC_COLOR=1,n.DST_COLOR=1,n.SRC_ALPHA=1,n.DST_ALPHA=1,n.ONE_MINUS_SRC_ALPHA=1,e.GLBlendMode=n;class _{}_.FUNC_ADD=1,_.FUNC_SUBTRACT=1,_.FUNC_REVERSE_SUBTRACT=1,_.MIN_EXT=1,_.MAX_EXT=1,_.MIN=1,_.MAX=1,e.GLBlendEquation=_;class l{}l.BACK=1,l.FRONT=2,l.FRONT_AND_BACK=3,l.NONE=0,l.DISABLE=0,e.CullFaceMode=l;class o{}o.NEVER=1,o.ALWAYS=2,o.SKY=3,o.TRUE_LESS_EQUAL=3,o.OPAQUE=4,o.TRUE_LESS=4,o.OPAQUE_OVERHEAD=5,o.FALSE_EQUAL=5,o.FALSE_LESS=6,o.BLEND=6,o.BLEND_SORT=6,o.TRANSPARENT_SORT=6,o.TRUE_LEQUAL=7,o.WIRE_FRAME=7,o.FALSE_LEQUAL=8,o.DECALS=8,o.NEXT_LAYER=11,o.WIRE_FRAME_NEXT=12,o.TRUE_EQUAL=13,o.TRUE_GREATER=14,o.TRUE_GEQUAL=15,o.DISABLE=0,e.DepthTestMode=o;class m{}m.SCENE_RO_FILTER_BEGIN=1<<19,m.SCENE_RO_FILTER_FINISH=2<<19,m.SCENE_RO_ERASE=0,e.RenderConst=m,function(t){t[t["NOT_IN_RENDERER"]=-1]="NOT_IN_RENDERER",t[t["GO_TO_RENDERER"]=1]="GO_TO_RENDERER",t[t["LIVE_IN_RENDERER"]=2]="LIVE_IN_RENDERER"}(e.DisplayRenderSign||(e.DisplayRenderSign={}))},e87b:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("ab73")),a=s(i("7279"));class h{create(t,e){let i=null,s=r.default.ViewportParam;return e.hasUniformByName(s.name)&&(i=new a.default,i.uns=s.name,i.uniformNameList=[s.name],i.copyDataFromProbe(t.getRenderAdapter().uViewProbe)),i}getIDNS(){return"ViewParamUniformBuilder"}}e.default=h},eca0:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("2be1")),a=s(i("c62b"));class h{constructor(){this.idsFlag=0,this.count=0,this.rprocessUid=-1}reset(){this.idsFlag=0}}h.RenerProcessMaxTotal=16,e.RCRPObj=h;class n extends r.default{constructor(){super(...arguments),this.B_J=[]}createNode(){let t=new h;return t.reset(),this.B_J.push(t),new a.default}restoreUid(t){this.B_J[t].reset()}testRPNodeExists(t,e){return(this.B_J[t].idsFlag&1<<e)>0}testRPNodeNotExists(t,e){return(this.B_J[t].idsFlag&1<<e)<1}setRPNodeParam(t,e,i){let s=this.B_J[t],r=1<<e;return i>-1?(s.idsFlag&r)<1&&(++s.count,s.rprocessUid=e,s.idsFlag=s.idsFlag|r):(s.idsFlag&r)>0&&(--s.count,s.idsFlag=s.idsFlag&~r),s.count}getRCRPObj(t){return this.B_J[t]}}e.RPOUnitBuilder=n},fa60:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("919c"));class a extends r.default{constructor(){super(),this.vao=null,this.A=a.B_O++}run(){this.U_.testVROUid(this.A)&&(this.U_.bindVertexArray(this.vao),this.U_.testRIOUid(this.A_B)&&this.U_.bindEleBuf(this.ibuf))}__$destroy(){r.default.B_w.delete(this.BP),this.BP=0,this.A_B=-1,this.ibuf=null,this.vao=null,this.U_=null}restoreThis(){null!=this.vao&&this.U_.deleteVertexArray(this.vao),a.Restore(this)}toString(){return"VaoVertexRenderObj(uid = "+this.A+", type="+this.BP+")"}static HasMid(t){return r.default.B_w.has(t)}static GetByMid(t){return r.default.B_w.get(t)}static GetFreeId(){return a.B_x.length>0?a.B_x.pop():-1}static Create(t,e,i){let s=null,h=a.GetFreeId();return h>=0?(s=a.B_y[h],a.B_z[h]=a.S_FLAG_BUSY,s.setMidAndBufUid(e,i)):(s=new a,s.setMidAndBufUid(e,i),a.B_y.push(s),a.B_z.push(a.S_FLAG_BUSY),a.B_0++),s.setRC(t),r.default.B_w.set(e,s),s}static Restore(t){if(null!=t&&t.BQ<1&&a.B_z[t.getUid()]==a.S_FLAG_BUSY){let e=t.getUid();a.B_x.push(e),a.B_z[e]=a.S_FLAG_FREE,t.__$destroy()}}}a.B_O=0,a.S_FLAG_BUSY=1,a.S_FLAG_FREE=0,a.B_z=[],a.B_0=0,a.B_y=[],a.B_x=[],e.default=a},fae3:function(t,e,i){"use strict";i.r(e);i("1eb2");var s=i("b88e");for(var r in s)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(r)},fecb:function(t,e,i){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(i("6e01")),a=s(i("8e17"));class h{constructor(){this.min=new a.default(r.default.MATH_MAX_POSITIVE,r.default.MATH_MAX_POSITIVE,r.default.MATH_MAX_POSITIVE),this.max=new a.default(r.default.MATH_MIN_NEGATIVE,r.default.MATH_MIN_NEGATIVE,r.default.MATH_MIN_NEGATIVE),this.version=-1,this.radius=50,this.radius2=2500,this.center=new a.default(0,0,0),this.B_K=100,this.A_W=100,this.A_X=100,this.B_L=50,this.B_M=50,this.B_N=50,this.AQ=new a.default}getLong(){return this.B_K}getWidth(){return this.A_W}getHeight(){return this.A_X}reset(){this.min.setXYZ(r.default.MATH_MAX_POSITIVE,r.default.MATH_MAX_POSITIVE,r.default.MATH_MAX_POSITIVE),this.max.setXYZ(r.default.MATH_MIN_NEGATIVE,r.default.MATH_MIN_NEGATIVE,r.default.MATH_MIN_NEGATIVE)}equals(t){return this.min.equalsXYZ(t.min)&&this.max.equalsXYZ(t.max)}setVolume(t,e,i){this.A_W=t,this.A_X=e,this.B_K=i,this.B_L=.5*this.B_K,this.B_M=.5*this.A_W,this.B_N=.5*this.A_X,this.max.x=this.center.x+this.B_M,this.max.y=this.center.y+this.B_N,this.max.z=this.center.z+this.B_L,this.min.x=this.center.x-this.B_M,this.min.y=this.center.y-this.B_N,this.min.z=this.center.z-this.B_L,this.radius2=this.B_M*this.B_M+this.B_N*this.B_N+this.B_L*this.B_L,this.radius=Math.sqrt(this.radius2)}union(t){this.addPosition(t.min),this.addPosition(t.max)}addPosition(t){this.min.x>t.x&&(this.min.x=t.x),this.min.y>t.y&&(this.min.y=t.y),this.min.z>t.z&&(this.min.z=t.z),this.max.x<t.x&&(this.max.x=t.x),this.max.y<t.y&&(this.max.y=t.y),this.max.z<t.z&&(this.max.z=t.z)}addXYZ(t,e,i){this.min.x>t&&(this.min.x=t),this.min.y>e&&(this.min.y=e),this.min.z>i&&(this.min.z=i),this.max.x<t&&(this.max.x=t),this.max.y<e&&(this.max.y=e),this.max.z<i&&(this.max.z=i)}addXYZFloat32Arr(t){let e=t.length,i=0,s=0,r=0;for(let a=0;a<e;)i=t[a++],s=t[a++],r=t[a++],this.min.x>i&&(this.min.x=i),this.min.y>s&&(this.min.y=s),this.min.z>r&&(this.min.z=r),this.max.x<i&&(this.max.x=i),this.max.y<s&&(this.max.y=s),this.max.z<r&&(this.max.z=r)}addXYZFloat32AndIndicesArr(t,e){let i,s=e.length,r=0,a=0,h=0;for(let n=0;n<s;n++)i=3*n,r=t[i++],a=t[i++],h=t[i],this.min.x>r&&(this.min.x=r),this.min.y>a&&(this.min.y=a),this.min.z>h&&(this.min.z=h),this.max.x<r&&(this.max.x=r),this.max.y<a&&(this.max.y=a),this.max.z<h&&(this.max.z=h)}containsV(t){return!(t.x<this.max.x||t.x>this.max.x)&&(!(t.y<this.max.y||t.y>this.max.y)&&!(t.z<this.max.z||t.z>this.max.z))}containsXY(t,e){return!(t<this.min.x||t>this.max.x)&&!(e<this.min.y||e>this.max.y)}containsXZ(t,e){return!(t<this.min.x||t>this.max.x)&&!(e<this.min.z||e>this.max.z)}containsYZ(t,e){return!(t<this.min.y||t>this.max.y)&&!(e<this.min.z||e>this.max.z)}update(){this.A_W=this.max.x,this.min.x>this.max.x&&(this.max.x=this.min.x,this.min.x=this.A_W),this.A_W=this.max.x-this.min.x,this.A_X=this.max.y,this.min.y>this.max.y&&(this.max.y=this.min.y,this.min.y=this.A_X),this.A_X=this.max.y-this.min.y,this.B_K=this.max.z,this.min.z>this.max.z&&(this.max.z=this.min.z,this.min.z=this.B_K),this.B_K=this.max.z-this.min.z,this.center.x=.5*this.A_W,this.center.y=.5*this.A_X,this.center.z=.5*this.B_K,this.B_L=this.center.z,this.B_M=this.center.x,this.B_N=this.center.y,this.radius2=this.B_M*this.B_M+this.B_N*this.B_N+this.B_L*this.B_L,this.radius=Math.sqrt(this.radius2),this.center.x+=this.min.x,this.center.y+=this.min.y,this.center.z+=this.min.z,++this.version}updateVolume(){this.A_W=this.max.x-this.min.x,this.A_X=this.max.y-this.min.y,this.B_K=this.max.z-this.min.z,this.B_L=.5*this.B_K,this.B_M=.5*this.A_W,this.B_N=.5*this.A_X,++this.version}copyFrom(t){this.radius=t.radius,this.radius2=t.radius2,this.min.copyFrom(t.min),this.max.copyFrom(t.max),this.center.copyFrom(t.center),this.updateVolume()}updateFast(){this.A_W=this.max.x-this.min.x,this.A_X=this.max.y-this.min.y,this.B_K=this.max.z-this.min.z,this.center.x=.5*this.A_W,this.center.y=.5*this.A_X,this.center.z=.5*this.B_K,this.B_L=this.center.z,this.B_M=this.center.x,this.B_N=this.center.y,this.radius2=this.B_M*this.B_M+this.B_N*this.B_N+this.B_L*this.B_L,this.radius=Math.sqrt(this.radius2),this.center.x+=this.min.x,this.center.y+=this.min.y,this.center.z+=this.min.z,++this.version}toString(){return"[AABB(min->"+this.min+",size("+this.A_W+","+this.A_X+","+this.B_K+"))]"}sphereIntersect(t,e){this.AQ.x=this.center.x-t.x,this.AQ.y=this.center.y-t.y,this.AQ.z=this.center.z-t.z;let i=this.AQ.getLengthSquared();return i<this.radius2||(e+=this.radius,e*=e,e>=i)}intersectRL(t,e){let i=0,s=(this.min.x-e.x)/t.x,r=(this.max.x-e.x)/t.x;s>r&&(i=r,r=s,s=i);let a=(this.min.y-e.y)/t.y,h=(this.max.y-e.y)/t.y;if(a>h&&(i=h,h=a,a=i),s>h||a>r)return!1;a>s&&(s=a),h<r&&(r=h);let n=(this.min.z-e.z)/t.z,_=(this.max.z-e.z)/t.z;return n>_&&(i=_,_=n,n=i),!(s>_||n>r)&&(n>s&&(s=n),_<r&&(r=_),!0)}static IntersectionRL3(t,e,i,s,r,a){return i.w=(t[e[0]].x-r.x)*i.x,s.w=(t[1-e[0]].x-r.x)*i.x,a.x=(t[e[1]].y-r.y)*i.y,a.y=(t[1-e[1]].y-r.y)*i.y,!(i.w>a.y||a.x>s.w)&&(a.x>i.w&&(i.w=a.x),a.y<s.w&&(s.w=a.y),a.x=(t[e[2]].z-r.z)*i.z,a.y=(t[1-e[2]].z-r.z)*i.z,!(i.w>a.y||a.x>s.w)&&(a.x>i.w&&(i.w=a.x),a.y<s.w&&(s.w=a.y),a.copyFrom(s),a.scaleBy(i.w),a.addBy(r),s.w=1,!0))}static IntersectionRL1(t,e,i,s){let r=0,a=(i.min.x-e.x)/t.x,h=(i.max.x-e.x)/t.x;a>h&&(r=h,h=a,a=r);let n=(i.min.y-e.y)/t.y,_=(i.max.y-e.y)/t.y;if(n>_&&(r=_,_=n,n=r),a>_||n>h)return!1;n>a&&(a=n),_<h&&(h=_);let l=(i.min.z-e.z)/t.z,o=(i.max.z-e.z)/t.z;return l>o&&(r=o,o=l,l=r),!(a>o||l>h)&&(l>a&&(a=l),o<h&&(h=o),s.copyFrom(t),s.scaleBy(a),s.addBy(e),!0)}static IntersectionRL2(t,e,i,s){s.x=i.center.x-e.x,s.y=i.center.y-e.y,s.z=i.center.z-e.z;let r=s.dot(t);if(s.x-=r*t.x,s.y-=r*t.y,s.z-=r*t.z,s.getLengthSquared()>i.radius2)return!1;if(i.containsV(e))return s.copyFrom(e),!0;if(e.x<i.min.x){if(t.x>0&&(r=(i.min.x-e.x)/t.x,s.copyFrom(t),s.scaleBy(r),s.addBy(e),i.containsYZ(s.y,s.z)))return!0}else if(e.x>i.max.x&&t.x<0&&(r=(i.max.x-e.x)/t.x,s.copyFrom(t),s.scaleBy(r),s.addBy(e),i.containsYZ(s.y,s.z)))return!0;if(e.y<i.min.y){if(t.y>0&&(r=(i.min.y-e.y)/t.y,s.copyFrom(t),s.scaleBy(r),s.addBy(e),i.containsXZ(s.x,s.z)))return!0}else if(e.y>i.max.y&&t.y<0&&(r=i.max.y,r=(i.max.y-e.y)/t.y,s.copyFrom(t),s.scaleBy(r),s.addBy(e),i.containsXZ(s.x,s.z)))return!0;if(e.z<i.min.z){if(t.z>0&&(r=(i.min.z-e.z)/t.z,s.copyFrom(t),s.scaleBy(r),s.addBy(e),i.containsXY(s.x,s.y)))return!0}else if(e.z>i.max.z&&t.z<0&&(r=(i.max.z-e.z)/t.z,s.copyFrom(t),s.scaleBy(r),s.addBy(e),i.containsXY(s.x,s.y)))return!0;return!1}}h.___pnV=new a.default,e.default=h}})}));